<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCFA: Interactive Research Story | Jahidul Arafat</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- Handwriting Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Patrick+Hand&family=Kalam:wght@300;400;700&display=swap" rel="stylesheet">
    <!-- Rough.js for hand-drawn graphics -->
    <script src="https://cdn.jsdelivr.net/npm/roughjs@4.5.2/bundled/rough.umd.min.js"></script>
    <!-- vis.js for Knowledge Graph -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.6/dist/vis-network.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.6/dist/dist/vis-network.min.css" rel="stylesheet">
</head>
<body>
    <!-- Handwritten Notes Panel (Left) -->
    <div id="handwrittenPanel" class="handwritten-panel left-panel hidden">
        <div class="panel-header">
            <span class="panel-icon">‚úèÔ∏è</span>
            <span class="panel-title">Live Notes</span>
            <button class="panel-clear" onclick="clearHandwrittenNotes()" title="Clear notes (resets on refresh)">üóëÔ∏è</button>
        </div>
        <div class="panel-content">
            <canvas id="sketchCanvas" class="sketch-canvas"></canvas>
            <div id="handwrittenNotes" class="notes-container"></div>
        </div>
    </div>

    <!-- Key Insights Panel (Right) -->
    <div id="insightsPanel" class="handwritten-panel right-panel hidden">
        <div class="panel-header">
            <span class="panel-icon">üí°</span>
            <span class="panel-title">Key Insights</span>
            <div class="panel-toggle">
                <button class="toggle-btn active" data-view="flow" onclick="switchInsightView('flow')">Flow</button>
                <button class="toggle-btn" data-view="stats" onclick="switchInsightView('stats')">Stats</button>
            </div>
        </div>
        <div class="panel-content">
            <canvas id="flowCanvas" class="flow-canvas"></canvas>
            <div id="statsContainer" class="stats-container hidden"></div>
        </div>
    </div>

    <!-- Panel Controls (Bottom Left) -->
    <div id="panelControls" class="panel-controls">
        <div class="control-group">
            <button id="panelSettingsBtn" class="control-btn settings-btn" onclick="togglePanelSettings()" title="Panel Settings">
                <span class="btn-icon">‚öôÔ∏è</span>
                <span class="btn-label">Panels</span>
                <span id="panelSuggestion" class="suggestion-badge hidden">Enable for better experience!</span>
            </button>
        </div>
        
        <!-- Panel Settings Dropdown -->
        <div id="panelSettingsDropdown" class="settings-dropdown hidden">
            <div class="dropdown-header">
                <span>üìã Panel Settings</span>
                <button class="close-dropdown" onclick="togglePanelSettings()">‚úï</button>
            </div>
            <div class="dropdown-content">
                <!-- Global Controls -->
                <div class="setting-section">
                    <div class="section-title">Global Controls</div>
                    <div class="setting-row">
                        <label class="setting-label">
                            <input type="checkbox" id="globalNotesToggle" onchange="toggleGlobalNotes()">
                            <span class="checkmark"></span>
                            <span>üìù Live Notes Panel</span>
                        </label>
                        <span class="setting-status" id="notesStatus">OFF</span>
                    </div>
                    <div class="setting-row">
                        <label class="setting-label">
                            <input type="checkbox" id="globalInsightsToggle" onchange="toggleGlobalInsights()">
                            <span class="checkmark"></span>
                            <span>üí° Key Insights Panel</span>
                        </label>
                        <span class="setting-status" id="insightsStatus">OFF</span>
                    </div>
                </div>
                
                <!-- Per-Slide Controls -->
                <div class="setting-section">
                    <div class="section-title">Current Slide Override</div>
                    <div class="setting-row">
                        <label class="setting-label">
                            <input type="checkbox" id="slideNotesToggle" onchange="toggleSlideNotes()">
                            <span class="checkmark"></span>
                            <span>Override for this slide</span>
                        </label>
                        <select id="slideNotesSelect" class="slide-override-select" onchange="setSlideNotesOverride()">
                            <option value="inherit">Use Global</option>
                            <option value="show">Always Show</option>
                            <option value="hide">Always Hide</option>
                        </select>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="setting-section">
                    <div class="section-title">Quick Actions</div>
                    <div class="quick-actions">
                        <button class="quick-btn enable-all" onclick="enableAllPanels()">
                            <span>‚úì</span> Enable All
                        </button>
                        <button class="quick-btn disable-all" onclick="disableAllPanels()">
                            <span>‚úï</span> Disable All
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CC Controls (Bottom Right) -->
    <div id="ccControls" class="cc-controls">
        <button id="ccToggleBtn" class="control-btn cc-btn" onclick="toggleCC()" title="Toggle Closed Captions">
            <span class="btn-icon">CC</span>
            <span class="btn-label">Captions</span>
            <span id="ccStatus" class="cc-status">OFF</span>
        </button>
        <!-- CC Settings Dropdown -->
        <div id="ccSettingsDropdown" class="cc-settings-dropdown hidden">
            <div class="cc-setting-row">
                <span class="cc-setting-label">Opacity</span>
                <input type="range" id="ccOpacitySlider" min="30" max="100" value="85" 
                       oninput="setCCOpacity(this.value)" class="cc-slider">
                <span id="ccOpacityValue" class="cc-opacity-value">85%</span>
            </div>
            <div class="cc-setting-row">
                <span class="cc-setting-label">Font Size</span>
                <select id="ccFontSize" onchange="setCCFontSize(this.value)" class="cc-select">
                    <option value="1rem">Small</option>
                    <option value="1.2rem" selected>Medium</option>
                    <option value="1.5rem">Large</option>
                    <option value="1.8rem">Extra Large</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Closed Captions Container -->
    <div id="ccContainer" class="cc-container hidden">
        <div class="cc-background">
            <div id="ccText" class="cc-text"></div>
        </div>
    </div>

    <!-- Suggestion Overlay (appears when panels disabled) -->
    <div id="panelSuggestionOverlay" class="suggestion-overlay hidden">
        <div class="suggestion-content">
            <span class="suggestion-icon">üí°</span>
            <span class="suggestion-message">Enable <strong>Live Notes</strong> for real-time annotations!</span>
            <div class="suggestion-actions">
                <button class="suggestion-btn enable" onclick="enableAllPanels(); hideSuggestion();">Enable Now</button>
                <button class="suggestion-btn dismiss" onclick="hideSuggestion();">Maybe Later</button>
                <label class="suggestion-checkbox">
                    <input type="checkbox" id="dontShowAgain" onchange="setDontShowAgain()">
                    <span>Don't show again</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Audio Controls -->
    <div id="audioControls" class="audio-controls">
        <button id="toggleNarration" class="audio-btn" onclick="toggleNarration()">
            <span id="audioIcon">üîä</span> Narration: ON
        </button>
        <input type="range" id="speechRate" min="0.5" max="2" step="0.1" value="1" onchange="updateSpeechRate()">
        <span class="rate-label">Speed: <span id="rateValue">1x</span></span>
    </div>

    <!-- Narration Scene Indicator -->
    <div id="narrationIndicator" class="narration-indicator">
        <div class="indicator-content">
            <span class="indicator-icon">üéôÔ∏è</span>
            <span class="indicator-label">Speaking:</span>
            <span id="narratingSceneNum" class="indicator-scene">--</span>
            <span id="narratingSceneTitle" class="indicator-title">Ready</span>
            <button id="resyncBtn" class="resync-btn" onclick="resyncNarration()" title="Sync audio to current slide (R)">üîÑ</button>
        </div>
        <div id="syncWarning" class="sync-warning hidden">
            ‚ö†Ô∏è Audio is from Scene <span id="syncSceneNum"></span> - <button class="sync-link" onclick="resyncNarration()">Click to resync</button> or press R
        </div>
    </div>

    <!-- Progress indicator -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Scene navigation dots -->
    <div class="scene-nav" id="sceneNav"></div>

    <!-- Main container -->
    <div class="presentation-container" id="presentationContainer">
        
        <!-- ==================== SCENE 0: TITLE & AUTHOR ==================== -->
        <section class="scene active" data-scene="0" data-title="Title">
            <div class="scene-content title-scene">
                <div class="title-header animate-in">
                    <div class="title-logo">SCFA</div>
                    <h1 class="main-title">Semantic-Constrained Federated Aggregation</h1>
                    <p class="sub-title">Convergence Theory and Privacy-Utility Bounds for<br>Knowledge-Enhanced Distributed Learning</p>
                </div>

                <div class="author-card animate-in delay-1">
                    <div class="author-photo">
                        <div class="photo-placeholder">JA</div>
                    </div>
                    <div class="author-info">
                        <h2 class="author-name">Jahidul Arafat</h2>
                        <div class="author-titles">
                            <div class="title-badge fellowship">
                                <span class="badge-icon">üéì</span>
                                <span class="badge-text">NSF Presidential & Woltosz Graduate Research Fellow</span>
                            </div>
                            <div class="title-badge">
                                <span class="badge-icon">üèõÔ∏è</span>
                                <span class="badge-text">Graduate Research Fellow, Auburn University</span>
                            </div>
                        </div>
                        <div class="author-experience">
                            <div class="exp-item">
                                <span class="exp-company oracle">Former Oracle</span>
                                <span class="exp-role">L3 Senior Solution & Cloud Architect (MLOps)</span>
                            </div>
                            <div class="exp-item">
                                <span class="exp-company bkash">Former bKash</span>
                                <span class="exp-role">L4 Principal System Analyst, Reliability Engineering (ML Team Lead)</span>
                            </div>
                            <div class="exp-note">
                                <span>ü¶Ñ Unicorn ‚Ä¢ Alipay Co-owned ‚Ä¢ SoftBank Sponsored</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="key-results-preview animate-in delay-2">
                    <div class="result-pill rq1">
                        <span class="pill-value">22%</span>
                        <span class="pill-label">Faster Convergence</span>
                    </div>
                    <div class="result-pill rq2">
                        <span class="pill-value">2.7√ó</span>
                        <span class="pill-label">Better Privacy-Utility</span>
                    </div>
                    <div class="result-pill rq3">
                        <span class="pill-value">18%</span>
                        <span class="pill-label">Critical Threshold</span>
                    </div>
                </div>

                <div class="start-section animate-in delay-3">
                    <p class="narration-hint">üéß Enable narration for the complete storytelling experience</p>
                    <button class="start-btn pulse" onclick="nextScene()">
                        Begin Presentation ‚Üí
                    </button>
                    <p class="duration-hint">Duration: ~20 minutes | Arrow keys to navigate | Press R to resync audio</p>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 1: WHAT IS SEMANTIC-CONSTRAINED? ==================== -->
        <section class="scene" data-scene="1" data-title="What is SCFA?">
            <div class="scene-content">
                <div class="chapter-badge novelty">üí° Core Innovation</div>
                <h2 class="scene-title animate-in">What is <span class="highlight-semantic">Semantic</span>-<span class="highlight-constrained">Constrained</span> Federated Aggregation?</h2>
                <p class="scene-subtitle animate-in delay-1">Understanding the novelty of our approach</p>

                <!-- One-line Definition -->
                <div class="scfa-definition-box animate-in delay-2">
                    <div class="def-icon">üìñ</div>
                    <div class="def-content">
                        <div class="def-label">Definition</div>
                        <div class="def-text">
                            The server aggregates client models only in ways that <strong>preserve the meaning (semantics)</strong> of learned features, instead of blindly averaging parameters.
                        </div>
                    </div>
                </div>

                <!-- Enhanced Two-Column Layout with Animated Examples -->
                <div class="scfa-explained-container animate-in delay-2">
                    
                    <!-- LEFT: SEMANTIC Section with Animated Examples -->
                    <div class="scfa-section semantic-section">
                        <div class="section-header semantic-bg">
                            <span class="section-icon">üß†</span>
                            <span class="section-title">What is "Semantic"?</span>
                        </div>
                        
                        <div class="section-intro">
                            <p><strong>Semantics</strong> = The <em>meaning</em> that data represents</p>
                        </div>

                        <!-- Animated Semantic Examples -->
                        <div class="animated-examples semantic-examples">
                            <div class="example-carousel" id="semanticCarousel">
                                
                                <!-- Example 1: Language Analogy -->
                                <div class="flyio-example active" data-example="1">
                                    <div class="example-header">
                                        <span class="ex-num">1</span>
                                        <span class="ex-title">üåç Language Analogy</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="lang-demo">
                                            <div class="lang-item fly-left" data-delay="0">
                                                <div class="lang-flag">üá∫üá∏</div>
                                                <div class="lang-word">"Dog"</div>
                                            </div>
                                            <div class="lang-equals fly-down" data-delay="300">
                                                <span>=</span>
                                            </div>
                                            <div class="lang-item fly-right" data-delay="0">
                                                <div class="lang-flag">üá™üá∏</div>
                                                <div class="lang-word">"Perro"</div>
                                            </div>
                                        </div>
                                        <div class="lang-meaning fly-up" data-delay="600">
                                            <div class="meaning-icon">üêï</div>
                                            <div class="meaning-text">Same <strong>meaning</strong>, different <strong>representation</strong></div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-icon">üí°</span>
                                        <span>ML models at different factories encode the same concept differently!</span>
                                    </div>
                                </div>

                                <!-- Example 2: Feature Encoding -->
                                <div class="flyio-example" data-example="2">
                                    <div class="example-header">
                                        <span class="ex-num">2</span>
                                        <span class="ex-title">üìä Feature Encoding</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="encoding-demo">
                                            <div class="encoding-factory fly-left" data-delay="0">
                                                <div class="factory-label">üè≠ Factory A</div>
                                                <div class="feature-vector">
                                                    <div class="vec-item dim-4 active">dim 4: <strong>wear</strong></div>
                                                    <div class="vec-item dim-11">dim 11: empty</div>
                                                </div>
                                            </div>
                                            <div class="encoding-factory fly-right" data-delay="200">
                                                <div class="factory-label">üè≠ Factory B</div>
                                                <div class="feature-vector">
                                                    <div class="vec-item dim-4">dim 4: empty</div>
                                                    <div class="vec-item dim-11 active">dim 11: <strong>wear</strong></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="encoding-problem fly-up" data-delay="500">
                                            <div class="problem-badge">‚ö†Ô∏è Same concept, DIFFERENT dimensions!</div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-icon">üí°</span>
                                        <span>If we average directly, the "wear" signal gets destroyed!</span>
                                    </div>
                                </div>

                                <!-- Example 3: Real World Meaning -->
                                <div class="flyio-example" data-example="3">
                                    <div class="example-header">
                                        <span class="ex-num">3</span>
                                        <span class="ex-title">üîß Real World Meaning</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="realworld-demo">
                                            <div class="rw-scenario fly-down" data-delay="0">
                                                <div class="rw-value">Tool Wear = <span class="highlight-val">0.8</span></div>
                                            </div>
                                            <div class="rw-interpretations">
                                                <div class="rw-interp fly-left" data-delay="300">
                                                    <div class="interp-factory">Factory A</div>
                                                    <div class="interp-meaning">üî¥ 80% worn<br><small>Replace soon!</small></div>
                                                </div>
                                                <div class="rw-vs fly-up" data-delay="400">vs</div>
                                                <div class="rw-interp fly-right" data-delay="300">
                                                    <div class="interp-factory">Factory B</div>
                                                    <div class="interp-meaning">üü° 0.8mm wear<br><small>Still good</small></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-icon">üí°</span>
                                        <span>Same number, completely different meanings ‚Äî that's the semantic problem!</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Carousel Controls -->
                            <div class="carousel-controls">
                                <button class="carousel-btn" onclick="prevSemanticExample()">‚Äπ</button>
                                <div class="carousel-dots" id="semanticDots">
                                    <span class="dot active" onclick="goToSemanticExample(1)"></span>
                                    <span class="dot" onclick="goToSemanticExample(2)"></span>
                                    <span class="dot" onclick="goToSemanticExample(3)"></span>
                                </div>
                                <button class="carousel-btn" onclick="nextSemanticExample()">‚Ä∫</button>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT: CONSTRAINED Section with Animated Examples -->
                    <div class="scfa-section constrained-section">
                        <div class="section-header constrained-bg">
                            <span class="section-icon">üîí</span>
                            <span class="section-title">What is "Constrained"?</span>
                        </div>
                        
                        <div class="section-intro">
                            <p><strong>Constraints</strong> = Rules from physics &amp; domain knowledge</p>
                        </div>

                        <!-- Animated Constraint Examples -->
                        <div class="animated-examples constraint-examples">
                            <div class="example-carousel" id="constraintCarousel">
                                
                                <!-- Constraint 1: Temporal -->
                                <div class="flyio-example active" data-example="1">
                                    <div class="example-header">
                                        <span class="ex-num">‚è±Ô∏è</span>
                                        <span class="ex-title">Temporal Constraint</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="temporal-demo">
                                            <div class="temporal-rule fly-down" data-delay="0">
                                                <code>‚àÇ(tool_wear)/‚àÇt ‚â• 0</code>
                                            </div>
                                            <div class="temporal-visual">
                                                <div class="tool-stages">
                                                    <div class="tool-stage fly-left" data-delay="200">
                                                        <div class="tool-icon">üîß</div>
                                                        <div class="tool-state new">New</div>
                                                        <div class="wear-bar"><div class="wear-fill" style="width: 10%"></div></div>
                                                    </div>
                                                    <div class="stage-arrow fly-up" data-delay="400">‚Üí</div>
                                                    <div class="tool-stage fly-up" data-delay="400">
                                                        <div class="tool-icon">üîß</div>
                                                        <div class="tool-state used">Used</div>
                                                        <div class="wear-bar"><div class="wear-fill" style="width: 50%"></div></div>
                                                    </div>
                                                    <div class="stage-arrow fly-up" data-delay="600">‚Üí</div>
                                                    <div class="tool-stage fly-right" data-delay="200">
                                                        <div class="tool-icon">üîß</div>
                                                        <div class="tool-state worn">Worn</div>
                                                        <div class="wear-bar"><div class="wear-fill" style="width: 90%"></div></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="constraint-badge fly-up" data-delay="800">
                                                <span class="badge-icon">‚úì</span>
                                                <span>Wear can only <strong>increase</strong>, never decrease!</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Constraint 2: Causal -->
                                <div class="flyio-example" data-example="2">
                                    <div class="example-header">
                                        <span class="ex-num">üîó</span>
                                        <span class="ex-title">Causal Constraint</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="causal-demo">
                                            <div class="causal-chain">
                                                <div class="causal-node fly-left" data-delay="0">
                                                    <div class="node-icon">üì≥</div>
                                                    <div class="node-label">Vibration<br>Anomaly</div>
                                                </div>
                                                <div class="causal-arrow fly-down" data-delay="300">
                                                    <span>causes</span>
                                                    <div class="arrow-line">‚Üí</div>
                                                </div>
                                                <div class="causal-node fly-up" data-delay="400">
                                                    <div class="node-icon">‚öôÔ∏è</div>
                                                    <div class="node-label">Bearing<br>Wear</div>
                                                </div>
                                                <div class="causal-arrow fly-down" data-delay="500">
                                                    <span>causes</span>
                                                    <div class="arrow-line">‚Üí</div>
                                                </div>
                                                <div class="causal-node fly-right" data-delay="600">
                                                    <div class="node-icon">üí•</div>
                                                    <div class="node-label">Machine<br>Failure</div>
                                                </div>
                                            </div>
                                            <div class="constraint-badge fly-up" data-delay="900">
                                                <span class="badge-icon">‚úì</span>
                                                <span>Events must follow the <strong>causal order</strong>!</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Constraint 3: Capacity/Bounds -->
                                <div class="flyio-example" data-example="3">
                                    <div class="example-header">
                                        <span class="ex-num">üìè</span>
                                        <span class="ex-title">Capacity Constraint</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="capacity-demo">
                                            <div class="capacity-rule fly-down" data-delay="0">
                                                <code>T ‚àà [T<sub>min</sub>, T<sub>max</sub>]</code>
                                            </div>
                                            <div class="thermometer-visual fly-up" data-delay="300">
                                                <div class="thermo-scale">
                                                    <div class="thermo-zone danger-high">üî• &gt;200¬∞C</div>
                                                    <div class="thermo-zone safe">
                                                        <span class="safe-label">‚úì Safe Zone</span>
                                                        <span class="safe-range">20¬∞C - 200¬∞C</span>
                                                    </div>
                                                    <div class="thermo-zone danger-low">‚ùÑÔ∏è &lt;20¬∞C</div>
                                                </div>
                                                <div class="thermo-pointer fly-left" data-delay="600">
                                                    <span class="pointer-val">85¬∞C</span>
                                                    <span class="pointer-arrow">‚óÑ</span>
                                                </div>
                                            </div>
                                            <div class="constraint-badge fly-up" data-delay="900">
                                                <span class="badge-icon">‚úì</span>
                                                <span>Predictions must stay within <strong>physical limits</strong>!</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Constraint 4: Physical/Conservation -->
                                <div class="flyio-example" data-example="4">
                                    <div class="example-header">
                                        <span class="ex-num">‚öõÔ∏è</span>
                                        <span class="ex-title">Physical Constraint</span>
                                    </div>
                                    <div class="example-animation">
                                        <div class="physical-demo">
                                            <div class="conservation-rule fly-down" data-delay="0">
                                                <code>Œ£E<sub>in</sub> = Œ£E<sub>out</sub></code>
                                            </div>
                                            <div class="energy-visual">
                                                <div class="energy-in fly-left" data-delay="300">
                                                    <div class="energy-label">Energy In</div>
                                                    <div class="energy-items">
                                                        <span class="e-item">‚ö° 100 kW</span>
                                                    </div>
                                                </div>
                                                <div class="energy-machine fly-up" data-delay="500">
                                                    <div class="machine-box">
                                                        <span>üè≠</span>
                                                        <small>Machine</small>
                                                    </div>
                                                </div>
                                                <div class="energy-out fly-right" data-delay="300">
                                                    <div class="energy-label">Energy Out</div>
                                                    <div class="energy-items">
                                                        <span class="e-item">üîß 70 kW work</span>
                                                        <span class="e-item">üå°Ô∏è 30 kW heat</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="constraint-badge fly-up" data-delay="800">
                                                <span class="badge-icon">‚úì</span>
                                                <span>Energy <strong>must be conserved</strong> ‚Äî no magic!</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Carousel Controls -->
                            <div class="carousel-controls">
                                <button class="carousel-btn" onclick="prevConstraintExample()">‚Äπ</button>
                                <div class="carousel-dots" id="constraintDots">
                                    <span class="dot active" onclick="goToConstraintExample(1)"></span>
                                    <span class="dot" onclick="goToConstraintExample(2)"></span>
                                    <span class="dot" onclick="goToConstraintExample(3)"></span>
                                    <span class="dot" onclick="goToConstraintExample(4)"></span>
                                </div>
                                <button class="carousel-btn" onclick="nextConstraintExample()">‚Ä∫</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- WHY NEEDED - Compact Version -->
                <div class="why-needed-bar animate-in delay-3">
                    <div class="why-header">
                        <span class="why-icon">‚ùì</span>
                        <span class="why-title">Why Do We Need This?</span>
                    </div>
                    <div class="why-problems">
                        <div class="problem-item">
                            <span class="prob-icon">‚ùå</span>
                            <span class="prob-text"><strong>Semantic Drift</strong> ‚Äî meanings diverge over training rounds</span>
                        </div>
                        <div class="problem-item">
                            <span class="prob-icon">‚ùå</span>
                            <span class="prob-text"><strong>Feature Collision</strong> ‚Äî conflicting representations get mixed</span>
                        </div>
                        <div class="problem-item">
                            <span class="prob-icon">‚ùå</span>
                            <span class="prob-text"><strong>Physics Violations</strong> ‚Äî impossible predictions like negative wear</span>
                        </div>
                    </div>
                </div>

                <!-- Visual Comparison: FedAvg vs SCFA -->
                <div class="scfa-comparison animate-in delay-3">
                    <h3 class="comparison-title">The Problem & Our Solution</h3>
                    <div class="comparison-container">
                        <!-- FedAvg (Problem) -->
                        <div class="comparison-side problem-side">
                            <div class="side-header problem-header">
                                <span class="side-icon">‚ö†Ô∏è</span>
                                <span class="side-title">FedAvg (Na√Øve Averaging)</span>
                            </div>
                            <div class="embedding-visual">
                                <div class="facility-embedding fac-a">
                                    <div class="emb-label">Factory A</div>
                                    <div class="emb-vector">
                                        <span class="dim dim-active" data-dim="4">"wear" in dim 4</span>
                                        <span class="dim">dim 11: unused</span>
                                    </div>
                                </div>
                                <div class="avg-arrow problem-arrow">
                                    <span>AVERAGE</span>
                                    <svg viewBox="0 0 24 24" class="arrow-icon"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                                </div>
                                <div class="facility-embedding fac-b">
                                    <div class="emb-label">Factory B</div>
                                    <div class="emb-vector">
                                        <span class="dim">dim 4: unused</span>
                                        <span class="dim dim-active" data-dim="11">"wear" in dim 11</span>
                                    </div>
                                </div>
                            </div>
                            <div class="result-box problem-result">
                                <div class="result-icon">üí•</div>
                                <div class="result-text">
                                    <strong>Semantic Collision!</strong>
                                    <span>Both meaningful signals are lost in the average</span>
                                </div>
                            </div>
                        </div>

                        <!-- SCFA (Solution) -->
                        <div class="comparison-side solution-side">
                            <div class="side-header solution-header">
                                <span class="side-icon">‚úÖ</span>
                                <span class="side-title">SCFA (Semantic-Constrained)</span>
                            </div>
                            <div class="embedding-visual">
                                <div class="facility-embedding fac-a aligned">
                                    <div class="emb-label">Factory A</div>
                                    <div class="emb-vector">
                                        <span class="dim dim-active dim-aligned">"wear" ‚Üí shared axis</span>
                                    </div>
                                </div>
                                <div class="transform-step">
                                    <div class="transform-label">1. Detect similar concepts</div>
                                    <div class="transform-label">2. Align to shared axes</div>
                                    <div class="transform-label">3. Then combine safely</div>
                                </div>
                                <div class="facility-embedding fac-b aligned">
                                    <div class="emb-label">Factory B</div>
                                    <div class="emb-vector">
                                        <span class="dim dim-active dim-aligned">"wear" ‚Üí shared axis</span>
                                    </div>
                                </div>
                            </div>
                            <div class="result-box solution-result">
                                <div class="result-icon">‚ú®</div>
                                <div class="result-text">
                                    <strong>Meaning Preserved!</strong>
                                    <span>Features aligned before aggregation</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Takeaway -->
                <div class="scfa-takeaway animate-in delay-4">
                    <div class="takeaway-icon">üéØ</div>
                    <div class="takeaway-content">
                        <div class="takeaway-label">Key Insight</div>
                        <div class="takeaway-text">
                            SCFA ensures the global model is updated <strong>only with client parameters whose feature representations are semantically aligned</strong>, preserving the meaning of learned concepts across heterogeneous data sources.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 2: TERMINOLOGY LEGEND ==================== -->
        <section class="scene" data-scene="2" data-title="Terminology">
            <div class="scene-content">
                <div class="chapter-badge glossary">üìö Glossary</div>
                <h2 class="scene-title animate-in">Key Research Terminology</h2>
                <p class="scene-subtitle animate-in delay-1">Essential concepts you'll encounter in this presentation</p>

                <div class="terminology-grid animate-in delay-2">
                    <!-- Federated Learning Terms -->
                    <div class="term-category">
                        <h3 class="category-title fl-cat">üåê Federated Learning</h3>
                        <div class="term-list">
                            <div class="term-item" data-term="fl">
                                <div class="term-name">Federated Learning (FL)</div>
                                <div class="term-def">Distributed machine learning where data stays local; only model updates are shared</div>
                            </div>
                            <div class="term-item" data-term="fedavg">
                                <div class="term-name">FedAvg</div>
                                <div class="term-def">Standard FL algorithm that averages model updates weighted by data size</div>
                            </div>
                            <div class="term-item" data-term="noniid">
                                <div class="term-name">Non-IID Data</div>
                                <div class="term-def">Non-Identically Distributed data ‚Äî when facilities have different data patterns</div>
                            </div>
                            <div class="term-item" data-term="convergence">
                                <div class="term-name">Convergence</div>
                                <div class="term-def">The process of model reaching optimal performance; measured in communication rounds</div>
                            </div>
                        </div>
                    </div>

                    <!-- SCFA Terms -->
                    <div class="term-category">
                        <h3 class="category-title scfa-cat">‚öôÔ∏è SCFA Framework</h3>
                        <div class="term-list">
                            <div class="term-item" data-term="scfa">
                                <div class="term-name">SCFA</div>
                                <div class="term-def">Semantic-Constrained Federated Aggregation ‚Äî our novel algorithm</div>
                            </div>
                            <div class="term-item" data-term="semantic">
                                <div class="term-name">Semantic Constraints</div>
                                <div class="term-def">Domain rules from knowledge graphs (e.g., "tool wear only increases")</div>
                            </div>
                            <div class="term-item" data-term="validity">
                                <div class="term-name">Validity Score (s<sub>k</sub>)</div>
                                <div class="term-def">Score ‚àà [0,1] measuring how well an update follows constraints</div>
                            </div>
                            <div class="term-item" data-term="violation">
                                <div class="term-name">Violation Rate (œÅ)</div>
                                <div class="term-def">Percentage of constraints violated by model updates</div>
                            </div>
                        </div>
                    </div>

                    <!-- Mathematical Terms -->
                    <div class="term-category">
                        <h3 class="category-title math-cat">üìê Mathematical Notation</h3>
                        <div class="term-list">
                            <div class="term-item" data-term="theta">
                                <div class="term-name">Œ∏ (Theta)</div>
                                <div class="term-def">Hypothesis space reduction factor; Œ∏=0.37 means 63% reduction</div>
                            </div>
                            <div class="term-item" data-term="epsilon">
                                <div class="term-name">Œµ (Epsilon)</div>
                                <div class="term-def">Privacy budget in differential privacy; lower = stronger privacy</div>
                            </div>
                            <div class="term-item" data-term="alpha">
                                <div class="term-name">Œ± (Alpha)</div>
                                <div class="term-def">Aggregation weight for each facility's update</div>
                            </div>
                            <div class="term-item" data-term="rsquared">
                                <div class="term-name">R¬≤</div>
                                <div class="term-def">Coefficient of determination; measures theory-practice fit (1.0 = perfect)</div>
                            </div>
                        </div>
                    </div>

                    <!-- Domain Terms -->
                    <div class="term-category">
                        <h3 class="category-title domain-cat">üè≠ Domain Knowledge</h3>
                        <div class="term-list">
                            <div class="term-item" data-term="ontology">
                                <div class="term-name">Ontology</div>
                                <div class="term-def">Structured knowledge representation (ISA-95, MASON standards)</div>
                            </div>
                            <div class="term-item" data-term="sparql">
                                <div class="term-name">SPARQL Query</div>
                                <div class="term-def">Query language for checking constraints against knowledge graphs</div>
                            </div>
                            <div class="term-item" data-term="temporal">
                                <div class="term-name">Temporal Constraint</div>
                                <div class="term-def">Time-based rules (e.g., wear increases monotonically)</div>
                            </div>
                            <div class="term-item" data-term="causal">
                                <div class="term-name">Causal Constraint</div>
                                <div class="term-def">Cause-effect rules (e.g., failure A precedes failure B)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="legend-footer animate-in delay-3">
                    <div class="legend-tip">
                        <span class="tip-icon">üí°</span>
                        <span class="tip-text">Terms will be <span class="highlight-example">highlighted</span> when mentioned during narration</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 2: HOLISTIC ARCHITECTURE ==================== -->
        <section class="scene" data-scene="3" data-title="Architecture Overview">
            <div class="scene-content">
                <div class="chapter-badge architecture">üèóÔ∏è System Overview</div>
                <h2 class="scene-title animate-in">SCFA Holistic Architecture</h2>
                <p class="scene-subtitle animate-in delay-1">End-to-end view of the research framework</p>

                <div class="holistic-architecture animate-in delay-2">
                    <!-- Input Layer -->
                    <div class="arch-layer input-layer">
                        <div class="layer-label">INPUT LAYER</div>
                        <div class="layer-content">
                            <div class="arch-box data-box">
                                <div class="box-icon">üìä</div>
                                <div class="box-title">Bosch Dataset</div>
                                <div class="box-stats">
                                    <span class="stat-highlight" data-stat="samples">1.18M samples</span>
                                    <span class="stat-highlight" data-stat="features">968 features</span>
                                </div>
                            </div>
                            <div class="arch-box knowledge-box">
                                <div class="box-icon">üß†</div>
                                <div class="box-title">Knowledge Graph</div>
                                <div class="box-stats">
                                    <span class="stat-highlight" data-stat="concepts">5,247 concepts</span>
                                    <span class="stat-highlight" data-stat="constraints">3,000 constraints</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <div class="arch-arrow">‚ñº</div>

                    <!-- Processing Layer -->
                    <div class="arch-layer processing-layer">
                        <div class="layer-label">DISTRIBUTED PROCESSING</div>
                        <div class="layer-content">
                            <div class="facilities-row">
                                <div class="facility-box" style="--facility-color: var(--rq1);">
                                    <span class="fac-icon">üè≠</span>
                                    <span class="fac-label">F1</span>
                                    <span class="fac-data">470K</span>
                                </div>
                                <div class="facility-box" style="--facility-color: var(--rq2);">
                                    <span class="fac-icon">üè≠</span>
                                    <span class="fac-label">F2</span>
                                    <span class="fac-data">120K</span>
                                </div>
                                <div class="facility-box" style="--facility-color: var(--rq3);">
                                    <span class="fac-icon">üè≠</span>
                                    <span class="fac-label">F3</span>
                                    <span class="fac-data">330K</span>
                                </div>
                                <div class="facility-box" style="--facility-color: var(--purple);">
                                    <span class="fac-icon">üè≠</span>
                                    <span class="fac-label">F4</span>
                                    <span class="fac-data">95K</span>
                                </div>
                                <div class="facility-box" style="--facility-color: var(--teal);">
                                    <span class="fac-icon">üè≠</span>
                                    <span class="fac-label">F5</span>
                                    <span class="fac-data">165K</span>
                                </div>
                            </div>
                            <div class="process-label">Local Training (E epochs) ‚Üí Œîw updates</div>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <div class="arch-arrow">‚ñº</div>

                    <!-- SCFA Core -->
                    <div class="arch-layer scfa-layer">
                        <div class="layer-label">SCFA CORE ALGORITHM</div>
                        <div class="layer-content scfa-core">
                            <div class="scfa-step">
                                <div class="step-num">1</div>
                                <div class="step-info">
                                    <div class="step-name">Constraint Validation</div>
                                    <div class="step-formula">s<sub>k</sub> = validate(Œîw<sub>k</sub>, KG)</div>
                                </div>
                            </div>
                            <div class="scfa-arrow">‚Üí</div>
                            <div class="scfa-step">
                                <div class="step-num">2</div>
                                <div class="step-info">
                                    <div class="step-name">Weight Computation</div>
                                    <div class="step-formula">Œ±<sub>k</sub> = n<sub>k</sub>¬∑s<sub>k</sub> / Œ£n<sub>j</sub>¬∑s<sub>j</sub></div>
                                </div>
                            </div>
                            <div class="scfa-arrow">‚Üí</div>
                            <div class="scfa-step">
                                <div class="step-num">3</div>
                                <div class="step-info">
                                    <div class="step-name">Aggregation</div>
                                    <div class="step-formula">w<sup>t+1</sup> = w<sup>t</sup> + Œ£Œ±<sub>k</sub>¬∑Œîw<sub>k</sub></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Arrow -->
                    <div class="arch-arrow">‚ñº</div>

                    <!-- Output Layer - Research Questions -->
                    <div class="arch-layer output-layer">
                        <div class="layer-label">RESEARCH CONTRIBUTIONS</div>
                        <div class="layer-content rq-outputs">
                            <div class="rq-output rq1-out">
                                <div class="rq-header">RQ1: Convergence</div>
                                <div class="rq-theorem">Theorem 1</div>
                                <div class="rq-result">
                                    <span class="stat-highlight" data-stat="convergence">22% faster</span>
                                    <span class="stat-highlight" data-stat="rounds">32 vs 41 rounds</span>
                                </div>
                            </div>
                            <div class="rq-output rq2-out">
                                <div class="rq-header">RQ2: Privacy</div>
                                <div class="rq-theorem">Theorem 2</div>
                                <div class="rq-result">
                                    <span class="stat-highlight" data-stat="privacy">2.7√ó better</span>
                                    <span class="stat-highlight" data-stat="theta">Œ∏ = 0.37</span>
                                </div>
                            </div>
                            <div class="rq-output rq3-out">
                                <div class="rq-header">RQ3: Violations</div>
                                <div class="rq-theorem">Proposition 1</div>
                                <div class="rq-result">
                                    <span class="stat-highlight" data-stat="threshold">œÅ<sub>crit</sub> = 18%</span>
                                    <span class="stat-highlight" data-stat="fit">R¬≤ = 0.93</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="arch-legend animate-in delay-3">
                    <div class="legend-item">
                        <span class="legend-color" style="background: var(--rq1);"></span>
                        <span>RQ1: Convergence Theory</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: var(--rq2);"></span>
                        <span>RQ2: Privacy-Utility Bounds</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: var(--rq3);"></span>
                        <span>RQ3: Violation Impact</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 3: THE STORY BEGINS ==================== -->
        <section class="scene" data-scene="4" data-title="The Story Begins">
            <div class="scene-content">
                <div class="chapter-badge">Chapter 1</div>
                <h2 class="scene-title animate-in">The Manufacturing Nightmare</h2>
                
                <div class="story-container animate-in delay-1">
                    <div class="story-narrator">
                        <div class="narrator-icon">üìñ</div>
                        <div class="narrator-text">
                            <p><strong>Imagine this scenario...</strong></p>
                            <p>You're the CTO of a major manufacturing company running <span class="highlight-blue stat-highlight" data-stat="facilities">five production facilities</span> across the country. Each facility has <span class="highlight-purple stat-highlight" data-stat="sensors">968 sensors</span> generating <span class="highlight-orange stat-highlight" data-stat="measurements">1.18 million measurements</span>.</p>
                        </div>
                    </div>
                </div>

                <div class="visual-container animate-in delay-2">
                    <div class="facility-map">
                        <div class="facility" data-delay="0" style="--color: var(--rq1);">
                            <div class="facility-icon">üè≠</div>
                            <div class="facility-name">Facility 1</div>
                            <div class="facility-data stat-highlight" data-stat="f1-samples">470K samples</div>
                        </div>
                        <div class="facility" data-delay="200" style="--color: var(--rq2);">
                            <div class="facility-icon">üè≠</div>
                            <div class="facility-name">Facility 2</div>
                            <div class="facility-data stat-highlight" data-stat="f2-samples">120K samples</div>
                        </div>
                        <div class="facility" data-delay="400" style="--color: var(--rq3);">
                            <div class="facility-icon">üè≠</div>
                            <div class="facility-name">Facility 3</div>
                            <div class="facility-data stat-highlight" data-stat="f3-samples">330K samples</div>
                        </div>
                        <div class="facility" data-delay="600" style="--color: var(--purple);">
                            <div class="facility-icon">üè≠</div>
                            <div class="facility-name">Facility 4</div>
                            <div class="facility-data stat-highlight" data-stat="f4-samples">95K samples</div>
                        </div>
                        <div class="facility" data-delay="800" style="--color: var(--teal);">
                            <div class="facility-icon">üè≠</div>
                            <div class="facility-name">Facility 5</div>
                            <div class="facility-data stat-highlight" data-stat="f5-samples">165K samples</div>
                        </div>
                    </div>
                    <div class="total-badge animate-in delay-4">
                        <strong>Total:</strong> <span class="stat-highlight" data-stat="total-samples">1.18 Million</span> Measurements
                    </div>
                </div>

                <div class="story-continuation animate-in delay-3">
                    <div class="narrator-text">
                        <p>Your nightmare: <span class="highlight-red">equipment failures</span>. A single unexpected breakdown costs <strong>millions</strong> in downtime.</p>
                        <p>The solution seems obvious: use <strong>machine learning</strong> to predict failures...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 4: THE PROBLEM ==================== -->
        <section class="scene" data-scene="5" data-title="The Problem">
            <div class="scene-content">
                <div class="chapter-badge warning">The Challenge</div>
                <h2 class="scene-title animate-in">But Here's Where It Gets Complicated...</h2>
                
                <div class="problem-grid animate-in delay-1">
                    <div class="problem-card" data-delay="0">
                        <div class="problem-icon">üîí</div>
                        <h3>Privacy Regulations</h3>
                        <p>Facilities <strong>cannot share raw data</strong>. Proprietary information and privacy laws prevent centralization.</p>
                    </div>
                    <div class="problem-card" data-delay="200">
                        <div class="problem-icon">üìä</div>
                        <h3>Non-IID Data</h3>
                        <p>Each plant has different equipment. Their <strong>data distributions don't match</strong>, causing model conflicts.</p>
                    </div>
                    <div class="problem-card" data-delay="400">
                        <div class="problem-icon">üê¢</div>
                        <h3>Slow Convergence</h3>
                        <p>Standard FL requires <span class="stat-highlight" data-stat="slow-rounds">50+ communication rounds</span> with heterogeneous data.</p>
                    </div>
                    <div class="problem-card" data-delay="600">
                        <div class="problem-icon">üéØ</div>
                        <h3>No Domain Knowledge</h3>
                        <p>Existing solutions use algorithmic tricks without understanding <strong>physics and engineering rules</strong>.</p>
                    </div>
                </div>

                <div class="fl-flow-diagram animate-in delay-2">
                    <div class="diagram-title">Standard Federated Learning Flow</div>
                    <div class="fl-flow">
                        <div class="fl-step"><div class="step-box">Local Training</div></div>
                        <div class="fl-arrow">‚Üí</div>
                        <div class="fl-step"><div class="step-box">Send Updates</div></div>
                        <div class="fl-arrow">‚Üí</div>
                        <div class="fl-step problem"><div class="step-box">Aggregate</div><div class="problem-label">‚ö†Ô∏è Models conflict!</div></div>
                        <div class="fl-arrow">‚Üí</div>
                        <div class="fl-step"><div class="step-box">Distribute</div></div>
                    </div>
                </div>

                <div class="story-narrator animate-in delay-3">
                    <div class="narrator-icon">üí°</div>
                    <div class="narrator-text highlight-text">
                        <p><em>But federated learning has a major problem that nobody has fully solved... until now.</em></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 5: OUR INSIGHT ==================== -->
        <section class="scene" data-scene="6" data-title="Our Insight">
            <div class="scene-content">
                <div class="chapter-badge success">The Breakthrough</div>
                <h2 class="scene-title animate-in">What If FL Could Understand Manufacturing?</h2>
                
                <div class="insight-box animate-in delay-1">
                    <div class="insight-icon">üß†</div>
                    <div class="insight-content">
                        <p class="insight-question">What if our federated learning system <strong>knew</strong> that:</p>
                        <ul class="insight-list">
                            <li class="animate-item" data-delay="500">‚è±Ô∏è Tool wear <span class="highlight-blue">only increases</span> over time ‚Äî never decreases?</li>
                            <li class="animate-item" data-delay="700">üîó Certain failures must happen in a <span class="highlight-green">specific causal order</span>?</li>
                            <li class="animate-item" data-delay="900">üìä Temperature predictions <span class="highlight-orange">can't exceed physical limits</span>?</li>
                            <li class="animate-item" data-delay="1100">‚öõÔ∏è Energy and mass must be <span class="highlight-purple">conserved</span>?</li>
                        </ul>
                    </div>
                </div>

                <div class="knowledge-sources animate-in delay-2">
                    <h3>Manufacturing Knowledge Sources</h3>
                    <div class="sources-grid">
                        <div class="source-card" data-delay="0">
                            <div class="source-header isa95">ISA-95</div>
                            <div class="source-stats">
                                <div class="source-number stat-highlight" data-stat="isa95">2,341</div>
                                <div class="source-label">concepts</div>
                            </div>
                            <div class="source-desc">Manufacturing operations taxonomy</div>
                        </div>
                        <div class="source-card" data-delay="200">
                            <div class="source-header mason">MASON</div>
                            <div class="source-stats">
                                <div class="source-number stat-highlight" data-stat="mason">1,287</div>
                                <div class="source-label">concepts</div>
                            </div>
                            <div class="source-desc">Equipment & failure causality</div>
                        </div>
                        <div class="source-card" data-delay="400">
                            <div class="source-header nist">NIST</div>
                            <div class="source-stats">
                                <div class="source-number stat-highlight" data-stat="nist">891</div>
                                <div class="source-label">concepts</div>
                            </div>
                            <div class="source-desc">Additive manufacturing</div>
                        </div>
                        <div class="source-card" data-delay="600">
                            <div class="source-header schema">Schema.org</div>
                            <div class="source-stats">
                                <div class="source-number stat-highlight" data-stat="schema">728</div>
                                <div class="source-label">concepts</div>
                            </div>
                            <div class="source-desc">Product definitions</div>
                        </div>
                    </div>
                    <div class="total-knowledge">
                        <div class="total-item">
                            <span class="total-number stat-highlight" data-stat="total-concepts">5,247</span>
                            <span class="total-label">Total Concepts</span>
                        </div>
                        <div class="total-item">
                            <span class="total-number stat-highlight" data-stat="relationships">12,893</span>
                            <span class="total-label">Relationships</span>
                        </div>
                        <div class="total-item">
                            <span class="total-number stat-highlight" data-stat="constraint-rules">3,000</span>
                            <span class="total-label">Constraint Rules</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 6: KNOWLEDGE GRAPH DEEP DIVE ==================== -->
        <section class="scene" data-scene="7" data-title="Knowledge Graph">
            <div class="scene-content">
                <div class="chapter-badge glossary">üï∏Ô∏è Deep Dive</div>
                <h2 class="scene-title animate-in">Interactive Knowledge Graph</h2>
                <p class="scene-subtitle animate-in delay-1">Explore semantic structure & create custom graphs</p>

                <!-- Graph Controls -->
                <div class="kg-controls animate-in delay-2">
                    <div class="kg-tabs">
                        <button class="kg-tab active" onclick="showDefaultGraph()">üìä SCFA Research Graph</button>
                        <button class="kg-tab" onclick="showCustomGraph()">‚úèÔ∏è Custom Graph Builder</button>
                    </div>
                    <div class="kg-actions">
                        <button class="kg-action-btn" onclick="fitGraph()" title="Fit to view">üîç Fit</button>
                        <button class="kg-action-btn" onclick="togglePhysics()" title="Toggle physics">‚ö° Physics</button>
                        <button class="kg-action-btn" onclick="exportGraph()" title="Export data">üíæ Export</button>
                        <button class="kg-action-btn fullscreen-btn" onclick="toggleFullscreen()" title="Toggle fullscreen">‚õ∂ Fullscreen</button>
                    </div>
                </div>

                <!-- Main Graph Container -->
                <div class="kg-main-container animate-in delay-2" id="kgMainContainer">
                    <!-- Graph Visualization -->
                    <div id="knowledgeGraph" class="kg-canvas"></div>
                    
                    <!-- Side Panel -->
                    <div class="kg-side-panel">
                        <!-- Default Graph Legend -->
                        <div id="defaultLegend" class="kg-legend">
                            <h4>Node Types</h4>
                            <div class="legend-items">
                                <div class="legend-row"><span class="legend-dot" style="background: #2196f3;"></span> Equipment</div>
                                <div class="legend-row"><span class="legend-dot" style="background: #009688;"></span> Sensor</div>
                                <div class="legend-row"><span class="legend-dot" style="background: #ff9800;"></span> Process</div>
                                <div class="legend-row"><span class="legend-dot" style="background: #e91e63;"></span> Failure</div>
                                <div class="legend-row"><span class="legend-dot" style="background: #4caf50;"></span> Prediction</div>
                                <div class="legend-row"><span class="legend-dot" style="background: #9c27b0;"></span> Constraint</div>
                            </div>
                            <h4 style="margin-top: 15px;">Edge Types</h4>
                            <div class="legend-items">
                                <div class="legend-row"><span class="legend-line structural"></span> Structural</div>
                                <div class="legend-row"><span class="legend-line causal"></span> Causal</div>
                                <div class="legend-row"><span class="legend-line temporal"></span> Temporal</div>
                                <div class="legend-row"><span class="legend-line constraint"></span> Constraint</div>
                            </div>
                            <div class="kg-stats-mini">
                                <div><strong id="nodeCount">24</strong> nodes</div>
                                <div><strong id="edgeCount">32</strong> edges</div>
                            </div>
                        </div>

                        <!-- Custom Graph Builder -->
                        <div id="customBuilder" class="kg-builder" style="display: none;">
                            <h4>Add Node</h4>
                            <input type="text" id="nodeName" placeholder="Node name..." class="kg-input">
                            <select id="nodeType" class="kg-select">
                                <option value="equipment">üè≠ Equipment</option>
                                <option value="sensor">üì° Sensor</option>
                                <option value="process">‚öôÔ∏è Process</option>
                                <option value="failure">‚ö†Ô∏è Failure</option>
                                <option value="prediction">üéØ Prediction</option>
                                <option value="constraint">üìã Constraint</option>
                                <option value="custom">üî∑ Custom</option>
                            </select>
                            <button class="kg-btn primary" onclick="addCustomNode()">+ Add Node</button>

                            <h4 style="margin-top: 15px;">Add Edge</h4>
                            <select id="edgeFrom" class="kg-select">
                                <option value="">From node...</option>
                            </select>
                            <select id="edgeTo" class="kg-select">
                                <option value="">To node...</option>
                            </select>
                            <input type="text" id="edgeLabel" placeholder="Relationship..." class="kg-input">
                            <select id="edgeType" class="kg-select">
                                <option value="structural">Structural (gray)</option>
                                <option value="causal">Causal (orange)</option>
                                <option value="temporal">Temporal (blue)</option>
                                <option value="constraint">Constraint (purple)</option>
                            </select>
                            <button class="kg-btn primary" onclick="addCustomEdge()">+ Add Edge</button>

                            <div class="kg-builder-actions">
                                <button class="kg-btn secondary" onclick="clearCustomGraph()">üóëÔ∏è Clear All</button>
                                <button class="kg-btn secondary" onclick="loadSampleCustom()">üì• Load Sample</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Constraint Derivation Panel -->
                <div class="constraint-derivation animate-in delay-3">
                    <h3>Constraints Derived from Graph Structure</h3>
                    <div class="derivation-grid">
                        <div class="derivation-card" onclick="highlightPath('temporal')">
                            <div class="deriv-header temporal">‚è±Ô∏è Temporal Constraint</div>
                            <div class="deriv-path">Tool ‚Üí exhibits ‚Üí ToolWear</div>
                            <div class="deriv-rule">‚àÇ(wear)/‚àÇt ‚â• 0</div>
                            <div class="deriv-meaning">"Wear monotonically increases"</div>
                        </div>
                        <div class="derivation-card" onclick="highlightPath('causal')">
                            <div class="deriv-header causal">üîó Causal Constraint</div>
                            <div class="deriv-path">ToolWear ‚Üí leadsto ‚Üí Failure</div>
                            <div class="deriv-rule">P(fail|wear‚Üë) > P(fail|wear‚Üì)</div>
                            <div class="deriv-meaning">"High wear precedes failure"</div>
                        </div>
                        <div class="derivation-card" onclick="highlightPath('capacity')">
                            <div class="deriv-header capacity">üìä Capacity Constraint</div>
                            <div class="deriv-path">Sensor ‚Üí monitors ‚Üí Temperature</div>
                            <div class="deriv-rule">T ‚àà [T<sub>min</sub>, T<sub>max</sub>]</div>
                            <div class="deriv-meaning">"Physical operating bounds"</div>
                        </div>
                        <div class="derivation-card" onclick="highlightPath('physical')">
                            <div class="deriv-header physical">‚öõÔ∏è Physical Constraint</div>
                            <div class="deriv-path">Energy ‚Üí conserved ‚Üí System</div>
                            <div class="deriv-rule">Œ£E<sub>in</sub> = Œ£E<sub>out</sub></div>
                            <div class="deriv-meaning">"Conservation laws hold"</div>
                        </div>
                    </div>
                </div>

                <!-- Stats Summary -->
                <div class="kg-summary animate-in delay-4">
                    <div class="summary-stat">
                        <span class="summary-icon">üîµ</span>
                        <span class="summary-value stat-highlight" data-stat="kg-nodes">5,247</span>
                        <span class="summary-label">Concepts</span>
                    </div>
                    <div class="summary-stat">
                        <span class="summary-icon">‚û°Ô∏è</span>
                        <span class="summary-value stat-highlight" data-stat="kg-edges">12,893</span>
                        <span class="summary-label">Relations</span>
                    </div>
                    <div class="summary-stat">
                        <span class="summary-icon">üìã</span>
                        <span class="summary-value stat-highlight" data-stat="kg-constraints">3,000</span>
                        <span class="summary-label">Constraints</span>
                    </div>
                    <div class="summary-stat">
                        <span class="summary-icon">üìö</span>
                        <span class="summary-value">4</span>
                        <span class="summary-label">Ontologies</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 8: KNOWLEDGE GRAPH CONSTRUCTION (Deep Dive 1) ==================== -->
        <section class="scene" data-scene="8" data-title="KG Construction">
            <div class="scene-content">
                <div class="chapter-badge technical-deepdive">üî¨ Addressing Technical Deep Dive #1</div>
                <h2 class="scene-title animate-in">Knowledge Graph Construction Pipeline</h2>
                <p class="scene-subtitle animate-in delay-1">How semantics and constraints are systematically extracted and integrated</p>

                <!-- Construction Pipeline Visualization -->
                <div class="kg-construction-pipeline animate-in delay-2">
                    
                    <!-- Phase 1: Source Ontologies -->
                    <div class="pipeline-phase" data-phase="1">
                        <div class="phase-header source-phase">
                            <span class="phase-num">Phase 1</span>
                            <span class="phase-title">Source Ontology Acquisition</span>
                        </div>
                        <div class="phase-content">
                            <div class="ontology-sources">
                                <div class="ont-source fly-in-item" data-delay="0">
                                    <div class="ont-icon">üè≠</div>
                                    <div class="ont-name">ISA-95</div>
                                    <div class="ont-desc">Manufacturing Operations</div>
                                    <div class="ont-stats">
                                        <span class="ont-stat">2,341 classes</span>
                                        <span class="ont-stat">4,892 properties</span>
                                    </div>
                                    <div class="ont-format">Format: OWL/RDF</div>
                                </div>
                                <div class="ont-source fly-in-item" data-delay="150">
                                    <div class="ont-icon">‚öôÔ∏è</div>
                                    <div class="ont-name">MASON</div>
                                    <div class="ont-desc">Equipment Dependencies</div>
                                    <div class="ont-stats">
                                        <span class="ont-stat">1,287 classes</span>
                                        <span class="ont-stat">2,156 properties</span>
                                    </div>
                                    <div class="ont-format">Format: OWL/RDF</div>
                                </div>
                                <div class="ont-source fly-in-item" data-delay="300">
                                    <div class="ont-icon">üî©</div>
                                    <div class="ont-name">NIST AM</div>
                                    <div class="ont-desc">Additive Manufacturing</div>
                                    <div class="ont-stats">
                                        <span class="ont-stat">891 classes</span>
                                        <span class="ont-stat">1,543 properties</span>
                                    </div>
                                    <div class="ont-format">Format: OWL/RDF</div>
                                </div>
                                <div class="ont-source fly-in-item" data-delay="450">
                                    <div class="ont-icon">üì¶</div>
                                    <div class="ont-name">Schema.org</div>
                                    <div class="ont-desc">Product Definitions</div>
                                    <div class="ont-stats">
                                        <span class="ont-stat">728 classes</span>
                                        <span class="ont-stat">1,205 properties</span>
                                    </div>
                                    <div class="ont-format">Format: JSON-LD</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pipeline Arrow -->
                    <div class="pipeline-arrow animate-pulse">
                        <div class="arrow-content">
                            <span class="arrow-icon">‚¨áÔ∏è</span>
                            <span class="arrow-label">rdflib.parse() + owlready2.load()</span>
                        </div>
                    </div>

                    <!-- Phase 2: Semantic Extraction -->
                    <div class="pipeline-phase" data-phase="2">
                        <div class="phase-header extraction-phase">
                            <span class="phase-num">Phase 2</span>
                            <span class="phase-title">Semantic Entity & Relationship Extraction</span>
                        </div>
                        <div class="phase-content">
                            <div class="extraction-process">
                                <div class="extraction-step fly-in-item" data-delay="600">
                                    <div class="ext-header">
                                        <span class="ext-icon">üè∑Ô∏è</span>
                                        <span class="ext-title">Entity Extraction</span>
                                    </div>
                                    <div class="ext-code">
                                        <code>for cls in onto.classes():</code>
                                        <code>    entity = extract_class_metadata(cls)</code>
                                        <code>    kg.add_node(entity.uri, **entity.attrs)</code>
                                    </div>
                                    <div class="ext-output">
                                        <span class="output-badge">5,247 entities</span>
                                    </div>
                                </div>
                                <div class="extraction-step fly-in-item" data-delay="750">
                                    <div class="ext-header">
                                        <span class="ext-icon">üîó</span>
                                        <span class="ext-title">Relationship Mapping</span>
                                    </div>
                                    <div class="ext-code">
                                        <code>for prop in onto.object_properties():</code>
                                        <code>    rel = map_property_to_edge(prop)</code>
                                        <code>    kg.add_edge(rel.source, rel.target, **rel.attrs)</code>
                                    </div>
                                    <div class="ext-output">
                                        <span class="output-badge">12,893 relationships</span>
                                    </div>
                                </div>
                                <div class="extraction-step fly-in-item" data-delay="900">
                                    <div class="ext-header">
                                        <span class="ext-icon">üìê</span>
                                        <span class="ext-title">Semantic Alignment</span>
                                    </div>
                                    <div class="ext-code">
                                        <code>aligned = align_cross_ontology_concepts(</code>
                                        <code>    entities, similarity_threshold=0.85)</code>
                                        <code>kg.merge_equivalent_nodes(aligned)</code>
                                    </div>
                                    <div class="ext-output">
                                        <span class="output-badge">847 alignments</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pipeline Arrow -->
                    <div class="pipeline-arrow animate-pulse">
                        <div class="arrow-content">
                            <span class="arrow-icon">‚¨áÔ∏è</span>
                            <span class="arrow-label">SPARQL Constraint Queries</span>
                        </div>
                    </div>

                    <!-- Phase 3: Constraint Derivation -->
                    <div class="pipeline-phase" data-phase="3">
                        <div class="phase-header constraint-phase">
                            <span class="phase-num">Phase 3</span>
                            <span class="phase-title">Constraint Rule Derivation</span>
                        </div>
                        <div class="phase-content">
                            <div class="constraint-derivation">
                                <div class="derivation-category fly-in-item" data-delay="1050">
                                    <div class="deriv-header temporal-deriv">
                                        <span class="deriv-icon">‚è±Ô∏è</span>
                                        <span class="deriv-type">Temporal Constraints</span>
                                        <span class="deriv-count">892 rules</span>
                                    </div>
                                    <div class="deriv-sparql">
                                        <code class="sparql">SELECT ?property WHERE {</code>
                                        <code class="sparql">  ?property rdf:type :MonotonicProperty .</code>
                                        <code class="sparql">  ?property :appliesTo :ToolWear .</code>
                                        <code class="sparql">}</code>
                                    </div>
                                    <div class="deriv-example">
                                        <span class="ex-arrow">‚Üí</span>
                                        <span class="ex-rule">‚àÇ(tool_wear)/‚àÇt ‚â• 0</span>
                                    </div>
                                </div>
                                <div class="derivation-category fly-in-item" data-delay="1200">
                                    <div class="deriv-header causal-deriv">
                                        <span class="deriv-icon">üîó</span>
                                        <span class="deriv-type">Causal Constraints</span>
                                        <span class="deriv-count">756 rules</span>
                                    </div>
                                    <div class="deriv-sparql">
                                        <code class="sparql">SELECT ?cause ?effect WHERE {</code>
                                        <code class="sparql">  ?cause :causesPrecedes ?effect .</code>
                                        <code class="sparql">  ?cause rdf:type :FailureMode .</code>
                                        <code class="sparql">}</code>
                                    </div>
                                    <div class="deriv-example">
                                        <span class="ex-arrow">‚Üí</span>
                                        <span class="ex-rule">vibration_anomaly ‚â∫ bearing_failure</span>
                                    </div>
                                </div>
                                <div class="derivation-category fly-in-item" data-delay="1350">
                                    <div class="deriv-header capacity-deriv">
                                        <span class="deriv-icon">üìè</span>
                                        <span class="deriv-type">Capacity Constraints</span>
                                        <span class="deriv-count">634 rules</span>
                                    </div>
                                    <div class="deriv-sparql">
                                        <code class="sparql">SELECT ?param ?min ?max WHERE {</code>
                                        <code class="sparql">  ?param :hasOperatingRange ?range .</code>
                                        <code class="sparql">  ?range :minValue ?min ; :maxValue ?max .</code>
                                        <code class="sparql">}</code>
                                    </div>
                                    <div class="deriv-example">
                                        <span class="ex-arrow">‚Üí</span>
                                        <span class="ex-rule">T ‚àà [20¬∞C, 200¬∞C]</span>
                                    </div>
                                </div>
                                <div class="derivation-category fly-in-item" data-delay="1500">
                                    <div class="deriv-header physical-deriv">
                                        <span class="deriv-icon">‚öõÔ∏è</span>
                                        <span class="deriv-type">Physical Constraints</span>
                                        <span class="deriv-count">718 rules</span>
                                    </div>
                                    <div class="deriv-sparql">
                                        <code class="sparql">SELECT ?law ?vars WHERE {</code>
                                        <code class="sparql">  ?law rdf:type :ConservationLaw .</code>
                                        <code class="sparql">  ?law :conserves ?quantity .</code>
                                        <code class="sparql">}</code>
                                    </div>
                                    <div class="deriv-example">
                                        <span class="ex-arrow">‚Üí</span>
                                        <span class="ex-rule">Œ£E<sub>in</sub> = Œ£E<sub>out</sub></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Insight Box -->
                <div class="academic-insight animate-in delay-3">
                    <div class="insight-header">
                        <span class="insight-icon">üéì</span>
                        <span class="insight-title">Key Academic Contribution</span>
                    </div>
                    <div class="insight-body">
                        <p><strong>Semantics guide construction:</strong> Entity alignment ensures cross-ontology concepts (e.g., "ToolWear" in ISA-95 ‚Üî "WearDegradation" in MASON) share unified representations.</p>
                        <p><strong>Constraints emerge from semantics:</strong> SPARQL queries extract implicit rules from explicit ontological relationships‚Äîconstraints are <em>derived</em>, not manually specified.</p>
                        <div class="insight-stats">
                            <div class="stat-item">
                                <span class="stat-val">5,247</span>
                                <span class="stat-lbl">Semantic Entities</span>
                            </div>
                            <div class="stat-arrow">‚Üí</div>
                            <div class="stat-item">
                                <span class="stat-val">12,893</span>
                                <span class="stat-lbl">Relationships</span>
                            </div>
                            <div class="stat-arrow">‚Üí</div>
                            <div class="stat-item">
                                <span class="stat-val">3,000</span>
                                <span class="stat-lbl">Constraint Rules</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 9: CONSTRAINT VALIDATION PROCESS (Deep Dive 2) ==================== -->
        <section class="scene" data-scene="9" data-title="Constraint Validation">
            <div class="scene-content">
                <div class="chapter-badge technical-deepdive">üî¨ Addressing Technical Deep Dive #2</div>
                <h2 class="scene-title animate-in">Constraint Validation Mechanism</h2>
                <p class="scene-subtitle animate-in delay-1">Detailed validation process without problematic high/low categorization</p>

                <!-- Validation Architecture -->
                <div class="validation-architecture animate-in delay-2">
                    
                    <!-- Input: Model Updates -->
                    <div class="val-stage input-stage">
                        <div class="stage-label">Input</div>
                        <div class="stage-content">
                            <div class="model-updates">
                                <div class="update-box" data-facility="1">
                                    <span class="fac-icon">üè≠‚ÇÅ</span>
                                    <span class="update-symbol">Œîw‚ÇÅ</span>
                                </div>
                                <div class="update-box" data-facility="2">
                                    <span class="fac-icon">üè≠‚ÇÇ</span>
                                    <span class="update-symbol">Œîw‚ÇÇ</span>
                                </div>
                                <div class="update-box" data-facility="3">
                                    <span class="fac-icon">üè≠‚ÇÉ</span>
                                    <span class="update-symbol">Œîw‚ÇÉ</span>
                                </div>
                                <div class="update-box" data-facility="4">
                                    <span class="fac-icon">üè≠‚ÇÑ</span>
                                    <span class="update-symbol">Œîw‚ÇÑ</span>
                                </div>
                                <div class="update-box" data-facility="5">
                                    <span class="fac-icon">üè≠‚ÇÖ</span>
                                    <span class="update-symbol">Œîw‚ÇÖ</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Validation Flow Arrow -->
                    <div class="val-flow-arrow">
                        <svg viewBox="0 0 100 40" class="flow-svg">
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#9c27b0"/>
                                </marker>
                            </defs>
                            <line x1="10" y1="20" x2="85" y2="20" stroke="#9c27b0" stroke-width="3" marker-end="url(#arrowhead)"/>
                        </svg>
                        <span class="flow-label">For each Œîw‚Çñ</span>
                    </div>

                    <!-- Core Validation Process -->
                    <div class="val-stage validation-core">
                        <div class="stage-label">Constraint Validation Engine</div>
                        <div class="stage-content">
                            
                            <!-- Step 1: Prediction Generation -->
                            <div class="val-step" data-step="1">
                                <div class="step-badge">Step 1</div>
                                <div class="step-title">Generate Predictions</div>
                                <div class="step-detail">
                                    <div class="prediction-gen">
                                        <div class="pred-input">
                                            <span>w<sup>t</sup> + Œîw‚Çñ</span>
                                        </div>
                                        <div class="pred-arrow">‚Üí</div>
                                        <div class="pred-output">
                                            <span>≈∑‚Çñ = f(X; w<sup>t</sup> + Œîw‚Çñ)</span>
                                        </div>
                                    </div>
                                    <div class="step-note">Apply candidate update to validation samples</div>
                                </div>
                            </div>

                            <!-- Step 2: Per-Constraint Checking -->
                            <div class="val-step" data-step="2">
                                <div class="step-badge">Step 2</div>
                                <div class="step-title">Per-Constraint Satisfaction Check</div>
                                <div class="step-detail">
                                    <div class="constraint-checks">
                                        <div class="check-item temporal-check">
                                            <div class="check-header">
                                                <span class="check-icon">‚è±Ô∏è</span>
                                                <span class="check-type">Temporal</span>
                                            </div>
                                            <div class="check-formula">
                                                <code>v<sub>i</sub> = ùüô[≈∑<sub>t+1</sub> ‚â• ≈∑<sub>t</sub>]</code>
                                            </div>
                                            <div class="check-visual">
                                                <span class="cv-label">Check:</span>
                                                <span class="cv-example">0.82 ‚Üí 0.85 ‚úì</span>
                                            </div>
                                        </div>
                                        <div class="check-item causal-check">
                                            <div class="check-header">
                                                <span class="check-icon">üîó</span>
                                                <span class="check-type">Causal</span>
                                            </div>
                                            <div class="check-formula">
                                                <code>v<sub>i</sub> = ùüô[t(cause) < t(effect)]</code>
                                            </div>
                                            <div class="check-visual">
                                                <span class="cv-label">Check:</span>
                                                <span class="cv-example">A‚â∫B‚â∫C ‚úì</span>
                                            </div>
                                        </div>
                                        <div class="check-item capacity-check">
                                            <div class="check-header">
                                                <span class="check-icon">üìè</span>
                                                <span class="check-type">Capacity</span>
                                            </div>
                                            <div class="check-formula">
                                                <code>v<sub>i</sub> = ùüô[≈∑ ‚àà [min, max]]</code>
                                            </div>
                                            <div class="check-visual">
                                                <span class="cv-label">Check:</span>
                                                <span class="cv-example">85¬∞C ‚àà [20,200] ‚úì</span>
                                            </div>
                                        </div>
                                        <div class="check-item physical-check">
                                            <div class="check-header">
                                                <span class="check-icon">‚öõÔ∏è</span>
                                                <span class="check-type">Physical</span>
                                            </div>
                                            <div class="check-formula">
                                                <code>v<sub>i</sub> = ùüô[|Œ£in - Œ£out| < Œµ]</code>
                                            </div>
                                            <div class="check-visual">
                                                <span class="cv-label">Check:</span>
                                                <span class="cv-example">|100-99.8|<0.5 ‚úì</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Score Aggregation -->
                            <div class="val-step" data-step="3">
                                <div class="step-badge">Step 3</div>
                                <div class="step-title">Continuous Validity Score Computation</div>
                                <div class="step-detail">
                                    <div class="score-computation">
                                        <div class="score-formula-box">
                                            <div class="formula-main">
                                                s<sub>k</sub> = <span class="frac"><span class="num">1</span><span class="den">|C|</span></span> Œ£<sub>i‚ààC</sub> v<sub>i</sub>
                                            </div>
                                            <div class="formula-range">s<sub>k</sub> ‚àà [0, 1]</div>
                                        </div>
                                        <div class="score-explanation">
                                            <div class="exp-item">
                                                <span class="exp-icon">üìä</span>
                                                <span class="exp-text"><strong>Continuous score</strong> ‚Äî NOT binary accept/reject</span>
                                            </div>
                                            <div class="exp-item">
                                                <span class="exp-icon">‚öñÔ∏è</span>
                                                <span class="exp-text"><strong>Equal weighting</strong> ‚Äî all constraints count equally</span>
                                            </div>
                                            <div class="exp-item">
                                                <span class="exp-icon">üö´</span>
                                                <span class="exp-text"><strong>No categorization</strong> ‚Äî avoids high/low bias</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Output: Validity Scores -->
                    <div class="val-flow-arrow">
                        <svg viewBox="0 0 100 40" class="flow-svg">
                            <line x1="10" y1="20" x2="85" y2="20" stroke="#4caf50" stroke-width="3" marker-end="url(#arrowhead)"/>
                        </svg>
                    </div>

                    <div class="val-stage output-stage">
                        <div class="stage-label">Validity Scores</div>
                        <div class="stage-content">
                            <div class="validity-scores">
                                <div class="score-box high-score" data-facility="1">
                                    <span class="fac-label">Facility 1</span>
                                    <span class="score-val">s‚ÇÅ = 0.94</span>
                                    <div class="score-bar"><div class="bar-fill" style="width: 94%"></div></div>
                                </div>
                                <div class="score-box medium-score" data-facility="2">
                                    <span class="fac-label">Facility 2</span>
                                    <span class="score-val">s‚ÇÇ = 0.78</span>
                                    <div class="score-bar"><div class="bar-fill" style="width: 78%"></div></div>
                                </div>
                                <div class="score-box high-score" data-facility="3">
                                    <span class="fac-label">Facility 3</span>
                                    <span class="score-val">s‚ÇÉ = 0.91</span>
                                    <div class="score-bar"><div class="bar-fill" style="width: 91%"></div></div>
                                </div>
                                <div class="score-box low-score" data-facility="4">
                                    <span class="fac-label">Facility 4</span>
                                    <span class="score-val">s‚ÇÑ = 0.62</span>
                                    <div class="score-bar"><div class="bar-fill" style="width: 62%"></div></div>
                                </div>
                                <div class="score-box medium-score" data-facility="5">
                                    <span class="fac-label">Facility 5</span>
                                    <span class="score-val">s‚ÇÖ = 0.85</span>
                                    <div class="score-bar"><div class="bar-fill" style="width: 85%"></div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Why No Categorization -->
                <div class="no-categorization-box animate-in delay-3">
                    <div class="nc-header">
                        <span class="nc-icon">‚ö†Ô∏è</span>
                        <span class="nc-title">Why We Avoid High/Low Constraint Categorization</span>
                    </div>
                    <div class="nc-content">
                        <div class="nc-problem">
                            <div class="problem-title">‚ùå Problems with Categorical Impact Levels</div>
                            <ul class="problem-list">
                                <li><strong>Domain-dependent:</strong> "High impact" in one facility may be "low" in another</li>
                                <li><strong>Context-sensitive:</strong> Temperature constraint criticality depends on operation type</li>
                                <li><strong>Introduces bias:</strong> Manual categorization embeds human assumptions</li>
                                <li><strong>Non-transferable:</strong> Categories don't generalize across domains</li>
                            </ul>
                        </div>
                        <div class="nc-solution">
                            <div class="solution-title">‚úì Our Approach: Uniform Weighting + Continuous Scores</div>
                            <ul class="solution-list">
                                <li><strong>Equal contribution:</strong> Each constraint contributes 1/|C| to validity score</li>
                                <li><strong>Soft influence:</strong> Score smoothly modulates aggregation weight</li>
                                <li><strong>Data-driven importance:</strong> Constraints that matter will naturally affect predictions more</li>
                                <li><strong>Transparent:</strong> No hidden assumptions‚Äîfully reproducible</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Aggregation Weight Formula -->
                <div class="weight-formula-section animate-in delay-3">
                    <div class="formula-header">
                        <span class="formula-title">Final Aggregation Weight Computation</span>
                    </div>
                    <div class="formula-display">
                        <div class="main-formula">
                            Œ±<sub>k</sub> = <span class="frac"><span class="num">n<sub>k</sub> ¬∑ s<sub>k</sub></span><span class="den">Œ£<sub>j</sub> n<sub>j</sub> ¬∑ s<sub>j</sub></span></span>
                        </div>
                        <div class="formula-legend">
                            <span class="legend-item"><strong>n<sub>k</sub></strong> = data samples at facility k</span>
                            <span class="legend-item"><strong>s<sub>k</sub></strong> = validity score ‚àà [0,1]</span>
                            <span class="legend-item"><strong>Œ±<sub>k</sub></strong> = aggregation weight</span>
                        </div>
                    </div>
                    <div class="formula-insight">
                        <span class="insight-icon">üí°</span>
                        <span class="insight-text">Updates with higher constraint satisfaction receive proportionally higher weights‚Äîno threshold, no categorization, just smooth modulation.</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 10: CONSTRAINT IMPACT ON CONVERGENCE (Deep Dive 3) ==================== -->
        <section class="scene" data-scene="10" data-title="Convergence Impact">
            <div class="scene-content">
                <div class="chapter-badge technical-deepdive">üî¨ Addressing Technical Deep Dive #3</div>
                <h2 class="scene-title animate-in">Impact of Constraints on Convergence</h2>
                <p class="scene-subtitle animate-in delay-1">Mathematical analysis with empirical validation</p>

                <!-- Convergence Comparison Visualization -->
                <div class="convergence-analysis animate-in delay-2">
                    
                    <!-- Theoretical Framework -->
                    <div class="convergence-theory">
                        <div class="theory-header">
                            <span class="theory-icon">üìê</span>
                            <span class="theory-title">Theoretical Foundation</span>
                        </div>
                        
                        <div class="theory-content">
                            <!-- Key Theorem -->
                            <div class="theorem-box">
                                <div class="theorem-label">Theorem 1 (Convergence Rate)</div>
                                <div class="theorem-statement">
                                    Under SCFA with semantic constraints C, the convergence rate satisfies:
                                </div>
                                <div class="theorem-formula">
                                    E[‚Äñw<sup>t</sup> - w*‚Äñ¬≤] ‚â§ (1 - ŒºŒ∑)<sup>t</sup> ¬∑ ‚Äñw<sup>0</sup> - w*‚Äñ¬≤ + <span class="frac"><span class="num">Œ∑¬≤œÉ¬≤</span><span class="den">Œº</span></span> ¬∑ <span class="highlight-term">(1 - œÅ)</span>
                                </div>
                                <div class="theorem-terms">
                                    <div class="term-item">
                                        <span class="term-symbol">œÅ</span>
                                        <span class="term-def">= constraint violation rate</span>
                                    </div>
                                    <div class="term-item">
                                        <span class="term-symbol">œÉ¬≤</span>
                                        <span class="term-def">= gradient variance</span>
                                    </div>
                                    <div class="term-item">
                                        <span class="term-symbol">(1-œÅ)</span>
                                        <span class="term-def">= variance reduction factor</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Key Insight -->
                            <div class="insight-callout">
                                <div class="callout-icon">üéØ</div>
                                <div class="callout-content">
                                    <strong>Key Insight:</strong> The (1-œÅ) term shows constraints <em>directly reduce</em> the variance bound, leading to faster convergence when œÅ < 18%.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Visual Convergence Comparison -->
                    <div class="convergence-visual">
                        <div class="visual-header">
                            <span class="visual-icon">üìä</span>
                            <span class="visual-title">Convergence Trajectory Comparison</span>
                        </div>
                        
                        <div class="convergence-chart">
                            <!-- Y-axis -->
                            <div class="chart-yaxis">
                                <span class="axis-label">Loss</span>
                                <div class="axis-ticks">
                                    <span>1.0</span>
                                    <span>0.8</span>
                                    <span>0.6</span>
                                    <span>0.4</span>
                                    <span>0.2</span>
                                    <span>0.0</span>
                                </div>
                            </div>
                            
                            <!-- Chart Area -->
                            <div class="chart-area">
                                <!-- Grid lines -->
                                <div class="chart-grid">
                                    <div class="grid-line"></div>
                                    <div class="grid-line"></div>
                                    <div class="grid-line"></div>
                                    <div class="grid-line"></div>
                                    <div class="grid-line"></div>
                                </div>
                                
                                <!-- FedAvg Line (slower) -->
                                <svg class="convergence-line fedavg-line" viewBox="0 0 400 200" preserveAspectRatio="none">
                                    <path class="line-path fedavg-path" d="M0,10 C50,30 100,80 150,110 S250,160 350,180 L400,185" fill="none" stroke="#f44336" stroke-width="3"/>
                                    <circle class="end-point fedavg-point" cx="350" cy="180" r="6" fill="#f44336"/>
                                </svg>
                                
                                <!-- SCFA Line (faster) -->
                                <svg class="convergence-line scfa-line" viewBox="0 0 400 200" preserveAspectRatio="none">
                                    <path class="line-path scfa-path" d="M0,10 C30,50 60,100 100,140 S180,175 260,185 L280,188" fill="none" stroke="#4caf50" stroke-width="3"/>
                                    <circle class="end-point scfa-point" cx="260" cy="185" r="6" fill="#4caf50"/>
                                </svg>
                                
                                <!-- Convergence markers -->
                                <div class="convergence-marker fedavg-marker" style="left: 88%; top: 90%;">
                                    <div class="marker-line"></div>
                                    <div class="marker-label">41 rounds</div>
                                </div>
                                <div class="convergence-marker scfa-marker" style="left: 65%; top: 92%;">
                                    <div class="marker-line"></div>
                                    <div class="marker-label">32 rounds</div>
                                </div>
                            </div>
                            
                            <!-- X-axis -->
                            <div class="chart-xaxis">
                                <div class="axis-ticks">
                                    <span>0</span>
                                    <span>10</span>
                                    <span>20</span>
                                    <span>30</span>
                                    <span>40</span>
                                    <span>50</span>
                                </div>
                                <span class="axis-label">Communication Rounds</span>
                            </div>
                        </div>
                        
                        <!-- Legend -->
                        <div class="chart-legend">
                            <div class="legend-item fedavg-legend">
                                <span class="legend-line fedavg"></span>
                                <span class="legend-text">FedAvg: 41 rounds to converge</span>
                            </div>
                            <div class="legend-item scfa-legend">
                                <span class="legend-line scfa"></span>
                                <span class="legend-text">SCFA: 32 rounds to converge <span class="improvement">(22% faster)</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mechanism Explanation -->
                <div class="mechanism-explanation animate-in delay-3">
                    <div class="mech-header">
                        <span class="mech-icon">‚öôÔ∏è</span>
                        <span class="mech-title">How Constraints Accelerate Convergence</span>
                    </div>
                    
                    <div class="mechanism-flow">
                        <!-- Step 1 -->
                        <div class="mech-step" data-step="1">
                            <div class="mech-step-num">1</div>
                            <div class="mech-step-content">
                                <div class="mech-step-title">Hypothesis Space Reduction</div>
                                <div class="mech-step-visual">
                                    <div class="space-diagram">
                                        <div class="full-space">
                                            <span class="space-label">Full Parameter Space</span>
                                            <div class="constrained-space">
                                                <span class="space-label">Constrained Space</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mech-step-text">
                                    Constraints eliminate physically impossible parameter configurations
                                </div>
                            </div>
                        </div>

                        <!-- Arrow -->
                        <div class="mech-arrow">‚Üí</div>

                        <!-- Step 2 -->
                        <div class="mech-step" data-step="2">
                            <div class="mech-step-num">2</div>
                            <div class="mech-step-content">
                                <div class="mech-step-title">Reduced Gradient Variance</div>
                                <div class="mech-step-visual">
                                    <div class="variance-comparison">
                                        <div class="var-item high-var">
                                            <div class="var-arrows scattered">
                                                <span>‚Üó</span><span>‚Üô</span><span>‚Üñ</span><span>‚Üò</span><span>‚Üí</span>
                                            </div>
                                            <span class="var-label">FedAvg: High variance</span>
                                        </div>
                                        <div class="var-item low-var">
                                            <div class="var-arrows aligned">
                                                <span>‚Üò</span><span>‚Üò</span><span>‚Üò</span><span>‚Üò</span><span>‚Üò</span>
                                            </div>
                                            <span class="var-label">SCFA: Low variance</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="mech-step-text">
                                    Valid updates point in similar directions, reducing œÉ¬≤
                                </div>
                            </div>
                        </div>

                        <!-- Arrow -->
                        <div class="mech-arrow">‚Üí</div>

                        <!-- Step 3 -->
                        <div class="mech-step" data-step="3">
                            <div class="mech-step-num">3</div>
                            <div class="mech-step-content">
                                <div class="mech-step-title">Faster Convergence</div>
                                <div class="mech-step-visual">
                                    <div class="convergence-comparison">
                                        <div class="conv-metric">
                                            <span class="metric-val">22%</span>
                                            <span class="metric-label">Fewer rounds needed</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="mech-step-text">
                                    Lower variance ‚Üí larger stable learning rate ‚Üí faster descent
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Empirical Validation -->
                <div class="empirical-validation animate-in delay-3">
                    <div class="emp-header">
                        <span class="emp-icon">üî¨</span>
                        <span class="emp-title">Empirical Validation on Bosch Dataset</span>
                    </div>
                    
                    <div class="emp-content">
                        <div class="emp-table">
                            <div class="table-header">
                                <span class="th">Method</span>
                                <span class="th">Rounds to Converge</span>
                                <span class="th">Final Loss</span>
                                <span class="th">Improvement</span>
                            </div>
                            <div class="table-row baseline">
                                <span class="td method">FedAvg</span>
                                <span class="td">41 ¬± 3.2</span>
                                <span class="td">0.0234</span>
                                <span class="td baseline-ref">‚Äî</span>
                            </div>
                            <div class="table-row">
                                <span class="td method">FedProx</span>
                                <span class="td">38 ¬± 2.8</span>
                                <span class="td">0.0228</span>
                                <span class="td improvement">7.3%</span>
                            </div>
                            <div class="table-row">
                                <span class="td method">SCAFFOLD</span>
                                <span class="td">35 ¬± 2.5</span>
                                <span class="td">0.0221</span>
                                <span class="td improvement">14.6%</span>
                            </div>
                            <div class="table-row highlight-row">
                                <span class="td method">SCFA (Ours)</span>
                                <span class="td highlight-val">32 ¬± 2.1</span>
                                <span class="td highlight-val">0.0198</span>
                                <span class="td improvement best">22.0%</span>
                            </div>
                        </div>
                        
                        <div class="emp-footnote">
                            <span class="footnote-icon">üìã</span>
                            <span class="footnote-text">Results averaged over 5 runs with different random seeds. Convergence defined as loss < 0.025 for 3 consecutive rounds.</span>
                        </div>
                    </div>
                </div>

                <!-- Critical Threshold Callout -->
                <div class="threshold-callout animate-in delay-4">
                    <div class="callout-warning">
                        <span class="warning-icon">‚ö†Ô∏è</span>
                        <span class="warning-title">Critical Threshold Discovery</span>
                    </div>
                    <div class="callout-content">
                        <div class="threshold-visual">
                            <div class="threshold-bar">
                                <div class="bar-segment good" style="width: 18%;">
                                    <span class="seg-label">œÅ < 18%</span>
                                    <span class="seg-effect">‚úì Convergence accelerates</span>
                                </div>
                                <div class="threshold-marker">
                                    <span class="marker-val">œÅ = 18%</span>
                                </div>
                                <div class="bar-segment bad" style="width: 82%;">
                                    <span class="seg-label">œÅ > 18%</span>
                                    <span class="seg-effect">‚úó Performance degrades</span>
                                </div>
                            </div>
                        </div>
                        <div class="threshold-explanation">
                            <p><strong>Below threshold:</strong> Constraints guide optimization, reducing variance and accelerating convergence.</p>
                            <p><strong>Above threshold:</strong> Excessive projection causes oscillation; constraint signal overwhelms gradient signal.</p>
                            <p class="threshold-validation"><strong>Validation:</strong> R¬≤ = 0.93 across Bosch, NASA C-MAPSS, and UCI SECOM datasets.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 11: DATA HETEROGENEITY (Deep Dive 4) ==================== -->
        <section class="scene" data-scene="11" data-title="Data Heterogeneity">
            <div class="scene-content">
                <div class="chapter-badge technical-deepdive">üî¨ Addressing Technical Deep Dive #4</div>
                <h2 class="scene-title animate-in">Data Heterogeneity in Federated Learning</h2>
                <p class="scene-subtitle animate-in delay-1">Definition, manifestation in manufacturing, and impact on semantic constraints</p>

                <!-- Definition Section -->
                <div class="heterogeneity-definition animate-in delay-2">
                    <div class="def-header">
                        <span class="def-icon">üìö</span>
                        <span class="def-title">Formal Definition</span>
                    </div>
                    <div class="def-content">
                        <div class="def-main">
                            <span class="def-term">Data Heterogeneity (Non-IID)</span>
                            <span class="def-colon">:</span>
                            <span class="def-text">The statistical property where local data distributions P<sub>k</sub>(X, Y) at client k differ from the global distribution P(X, Y) and from each other.</span>
                        </div>
                        <div class="def-formula">
                            <div class="formula-box">
                                P<sub>k</sub>(X, Y) ‚â† P<sub>j</sub>(X, Y) for clients k ‚â† j
                            </div>
                            <div class="formula-decomposition">
                                <span class="decomp-label">Decomposition:</span>
                                <span class="decomp-formula">P(X, Y) = P(Y|X) ¬∑ P(X) = P(X|Y) ¬∑ P(Y)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Taxonomy of Heterogeneity -->
                <div class="heterogeneity-taxonomy animate-in delay-2">
                    <div class="tax-header">
                        <span class="tax-icon">üî¨</span>
                        <span class="tax-title">Taxonomy of Statistical Heterogeneity</span>
                    </div>
                    
                    <div class="tax-grid">
                        <!-- Type 1: Feature Distribution Skew -->
                        <div class="het-type fly-in-item" data-delay="0" data-type="feature">
                            <div class="type-header feature-skew">
                                <span class="type-num">Type 1</span>
                                <span class="type-name">Feature Distribution Skew</span>
                            </div>
                            <div class="type-body">
                                <div class="type-formula">
                                    P<sub>k</sub>(X) ‚â† P<sub>j</sub>(X), but P(Y|X) same
                                </div>
                                <div class="type-example">
                                    <div class="example-header">üè≠ Manufacturing Example:</div>
                                    <div class="example-visual feature-example">
                                        <div class="facility-data" data-facility="Germany">
                                            <span class="fac-flag">üá©üá™</span>
                                            <span class="fac-name">Germany Plant</span>
                                            <div class="sensor-readings">
                                                <div class="reading">Temp: 15-25¬∞C</div>
                                                <div class="reading">Humidity: 40-50%</div>
                                                <div class="reading highlight-diff">Voltage: 230V</div>
                                            </div>
                                        </div>
                                        <div class="vs-divider">‚â†</div>
                                        <div class="facility-data" data-facility="USA">
                                            <span class="fac-flag">üá∫üá∏</span>
                                            <span class="fac-name">USA Plant</span>
                                            <div class="sensor-readings">
                                                <div class="reading">Temp: 20-35¬∞C</div>
                                                <div class="reading">Humidity: 60-80%</div>
                                                <div class="reading highlight-diff">Voltage: 120V</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-badge">‚Üí</span>
                                        Same machine behavior, different environmental conditions
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Type 2: Label Distribution Skew -->
                        <div class="het-type fly-in-item" data-delay="200" data-type="label">
                            <div class="type-header label-skew">
                                <span class="type-num">Type 2</span>
                                <span class="type-name">Label Distribution Skew</span>
                            </div>
                            <div class="type-body">
                                <div class="type-formula">
                                    P<sub>k</sub>(Y) ‚â† P<sub>j</sub>(Y), marginal label imbalance
                                </div>
                                <div class="type-example">
                                    <div class="example-header">üè≠ Manufacturing Example:</div>
                                    <div class="example-visual label-example">
                                        <div class="label-dist" data-facility="new">
                                            <span class="dist-label">üÜï New Plant</span>
                                            <div class="dist-bar">
                                                <div class="bar-segment healthy" style="width: 95%;">
                                                    <span>Healthy 95%</span>
                                                </div>
                                                <div class="bar-segment failure" style="width: 5%;">
                                                    <span>5%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="label-dist" data-facility="old">
                                            <span class="dist-label">üèöÔ∏è Aging Plant</span>
                                            <div class="dist-bar">
                                                <div class="bar-segment healthy" style="width: 60%;">
                                                    <span>Healthy 60%</span>
                                                </div>
                                                <div class="bar-segment failure" style="width: 40%;">
                                                    <span>Failure 40%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-badge">‚Üí</span>
                                        Equipment age creates vastly different failure rates
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Type 3: Concept Drift -->
                        <div class="het-type fly-in-item" data-delay="400" data-type="concept">
                            <div class="type-header concept-drift">
                                <span class="type-num">Type 3</span>
                                <span class="type-name">Concept Drift (P(Y|X) varies)</span>
                            </div>
                            <div class="type-body">
                                <div class="type-formula">
                                    P<sub>k</sub>(Y|X) ‚â† P<sub>j</sub>(Y|X), same input ‚Üí different output
                                </div>
                                <div class="type-example">
                                    <div class="example-header">üè≠ Manufacturing Example:</div>
                                    <div class="example-visual concept-example">
                                        <div class="concept-scenario">
                                            <div class="scenario-input">
                                                <span class="input-label">Input:</span>
                                                <span class="input-val">Vibration = 2.5 mm/s</span>
                                            </div>
                                            <div class="scenario-outputs">
                                                <div class="output-item" data-facility="precision">
                                                    <span class="out-icon">üî¨</span>
                                                    <span class="out-label">Precision Plant</span>
                                                    <span class="out-result danger">üî¥ CRITICAL</span>
                                                    <span class="out-reason">Tolerance: ¬±0.01mm</span>
                                                </div>
                                                <div class="output-item" data-facility="heavy">
                                                    <span class="out-icon">üèóÔ∏è</span>
                                                    <span class="out-label">Heavy Industry</span>
                                                    <span class="out-result safe">üü¢ NORMAL</span>
                                                    <span class="out-reason">Tolerance: ¬±1.0mm</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-badge">‚Üí</span>
                                        Identical readings mean different things in different contexts!
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Type 4: Quantity Skew -->
                        <div class="het-type fly-in-item" data-delay="600" data-type="quantity">
                            <div class="type-header quantity-skew">
                                <span class="type-num">Type 4</span>
                                <span class="type-name">Quantity Skew</span>
                            </div>
                            <div class="type-body">
                                <div class="type-formula">
                                    |D<sub>k</sub>| ‚â´ |D<sub>j</sub>|, unequal data volumes
                                </div>
                                <div class="type-example">
                                    <div class="example-header">üè≠ Manufacturing Example:</div>
                                    <div class="example-visual quantity-example">
                                        <div class="quantity-bars">
                                            <div class="qty-bar" data-facility="large">
                                                <div class="qty-fill" style="height: 90%;">
                                                    <span class="qty-val">450K</span>
                                                </div>
                                                <span class="qty-label">üè≠ Large Plant</span>
                                            </div>
                                            <div class="qty-bar" data-facility="medium">
                                                <div class="qty-fill" style="height: 40%;">
                                                    <span class="qty-val">180K</span>
                                                </div>
                                                <span class="qty-label">üè≠ Medium</span>
                                            </div>
                                            <div class="qty-bar" data-facility="small1">
                                                <div class="qty-fill" style="height: 15%;">
                                                    <span class="qty-val">65K</span>
                                                </div>
                                                <span class="qty-label">üè≠ Small A</span>
                                            </div>
                                            <div class="qty-bar" data-facility="small2">
                                                <div class="qty-fill" style="height: 8%;">
                                                    <span class="qty-val">35K</span>
                                                </div>
                                                <span class="qty-label">üè≠ Small B</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="example-insight">
                                        <span class="insight-badge">‚Üí</span>
                                        Standard FedAvg: large plants dominate, small plants ignored!
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Heterogeneity Quantification -->
                <div class="heterogeneity-quantification animate-in delay-3">
                    <div class="quant-header">
                        <span class="quant-icon">üìä</span>
                        <span class="quant-title">Quantifying Heterogeneity: The Dirichlet Parameter Œ±</span>
                    </div>
                    <div class="quant-content">
                        <div class="dirichlet-explanation">
                            <div class="dirichlet-formula">
                                <div class="formula-label">Dirichlet Distribution:</div>
                                <div class="formula-main">p<sub>k</sub> ~ Dir(Œ±)</div>
                                <div class="formula-note">where p<sub>k</sub> = label proportions at client k</div>
                            </div>
                            <div class="dirichlet-spectrum">
                                <div class="spectrum-label">Heterogeneity Spectrum:</div>
                                <div class="spectrum-bar">
                                    <div class="spectrum-point extreme" style="left: 5%;">
                                        <span class="point-val">Œ±=0.1</span>
                                        <span class="point-label">Extreme<br>Non-IID</span>
                                    </div>
                                    <div class="spectrum-point high" style="left: 25%;">
                                        <span class="point-val">Œ±=0.5</span>
                                        <span class="point-label">High<br>Heterogeneity</span>
                                    </div>
                                    <div class="spectrum-point moderate" style="left: 50%;">
                                        <span class="point-val">Œ±=1.0</span>
                                        <span class="point-label">Moderate</span>
                                    </div>
                                    <div class="spectrum-point low" style="left: 75%;">
                                        <span class="point-val">Œ±=5.0</span>
                                        <span class="point-label">Low<br>Heterogeneity</span>
                                    </div>
                                    <div class="spectrum-point iid" style="left: 95%;">
                                        <span class="point-val">Œ±‚Üí‚àû</span>
                                        <span class="point-label">IID</span>
                                    </div>
                                    <div class="spectrum-gradient"></div>
                                </div>
                            </div>
                        </div>
                        <div class="our-experiments">
                            <div class="exp-badge">Our Experiments</div>
                            <div class="exp-range">
                                Œ± ‚àà {0.1, 0.5, 1.0, 5.0, 10.0}
                            </div>
                            <div class="exp-note">Testing across full heterogeneity spectrum</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 12: HETEROGENEITY IMPACT ON CONSTRAINTS ==================== -->
        <section class="scene" data-scene="12" data-title="Heterogeneity Impact">
            <div class="scene-content">
                <div class="chapter-badge technical-deepdive">üî¨ Heterogeneity √ó Constraints Interaction</div>
                <h2 class="scene-title animate-in">Impact of Data Heterogeneity on Semantic Constraints</h2>
                <p class="scene-subtitle animate-in delay-1">How non-IID data affects constraint satisfaction and how SCFA mitigates it</p>

                <!-- The Core Problem -->
                <div class="het-constraint-problem animate-in delay-2">
                    <div class="problem-header">
                        <span class="problem-icon">‚ö†Ô∏è</span>
                        <span class="problem-title">The Heterogeneity-Constraint Interaction Problem</span>
                    </div>
                    <div class="problem-visual">
                        <div class="interaction-diagram">
                            <!-- Left: Heterogeneous Data -->
                            <div class="diagram-section data-section">
                                <div class="section-label">Heterogeneous Local Data</div>
                                <div class="local-dists">
                                    <div class="local-dist" data-client="1">
                                        <div class="dist-curve skewed-left"></div>
                                        <span class="dist-label">P<sub>1</sub>(X)</span>
                                    </div>
                                    <div class="local-dist" data-client="2">
                                        <div class="dist-curve skewed-right"></div>
                                        <span class="dist-label">P<sub>2</sub>(X)</span>
                                    </div>
                                    <div class="local-dist" data-client="3">
                                        <div class="dist-curve bimodal"></div>
                                        <span class="dist-label">P<sub>3</sub>(X)</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Arrow -->
                            <div class="diagram-arrow">
                                <span class="arrow-text">Train locally</span>
                                <span class="arrow-symbol">‚Üí</span>
                            </div>

                            <!-- Middle: Divergent Models -->
                            <div class="diagram-section model-section">
                                <div class="section-label">Locally Optimal ‚â† Globally Valid</div>
                                <div class="model-predictions">
                                    <div class="pred-box valid-local invalid-global">
                                        <div class="pred-header">Model from Client 1</div>
                                        <div class="pred-content">
                                            <div class="pred-item">
                                                <span class="pred-label">Wear prediction:</span>
                                                <span class="pred-val">0.85 ‚Üí 0.72</span>
                                                <span class="pred-status violation">‚ö†Ô∏è Decreases!</span>
                                            </div>
                                            <div class="pred-reason">
                                                Local data: only new machines
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pred-box valid-local valid-global">
                                        <div class="pred-header">Model from Client 2</div>
                                        <div class="pred-content">
                                            <div class="pred-item">
                                                <span class="pred-label">Wear prediction:</span>
                                                <span class="pred-val">0.45 ‚Üí 0.67</span>
                                                <span class="pred-status valid">‚úì Increases</span>
                                            </div>
                                            <div class="pred-reason">
                                                Local data: full lifecycle
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Arrow -->
                            <div class="diagram-arrow">
                                <span class="arrow-text">Aggregate?</span>
                                <span class="arrow-symbol">‚Üí</span>
                            </div>

                            <!-- Right: Constraint Conflict -->
                            <div class="diagram-section constraint-section">
                                <div class="section-label">Constraint Satisfaction</div>
                                <div class="constraint-conflict">
                                    <div class="conflict-scenario">
                                        <div class="constraint-rule">
                                            <span class="rule-icon">‚è±Ô∏è</span>
                                            <span class="rule-text">‚àÇ(wear)/‚àÇt ‚â• 0</span>
                                        </div>
                                        <div class="conflict-result">
                                            <div class="result-item violates">
                                                <span>Client 1:</span>
                                                <span class="status">VIOLATES ‚úó</span>
                                            </div>
                                            <div class="result-item satisfies">
                                                <span>Client 2:</span>
                                                <span class="status">SATISFIES ‚úì</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Impact Analysis Grid -->
                <div class="impact-analysis animate-in delay-3">
                    <div class="analysis-header">
                        <span class="analysis-icon">üìà</span>
                        <span class="analysis-title">Quantified Impact: Constraint Violation Rate vs. Heterogeneity Level</span>
                    </div>
                    <div class="analysis-content">
                        <div class="impact-chart">
                            <div class="chart-container">
                                <!-- Y-axis -->
                                <div class="chart-y">
                                    <span class="axis-title">Violation Rate œÅ</span>
                                    <div class="y-ticks">
                                        <span>40%</span>
                                        <span>30%</span>
                                        <span>20%</span>
                                        <span>10%</span>
                                        <span>0%</span>
                                    </div>
                                </div>
                                <!-- Chart area -->
                                <div class="chart-plot">
                                    <div class="threshold-line" style="bottom: 45%;">
                                        <span class="threshold-label">œÅ = 18% threshold</span>
                                    </div>
                                    <!-- FedAvg curve (high violations) -->
                                    <svg class="impact-curve fedavg-curve" viewBox="0 0 400 200">
                                        <path d="M20,180 C60,175 100,160 150,120 S250,40 380,20" 
                                              fill="none" stroke="#f44336" stroke-width="3"/>
                                    </svg>
                                    <!-- SCFA curve (controlled violations) -->
                                    <svg class="impact-curve scfa-curve" viewBox="0 0 400 200">
                                        <path d="M20,185 C60,183 100,178 150,165 S250,140 380,120" 
                                              fill="none" stroke="#4caf50" stroke-width="3"/>
                                    </svg>
                                    <!-- Data points -->
                                    <div class="data-points">
                                        <div class="point fedavg" style="left: 5%; bottom: 10%;" data-val="Œ±=10">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point fedavg" style="left: 25%; bottom: 20%;" data-val="Œ±=5">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point fedavg" style="left: 50%; bottom: 40%;" data-val="Œ±=1">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point fedavg" style="left: 75%; bottom: 70%;" data-val="Œ±=0.5">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point fedavg" style="left: 95%; bottom: 90%;" data-val="Œ±=0.1">
                                            <span class="point-marker"></span>
                                        </div>
                                        <!-- SCFA points -->
                                        <div class="point scfa" style="left: 5%; bottom: 8%;">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point scfa" style="left: 25%; bottom: 12%;">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point scfa" style="left: 50%; bottom: 18%;">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point scfa" style="left: 75%; bottom: 28%;">
                                            <span class="point-marker"></span>
                                        </div>
                                        <div class="point scfa" style="left: 95%; bottom: 38%;">
                                            <span class="point-marker"></span>
                                        </div>
                                    </div>
                                </div>
                                <!-- X-axis -->
                                <div class="chart-x">
                                    <div class="x-ticks">
                                        <span>Œ±=10<br><small>IID-like</small></span>
                                        <span>Œ±=5</span>
                                        <span>Œ±=1</span>
                                        <span>Œ±=0.5</span>
                                        <span>Œ±=0.1<br><small>Extreme</small></span>
                                    </div>
                                    <span class="axis-title">Heterogeneity Level (‚Üê more heterogeneous)</span>
                                </div>
                            </div>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <span class="legend-color fedavg"></span>
                                    <span>FedAvg: Violations scale with heterogeneity (up to 38%)</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color scfa"></span>
                                    <span>SCFA: Violations bounded below threshold (max 15%)</span>
                                </div>
                            </div>
                        </div>

                        <!-- Impact Table -->
                        <div class="impact-table">
                            <div class="table-title">Empirical Results: Bosch Dataset</div>
                            <div class="het-table">
                                <div class="het-row header">
                                    <span class="het-cell">Œ±</span>
                                    <span class="het-cell">FedAvg œÅ</span>
                                    <span class="het-cell">SCFA œÅ</span>
                                    <span class="het-cell">Reduction</span>
                                </div>
                                <div class="het-row">
                                    <span class="het-cell">10.0</span>
                                    <span class="het-cell fedavg-val">4.2%</span>
                                    <span class="het-cell scfa-val">3.1%</span>
                                    <span class="het-cell reduction">26%</span>
                                </div>
                                <div class="het-row">
                                    <span class="het-cell">5.0</span>
                                    <span class="het-cell fedavg-val">8.7%</span>
                                    <span class="het-cell scfa-val">5.8%</span>
                                    <span class="het-cell reduction">33%</span>
                                </div>
                                <div class="het-row">
                                    <span class="het-cell">1.0</span>
                                    <span class="het-cell fedavg-val">16.3%</span>
                                    <span class="het-cell scfa-val">9.4%</span>
                                    <span class="het-cell reduction">42%</span>
                                </div>
                                <div class="het-row">
                                    <span class="het-cell">0.5</span>
                                    <span class="het-cell fedavg-val">27.8%</span>
                                    <span class="het-cell scfa-val">12.1%</span>
                                    <span class="het-cell reduction">56%</span>
                                </div>
                                <div class="het-row highlight">
                                    <span class="het-cell">0.1</span>
                                    <span class="het-cell fedavg-val danger">38.4%</span>
                                    <span class="het-cell scfa-val safe">14.7%</span>
                                    <span class="het-cell reduction best">62%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- How SCFA Mitigates -->
                <div class="scfa-mitigation animate-in delay-3">
                    <div class="mitigation-header">
                        <span class="mitigation-icon">üõ°Ô∏è</span>
                        <span class="mitigation-title">How SCFA Mitigates Heterogeneity Impact on Constraints</span>
                    </div>
                    <div class="mitigation-mechanisms">
                        <div class="mechanism-card" data-mechanism="1">
                            <div class="mech-num">1</div>
                            <div class="mech-content">
                                <div class="mech-title">Semantic Alignment Layer</div>
                                <div class="mech-visual">
                                    <div class="alignment-demo">
                                        <div class="before-align">
                                            <span class="label">Before:</span>
                                            <div class="features scattered">
                                                <span class="feat" style="left: 10%; top: 20%;">dim_4</span>
                                                <span class="feat" style="left: 80%; top: 70%;">dim_11</span>
                                                <span class="feat" style="left: 40%; top: 50%;">dim_7</span>
                                            </div>
                                        </div>
                                        <div class="align-arrow">‚Üí</div>
                                        <div class="after-align">
                                            <span class="label">After:</span>
                                            <div class="features aligned">
                                                <span class="feat" style="left: 50%; top: 30%;">wear</span>
                                                <span class="feat" style="left: 50%; top: 50%;">temp</span>
                                                <span class="feat" style="left: 50%; top: 70%;">vibr</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mech-desc">
                                    Maps heterogeneous feature representations to unified semantic space before constraint checking
                                </div>
                            </div>
                        </div>

                        <div class="mechanism-card" data-mechanism="2">
                            <div class="mech-num">2</div>
                            <div class="mech-content">
                                <div class="mech-title">Validity-Weighted Aggregation</div>
                                <div class="mech-visual">
                                    <div class="weighting-demo">
                                        <div class="weight-item high-validity">
                                            <span class="weight-label">High s<sub>k</sub></span>
                                            <div class="weight-bar" style="width: 90%;"></div>
                                            <span class="weight-effect">High Œ±<sub>k</sub></span>
                                        </div>
                                        <div class="weight-item low-validity">
                                            <span class="weight-label">Low s<sub>k</sub></span>
                                            <div class="weight-bar" style="width: 30%;"></div>
                                            <span class="weight-effect">Low Œ±<sub>k</sub></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="mech-desc">
                                    Clients with heterogeneity-induced violations contribute less to global model
                                </div>
                            </div>
                        </div>

                        <div class="mechanism-card" data-mechanism="3">
                            <div class="mech-num">3</div>
                            <div class="mech-content">
                                <div class="mech-title">Domain-Invariant Constraints</div>
                                <div class="mech-visual">
                                    <div class="invariant-demo">
                                        <div class="constraint-universal">
                                            <span class="const-text">‚àÇ(wear)/‚àÇt ‚â• 0</span>
                                        </div>
                                        <div class="applies-to">
                                            <span class="apply-arrow">‚Üì</span>
                                            <div class="apply-targets">
                                                <span class="target">üá©üá™ Germany</span>
                                                <span class="target">üá∫üá∏ USA</span>
                                                <span class="target">üá®üá≥ China</span>
                                                <span class="target">üáØüáµ Japan</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mech-desc">
                                    Physical laws hold regardless of local data distribution ‚Äî universal validation criteria
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Theorem -->
                <div class="het-theorem animate-in delay-4">
                    <div class="theorem-badge">Proposition 2 (Heterogeneity Robustness)</div>
                    <div class="theorem-content">
                        <div class="theorem-statement">
                            Under SCFA with semantic constraints C and Dirichlet heterogeneity parameter Œ±, the constraint violation rate satisfies:
                        </div>
                        <div class="theorem-formula">
                            œÅ<sub>SCFA</sub> ‚â§ œÅ<sub>FedAvg</sub> ¬∑ (1 - Œ∏¬∑log(1 + 1/Œ±))
                        </div>
                        <div class="theorem-interpretation">
                            <div class="interp-item">
                                <span class="interp-icon">üìâ</span>
                                <span class="interp-text"><strong>As Œ± ‚Üí 0</strong> (extreme heterogeneity), SCFA's advantage grows logarithmically</span>
                            </div>
                            <div class="interp-item">
                                <span class="interp-icon">üéØ</span>
                                <span class="interp-text"><strong>Œ∏ = 0.37</strong> in our experiments ‚Äî 63% violation reduction at Œ± = 0.1</span>
                            </div>
                            <div class="interp-item">
                                <span class="interp-icon">‚úì</span>
                                <span class="interp-text"><strong>Validated:</strong> R¬≤ = 0.91 across Bosch, NASA C-MAPSS, UCI SECOM</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 13: SCFA ALGORITHM ==================== -->
        <section class="scene" data-scene="13" data-title="SCFA Algorithm">
            <div class="scene-content">
                <div class="chapter-badge purple">Our Solution</div>
                <h2 class="scene-title animate-in">Introducing SCFA</h2>
                <p class="scene-subtitle animate-in delay-1">Semantic-Constrained Federated Aggregation</p>

                <div class="algorithm-visual animate-in delay-2">
                    <div class="algo-steps">
                        <!-- Step 1 -->
                        <div class="algo-step" data-step="1" data-delay="0">
                            <div class="step-number blue">1</div>
                            <div class="step-content">
                                <h4>Local Training</h4>
                                <p>Each facility trains for E epochs, computing gradient Œîw</p>
                                <div class="step-visual-inline">üè≠‚Üíüè≠‚Üíüè≠‚Üíüè≠‚Üíüè≠ (independently)</div>
                            </div>
                        </div>

                        <!-- Step 2 - Highlighted -->
                        <div class="algo-step highlight-step" data-step="2" data-delay="300">
                            <div class="step-number green">2</div>
                            <div class="step-content">
                                <h4>Constraint Validation <span class="new-badge">KEY INNOVATION</span></h4>
                                <p>Server checks each update against <strong>4 constraint categories</strong>:</p>
                                <div class="constraint-grid">
                                    <div class="constraint-box temporal">‚è±Ô∏è Temporal<br><small>wear ‚Üë only</small></div>
                                    <div class="constraint-box causal">üîó Causal<br><small>failure order</small></div>
                                    <div class="constraint-box capacity">üìä Capacity<br><small>equipment limits</small></div>
                                    <div class="constraint-box physical">‚öõÔ∏è Physical<br><small>conservation</small></div>
                                </div>
                                <div class="step-output">Output: validity score <span class="math">s<sub>k</sub> ‚àà [0,1]</span></div>
                            </div>
                        </div>

                        <!-- Step 3 - Highlighted -->
                        <div class="algo-step highlight-step" data-step="3" data-delay="600">
                            <div class="step-number purple">3</div>
                            <div class="step-content">
                                <h4>Weighted Aggregation</h4>
                                <div class="equation-breakdown" id="eq-aggregation">
                                    <div class="equation-full">
                                        <span class="eq-part" data-part="alpha">Œ±<sub>k</sub></span>
                                        <span class="eq-part" data-part="equals">=</span>
                                        <span class="eq-part" data-part="numerator">(n<sub>k</sub> ¬∑ s<sub>k</sub>)</span>
                                        <span class="eq-part" data-part="divide">/</span>
                                        <span class="eq-part" data-part="denominator">Œ£(n<sub>j</sub> ¬∑ s<sub>j</sub>)</span>
                                    </div>
                                    <div class="equation-explains">
                                        <div class="eq-explain" data-for="alpha">Œ±<sub>k</sub> = final weight for facility k</div>
                                        <div class="eq-explain" data-for="numerator">n<sub>k</sub> = data size, s<sub>k</sub> = validity score</div>
                                        <div class="eq-explain" data-for="denominator">Normalize across all facilities</div>
                                    </div>
                                </div>
                                <div class="key-insight">‚ö†Ô∏è Constraint violators get <strong>down-weighted!</strong></div>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div class="algo-step" data-step="4" data-delay="900">
                            <div class="step-number orange">4</div>
                            <div class="step-content">
                                <h4>Global Update</h4>
                                <div class="equation-box">
                                    <span class="math">w<sup>(t+1)</sup> = w<sup>(t)</sup> + Œ£ Œ±<sub>k</sub> ¬∑ Œîw<sub>k</sub></span>
                                </div>
                                <div class="result-note success">‚úì Model converges faster on the <strong>valid subspace</strong></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 7: THREE RESEARCH QUESTIONS ==================== -->
        <section class="scene" data-scene="14" data-title="Research Questions">
            <div class="scene-content">
                <div class="chapter-badge">Our Investigation</div>
                <h2 class="scene-title animate-in">Three Research Questions</h2>
                
                <div class="rq-cards animate-in delay-1">
                    <div class="rq-card rq1" data-delay="0" onclick="goToScene(8)">
                        <div class="rq-number">RQ1</div>
                        <div class="rq-title">Convergence Theory</div>
                        <div class="rq-question">Can semantic constraints accelerate convergence under non-IID data?</div>
                        <div class="rq-answer">
                            <span class="answer-label">Answer:</span>
                            <span class="answer-value stat-highlight" data-stat="rq1-answer">Yes! 22% faster</span>
                        </div>
                        <div class="rq-cta">Click to explore ‚Üí</div>
                    </div>
                    
                    <div class="rq-card rq2" data-delay="200" onclick="goToScene(11)">
                        <div class="rq-number">RQ2</div>
                        <div class="rq-title">Privacy-Utility Bounds</div>
                        <div class="rq-question">What are the privacy-utility tradeoffs of constraint-based aggregation?</div>
                        <div class="rq-answer">
                            <span class="answer-label">Answer:</span>
                            <span class="answer-value stat-highlight" data-stat="rq2-answer">2.7√ó improvement</span>
                        </div>
                        <div class="rq-cta">Click to explore ‚Üí</div>
                    </div>
                    
                    <div class="rq-card rq3" data-delay="400" onclick="goToScene(14)">
                        <div class="rq-number">RQ3</div>
                        <div class="rq-title">Violation Impact</div>
                        <div class="rq-question">How does constraint violation rate correlate with model performance?</div>
                        <div class="rq-answer">
                            <span class="answer-label">Answer:</span>
                            <span class="answer-value stat-highlight" data-stat="rq3-answer">Critical at 18%</span>
                        </div>
                        <div class="rq-cta">Click to explore ‚Üí</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 8: RQ1 ARCHITECTURE ==================== -->
        <section class="scene" data-scene="15" data-title="RQ1: Architecture">
            <div class="scene-content">
                <div class="rq-badge rq1">Research Question 1</div>
                <h2 class="scene-title animate-in">Convergence Theory</h2>
                <p class="scene-subtitle animate-in delay-1">Can semantic constraints accelerate convergence under non-IID data?</p>
                
                <div class="answer-reveal animate-in delay-2">
                    <div class="answer-box success">
                        <div class="answer-icon">‚úì</div>
                        <div class="answer-content">
                            <div class="answer-main"><span class="stat-highlight zoom-stat" data-stat="rq1-result">22% Faster Convergence</span></div>
                            <div class="answer-detail">Theory matching experiments at <span class="stat-highlight" data-stat="rq1-rsq">R¬≤ = 0.94</span></div>
                        </div>
                    </div>
                </div>

                <div class="architecture-diagram animate-in delay-3">
                    <h3>RQ1 Architecture: How Constraints Accelerate Convergence</h3>
                    <img src="images/rq1_architecture.png" alt="RQ1 Architecture" class="arch-image">
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 9: RQ1 THEOREM (ANIMATED) ==================== -->
        <section class="scene" data-scene="16" data-title="RQ1: Theorem 1">
            <div class="scene-content">
                <div class="rq-badge rq1">RQ1 Deep Dive</div>
                <h2 class="scene-title animate-in">Theorem 1: The Convergence Rate</h2>
                
                <div class="theorem-container animate-in delay-1">
                    <div class="theorem-header-box">
                        <span class="theorem-badge">THEOREM 1</span>
                        <span class="theorem-name">SCFA Convergence Bound</span>
                    </div>

                    <!-- Animated Equation Breakdown -->
                    <div class="animated-equation" id="theorem1-eq">
                        <div class="equation-display">
                            <div class="eq-component" data-component="result" data-order="1">
                                <div class="component-value">Convergence Rate</div>
                                <div class="component-label">What we measure</div>
                            </div>
                            <div class="eq-operator" data-order="2">=</div>
                            <div class="eq-component standard-term" data-component="standard" data-order="3">
                                <div class="component-value">1/‚àöT</div>
                                <div class="component-label">Standard FL Term</div>
                                <div class="component-detail">More rounds ‚Üí better</div>
                            </div>
                            <div class="eq-operator" data-order="4">+</div>
                            <div class="eq-component penalty-term" data-component="penalty" data-order="5">
                                <div class="component-value">œÅ ¬∑ L<sub>c</sub> ¬∑ D</div>
                                <div class="component-label">Violation Penalty</div>
                                <div class="component-detail">Cost of breaking rules</div>
                            </div>
                        </div>
                    </div>

                    <!-- Parameter Cards -->
                    <div class="param-cards">
                        <div class="param-card" data-param="T">
                            <div class="param-symbol">T</div>
                            <div class="param-name">Communication Rounds</div>
                            <div class="param-insight">More rounds ‚Üí 1/‚àöT decreases ‚Üí better convergence</div>
                        </div>
                        <div class="param-card highlight" data-param="rho">
                            <div class="param-symbol">œÅ</div>
                            <div class="param-name">Violation Rate</div>
                            <div class="param-insight">Target: <span class="stat-highlight" data-stat="rho-target">&lt; 5%</span></div>
                        </div>
                        <div class="param-card" data-param="Lc">
                            <div class="param-symbol">L<sub>c</sub></div>
                            <div class="param-name">Constraint Smoothness</div>
                            <div class="param-insight">Measured: <span class="stat-highlight" data-stat="lc-value">1.42</span></div>
                        </div>
                        <div class="param-card" data-param="D">
                            <div class="param-symbol">D</div>
                            <div class="param-name">Data Heterogeneity</div>
                            <div class="param-insight">Measured: <span class="stat-highlight" data-stat="d-value">1.87</span></div>
                        </div>
                    </div>
                </div>

                <div class="key-insight-box animate-in delay-3">
                    <div class="insight-icon">üí°</div>
                    <div class="insight-text">
                        <strong>Key Insight:</strong> Keep violations low (œÅ ‚Üí 0), and you get FedAvg-level convergence on a <span class="highlight-purple">much smaller, cleaner hypothesis space</span> ‚Äî where all physically-impossible solutions have been eliminated!
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 10: RQ1 RESULTS ==================== -->
        <section class="scene" data-scene="17" data-title="RQ1: Results">
            <div class="scene-content">
                <div class="rq-badge rq1">RQ1 Results</div>
                <h2 class="scene-title animate-in">Convergence Validation</h2>
                
                <div class="results-table-container animate-in delay-1">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Heterogeneity</th>
                                <th>Dirichlet Œ±</th>
                                <th>SCFA Rounds</th>
                                <th>FedAvg Rounds</th>
                                <th>Speedup</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="animate-row" data-delay="0">
                                <td>Mild</td>
                                <td><span class="stat-highlight" data-stat="alpha-mild">10.0</span></td>
                                <td class="scfa stat-highlight" data-stat="scfa-mild">27</td>
                                <td class="fedavg">34</td>
                                <td class="speedup stat-highlight" data-stat="speedup-mild">20.6%</td>
                            </tr>
                            <tr class="animate-row highlight-row" data-delay="200">
                                <td><strong>Moderate</strong></td>
                                <td><span class="stat-highlight" data-stat="alpha-mod">1.0</span></td>
                                <td class="scfa stat-highlight zoom-stat" data-stat="scfa-mod"><strong>32</strong></td>
                                <td class="fedavg"><strong>41</strong></td>
                                <td class="speedup stat-highlight zoom-stat" data-stat="speedup-mod"><strong>22.0%</strong></td>
                            </tr>
                            <tr class="animate-row" data-delay="400">
                                <td>Severe</td>
                                <td><span class="stat-highlight" data-stat="alpha-sev">0.1</span></td>
                                <td class="scfa stat-highlight" data-stat="scfa-sev">38</td>
                                <td class="fedavg">52</td>
                                <td class="speedup best stat-highlight" data-stat="speedup-sev">26.9%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="insight-callout animate-in delay-2">
                    <div class="callout-icon">üìà</div>
                    <div class="callout-text">
                        <h4>The more heterogeneous your data, the more constraints help!</h4>
                        <p>Under severe non-IID conditions, we see <span class="stat-highlight zoom-stat" data-stat="severe-speedup">26.9% speedup</span> because constraints eliminate problematic solution regions.</p>
                    </div>
                </div>

                <div class="metrics-summary animate-in delay-3">
                    <div class="metric-box">
                        <div class="metric-value stat-highlight zoom-stat" data-stat="rq1-rsq-final">R¬≤ = 0.94</div>
                        <div class="metric-label">Theory-Practice Fit</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value stat-highlight" data-stat="gamma">Œ≥ = 0.41</div>
                        <div class="metric-label">Heterogeneity Reduction</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value stat-highlight" data-stat="divergence">41.3%</div>
                        <div class="metric-label">Divergence Reduction</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 11: RQ2 ARCHITECTURE ==================== -->
        <section class="scene" data-scene="18" data-title="RQ2: Privacy">
            <div class="scene-content">
                <div class="rq-badge rq2">Research Question 2</div>
                <h2 class="scene-title animate-in">Privacy-Utility Bounds</h2>
                <p class="scene-subtitle animate-in delay-1">What are the privacy-utility tradeoffs of constraint-based aggregation?</p>
                
                <div class="answer-reveal animate-in delay-2">
                    <div class="answer-box success green">
                        <div class="answer-icon">‚úì</div>
                        <div class="answer-content">
                            <div class="answer-main"><span class="stat-highlight zoom-stat" data-stat="rq2-result">2.7√ó Better Privacy-Utility Tradeoff</span></div>
                            <div class="answer-detail">Only <span class="stat-highlight" data-stat="scfa-loss">3.7%</span> utility loss under GDPR-compatible privacy vs <span class="stat-highlight" data-stat="fedavg-loss">12.1%</span></div>
                        </div>
                    </div>
                </div>

                <div class="architecture-diagram animate-in delay-3">
                    <h3>RQ2 Architecture: How Constraints Improve Privacy</h3>
                    <img src="images/rq2_architecture.png" alt="RQ2 Architecture" class="arch-image">
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 12: RQ2 THEOREM (ANIMATED) ==================== -->
        <section class="scene" data-scene="19" data-title="RQ2: Theorem 2">
            <div class="scene-content">
                <div class="rq-badge rq2">RQ2 Deep Dive</div>
                <h2 class="scene-title animate-in">Theorem 2: Privacy-Utility Bound</h2>

                <!-- Hypothesis Space Visualization -->
                <div class="space-visualization animate-in delay-1">
                    <div class="space-compare">
                        <div class="space-box full-space">
                            <div class="space-circle large">
                                <span class="space-value stat-highlight zoom-stat" data-stat="full-params">8.7M</span>
                                <span class="space-unit">parameters</span>
                            </div>
                            <div class="space-label">Full Hypothesis Space</div>
                            <div class="space-desc">All possible solutions</div>
                        </div>
                        
                        <div class="space-arrow-container">
                            <div class="reduction-arrow">
                                <div class="arrow-body"></div>
                                <div class="arrow-label">Constraints reduce by <span class="stat-highlight" data-stat="reduction-pct">63%</span></div>
                            </div>
                        </div>
                        
                        <div class="space-box constrained-space">
                            <div class="space-circle small">
                                <span class="space-value stat-highlight zoom-stat" data-stat="constrained-params">3.2M</span>
                                <span class="space-unit">effective</span>
                            </div>
                            <div class="space-label">Constrained Space</div>
                            <div class="space-desc">Only valid solutions</div>
                        </div>
                    </div>
                </div>

                <!-- Theorem Equation -->
                <div class="theorem-container green animate-in delay-2">
                    <div class="theorem-header-box green">
                        <span class="theorem-badge green">THEOREM 2</span>
                        <span class="theorem-name">Privacy-Utility Bound</span>
                    </div>

                    <div class="animated-equation" id="theorem2-eq">
                        <div class="equation-display horizontal">
                            <div class="eq-component" data-component="utility" data-order="1">
                                <div class="component-value">Utility Loss</div>
                            </div>
                            <div class="eq-operator" data-order="2">‚àù</div>
                            <div class="eq-component" data-component="noise" data-order="3">
                                <div class="component-value">œÉ¬≤ ¬∑ d</div>
                                <div class="component-label">Noise √ó Dimensions</div>
                            </div>
                            <div class="eq-operator" data-order="4">/</div>
                            <div class="eq-component highlight-component" data-component="space" data-order="5">
                                <div class="component-value">H</div>
                                <div class="component-label">Hypothesis Space Size</div>
                            </div>
                        </div>
                        <div class="equation-result">
                            <span class="stat-highlight zoom-stat" data-stat="theta-value">Œ∏ = 0.37</span> ‚Üí <span class="stat-highlight" data-stat="reduction-result">63% space reduction</span> ‚Üí Same noise has <strong>less impact!</strong>
                        </div>
                    </div>
                </div>

                <div class="analogy-box animate-in delay-3">
                    <div class="analogy-icon">üèüÔ∏è</div>
                    <div class="analogy-content">
                        <h4>The Warehouse Analogy</h4>
                        <p>Finding a signal in a <strong>massive warehouse</strong> full of noise is hard. But if you know the signal is in <strong>one corner</strong>, the same noise matters much less. Constraints tell us which corner contains all valid solutions!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 20: HYPOTHESIS SPACE REDUCTION DEEP DIVE ==================== -->
        <section class="scene" data-scene="20" data-title="Hypothesis Space Reduction">
            <div class="scene-content hypothesis-space-scene">
                <div class="chapter-badge technical-deepdive">üî¨ Technical Deep Dive</div>
                <h2 class="scene-title animate-in">Hypothesis Space Reduction</h2>
                <p class="scene-subtitle animate-in delay-1">The Key Mechanism Behind Privacy-Utility Improvement</p>

                <!-- Section 1: How Hypothesis Space is Reduced -->
                <div class="hsr-section animate-in delay-2" id="hsr-how">
                    <div class="section-header">
                        <span class="section-number">1</span>
                        <h3>How is the Hypothesis Space Reduced?</h3>
                        <button id="hsrSimBtn" class="fullscreen-btn" title="Open Interactive Simulator" style="margin-left:auto;background:linear-gradient(135deg,#667eea,#764ba2);border:none;color:white;padding:8px 16px;border-radius:20px;font-size:0.8rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:6px;">
                            <span>üî¨</span> Interactive Simulator
                        </button>
                    </div>
                    
                    <!-- Clean Main Visualization with inline styles -->
                    <div style="display:flex;gap:25px;margin-bottom:20px;flex-wrap:wrap;">
                        <!-- Left: Diagram -->
                        <div style="flex:1;min-width:400px;background:rgba(0,0,0,0.4);border-radius:15px;padding:20px;border:1px solid rgba(255,255,255,0.1);">
                            <div style="text-align:center;font-size:0.9rem;font-weight:600;color:#e0e0e0;margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,0.1);">Hypothesis Space Transformation</div>
                            
                            <div style="display:flex;align-items:center;justify-content:center;gap:20px;flex-wrap:wrap;">
                                <!-- Before State -->
                                <div style="text-align:center;">
                                    <div style="font-size:0.7rem;color:#9e9e9e;text-transform:uppercase;margin-bottom:8px;">Before Constraints</div>
                                    <div style="width:120px;height:120px;border-radius:50%;background:radial-gradient(circle,rgba(244,67,54,0.1) 0%,rgba(244,67,54,0.3) 100%);border:3px dashed rgba(244,67,54,0.6);display:flex;flex-direction:column;align-items:center;justify-content:center;margin:0 auto;">
                                        <div style="font-size:0.65rem;color:#9e9e9e;">H<sub>full</sub></div>
                                        <div style="font-size:1.8rem;font-weight:700;color:#f44336;">8.7M</div>
                                        <div style="font-size:0.65rem;color:#9e9e9e;">parameters</div>
                                    </div>
                                    <div style="font-size:0.65rem;color:#9e9e9e;margin-top:8px;line-height:1.4;">All possible configs<br>(includes invalid)</div>
                                </div>
                                
                                <!-- Arrow Section -->
                                <div style="text-align:center;">
                                    <div style="display:flex;flex-direction:column;gap:3px;margin-bottom:8px;">
                                        <span style="font-size:0.6rem;padding:2px 6px;border-radius:8px;background:rgba(255,152,0,0.2);color:#ff9800;">üìê -28%</span>
                                        <span style="font-size:0.6rem;padding:2px 6px;border-radius:8px;background:rgba(33,150,243,0.2);color:#2196f3;">üîó -18%</span>
                                        <span style="font-size:0.6rem;padding:2px 6px;border-radius:8px;background:rgba(156,39,176,0.2);color:#9c27b0;">üìä -12%</span>
                                        <span style="font-size:0.6rem;padding:2px 6px;border-radius:8px;background:rgba(244,67,54,0.2);color:#f44336;">‚ö° -5%</span>
                                    </div>
                                    <div style="font-size:2rem;color:#4caf50;">‚Üí</div>
                                    <div style="background:linear-gradient(135deg,#4caf50,#8bc34a);color:white;padding:4px 10px;border-radius:12px;font-size:0.7rem;font-weight:600;">63% Reduction</div>
                                </div>
                                
                                <!-- After State -->
                                <div style="text-align:center;">
                                    <div style="font-size:0.7rem;color:#9e9e9e;text-transform:uppercase;margin-bottom:8px;">After Constraints</div>
                                    <div style="width:120px;height:120px;border-radius:50%;background:radial-gradient(circle,rgba(76,175,80,0.15) 0%,rgba(76,175,80,0.4) 100%);border:3px solid rgba(76,175,80,0.7);display:flex;flex-direction:column;align-items:center;justify-content:center;margin:0 auto;box-shadow:0 0 20px rgba(76,175,80,0.3);">
                                        <div style="font-size:0.65rem;color:#9e9e9e;">H<sub>constrained</sub></div>
                                        <div style="font-size:1.8rem;font-weight:700;color:#4caf50;">3.2M</div>
                                        <div style="font-size:0.65rem;color:#9e9e9e;">effective</div>
                                    </div>
                                    <div style="font-size:0.65rem;color:#9e9e9e;margin-top:8px;line-height:1.4;">Only valid configs<br>(physically possible)</div>
                                </div>
                            </div>
                            
                            <!-- Impact Summary -->
                            <div style="display:flex;justify-content:center;gap:12px;margin-top:15px;padding-top:15px;border-top:1px solid rgba(255,255,255,0.1);flex-wrap:wrap;">
                                <span style="font-size:0.7rem;color:#9e9e9e;padding:4px 10px;background:rgba(255,255,255,0.03);border-radius:15px;">üìâ 5.5M eliminated</span>
                                <span style="font-size:0.7rem;color:#4caf50;padding:4px 10px;background:rgba(76,175,80,0.15);border-radius:15px;font-weight:600;">üîí 2.7√ó privacy gain</span>
                                <span style="font-size:0.7rem;color:#9e9e9e;padding:4px 10px;background:rgba(255,255,255,0.03);border-radius:15px;">‚ö° Same Œµ, less loss</span>
                            </div>
                        </div>
                        
                        <!-- Right: Constraint Breakdown -->
                        <div style="flex:0.8;min-width:300px;background:rgba(0,0,0,0.4);border-radius:15px;padding:15px;border:1px solid rgba(255,255,255,0.1);">
                            <div style="font-size:0.85rem;font-weight:600;color:#e0e0e0;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.1);">Constraint Categories</div>
                            
                            <!-- Temporal -->
                            <div style="margin-bottom:10px;padding:10px;background:rgba(255,255,255,0.03);border-radius:8px;border-left:3px solid #ff9800;">
                                <div style="display:flex;align-items:center;gap:8px;margin-bottom:5px;">
                                    <span>üìê</span>
                                    <span style="flex:1;font-size:0.8rem;font-weight:600;color:#e0e0e0;">Temporal</span>
                                    <span style="font-size:0.85rem;font-weight:700;color:#f44336;">-28%</span>
                                </div>
                                <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-bottom:5px;">
                                    <div style="width:28%;height:100%;background:#ff9800;border-radius:2px;"></div>
                                </div>
                                <div style="display:flex;justify-content:space-between;font-size:0.65rem;">
                                    <span style="color:#ce93d8;font-family:'Kalam',cursive;">‚àÇW/‚àÇt ‚â• 0</span>
                                    <span style="color:#9e9e9e;">Wear increases only</span>
                                </div>
                            </div>
                            
                            <!-- Causal -->
                            <div style="margin-bottom:10px;padding:10px;background:rgba(255,255,255,0.03);border-radius:8px;border-left:3px solid #2196f3;">
                                <div style="display:flex;align-items:center;gap:8px;margin-bottom:5px;">
                                    <span>üîó</span>
                                    <span style="flex:1;font-size:0.8rem;font-weight:600;color:#e0e0e0;">Causal</span>
                                    <span style="font-size:0.85rem;font-weight:700;color:#f44336;">-18%</span>
                                </div>
                                <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-bottom:5px;">
                                    <div style="width:18%;height:100%;background:#2196f3;border-radius:2px;"></div>
                                </div>
                                <div style="display:flex;justify-content:space-between;font-size:0.65rem;">
                                    <span style="color:#ce93d8;font-family:'Kalam',cursive;">t<sub>cause</sub> &lt; t<sub>effect</sub></span>
                                    <span style="color:#9e9e9e;">No reverse causality</span>
                                </div>
                            </div>
                            
                            <!-- Capacity -->
                            <div style="margin-bottom:10px;padding:10px;background:rgba(255,255,255,0.03);border-radius:8px;border-left:3px solid #9c27b0;">
                                <div style="display:flex;align-items:center;gap:8px;margin-bottom:5px;">
                                    <span>üìä</span>
                                    <span style="flex:1;font-size:0.8rem;font-weight:600;color:#e0e0e0;">Capacity</span>
                                    <span style="font-size:0.85rem;font-weight:700;color:#f44336;">-12%</span>
                                </div>
                                <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-bottom:5px;">
                                    <div style="width:12%;height:100%;background:#9c27b0;border-radius:2px;"></div>
                                </div>
                                <div style="display:flex;justify-content:space-between;font-size:0.65rem;">
                                    <span style="color:#ce93d8;font-family:'Kalam',cursive;">T ‚àà [20¬∞C, 200¬∞C]</span>
                                    <span style="color:#9e9e9e;">Physical bounds</span>
                                </div>
                            </div>
                            
                            <!-- Physical -->
                            <div style="margin-bottom:10px;padding:10px;background:rgba(255,255,255,0.03);border-radius:8px;border-left:3px solid #f44336;">
                                <div style="display:flex;align-items:center;gap:8px;margin-bottom:5px;">
                                    <span>‚ö°</span>
                                    <span style="flex:1;font-size:0.8rem;font-weight:600;color:#e0e0e0;">Physical Laws</span>
                                    <span style="font-size:0.85rem;font-weight:700;color:#f44336;">-5%</span>
                                </div>
                                <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-bottom:5px;">
                                    <div style="width:5%;height:100%;background:#f44336;border-radius:2px;"></div>
                                </div>
                                <div style="display:flex;justify-content:space-between;font-size:0.65rem;">
                                    <span style="color:#ce93d8;font-family:'Kalam',cursive;">‚àëE<sub>in</sub> = ‚àëE<sub>out</sub></span>
                                    <span style="color:#9e9e9e;">Conservation</span>
                                </div>
                            </div>
                            
                            <!-- Total -->
                            <div style="margin-top:12px;padding:12px;background:rgba(76,175,80,0.1);border:1px solid rgba(76,175,80,0.3);border-radius:10px;">
                                <div style="font-size:0.7rem;color:#9e9e9e;margin-bottom:5px;">Total Reduction</div>
                                <div style="height:6px;background:rgba(255,255,255,0.1);border-radius:3px;margin-bottom:8px;">
                                    <div style="width:63%;height:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);border-radius:3px;"></div>
                                </div>
                                <div style="display:flex;align-items:center;justify-content:center;gap:10px;">
                                    <span style="font-size:1.2rem;font-weight:700;color:#4caf50;">63%</span>
                                    <span style="color:#9e9e9e;">‚Üí</span>
                                    <span style="font-size:0.85rem;font-weight:600;color:#ffc107;">2.7√ó Privacy Gain</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Math Definition -->
                    <div class="math-definition-box">
                        <div class="math-header">üìê Mathematical Definition</div>
                        <div class="math-formula">
                            H<sub>constrained</sub> = { w ‚àà H<sub>full</sub> | ‚àÄc ‚àà C: c(f(X; w)) = true }
                        </div>
                        <div class="math-vars">
                            <span><strong>H<sub>full</sub></strong> = All possible parameter configurations (8.7M)</span>
                            <span><strong>C</strong> = Set of semantic constraints (3,000 rules from 4 ontologies)</span>
                            <span><strong>H<sub>constrained</sub></strong> = Only physically valid configurations (3.2M)</span>
                        </div>
                    </div>
                </div>
                
                <!-- Enhanced Full Screen Simulator Modal -->
                <div class="hsr-modal" id="hsrModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.95);z-index:10000;overflow:auto;">
                    <div style="width:95%;max-width:1400px;margin:20px auto;background:#0f0f1a;border-radius:20px;overflow:hidden;box-shadow:0 25px 80px rgba(0,0,0,0.5);">
                        <!-- Header -->
                        <div style="display:flex;justify-content:space-between;align-items:center;padding:15px 25px;background:linear-gradient(135deg,#667eea,#764ba2);flex-wrap:wrap;gap:15px;">
                            <h2 style="color:white;font-size:1.3rem;margin:0;">üî¨ Hypothesis Space Reduction Simulator</h2>
                            <div style="display:flex;gap:20px;">
                                <span style="color:rgba(255,255,255,0.9);font-size:0.85rem;"><strong>Ontologies:</strong> 4</span>
                                <span style="color:rgba(255,255,255,0.9);font-size:0.85rem;"><strong>Constraints:</strong> 3,000</span>
                                <span style="color:rgba(255,255,255,0.9);font-size:0.85rem;"><strong>Entities:</strong> 5,247</span>
                            </div>
                            <button id="hsrCloseBtn" style="width:40px;height:40px;border-radius:50%;border:2px solid rgba(255,255,255,0.3);background:transparent;color:white;font-size:1.2rem;cursor:pointer;">‚úï</button>
                        </div>
                        
                        <!-- Body -->
                        <div style="padding:20px;">
                            <div style="display:grid;grid-template-columns:1.4fr 1fr;gap:20px;">
                                <!-- Left: Canvas -->
                                <div style="background:rgba(0,0,0,0.5);border-radius:15px;padding:15px;border:1px solid rgba(255,255,255,0.1);">
                                    <svg viewBox="0 0 600 500" style="width:100%;height:auto;min-height:400px;" id="simulatorCanvas">
                                        <defs>
                                            <radialGradient id="fullSpaceGradLg" cx="50%" cy="50%" r="50%">
                                                <stop offset="0%" style="stop-color:rgba(244,67,54,0.05)"/>
                                                <stop offset="100%" style="stop-color:rgba(244,67,54,0.25)"/>
                                            </radialGradient>
                                            <radialGradient id="validSpaceGradLg" cx="50%" cy="50%" r="50%">
                                                <stop offset="0%" style="stop-color:rgba(76,175,80,0.2)"/>
                                                <stop offset="100%" style="stop-color:rgba(76,175,80,0.4)"/>
                                            </radialGradient>
                                            <filter id="glowLg">
                                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                                <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
                                            </filter>
                                            <marker id="arrowMarker" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                                <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50"/>
                                            </marker>
                                        </defs>
                                        
                                        <!-- Axis labels -->
                                        <text x="250" y="490" text-anchor="middle" fill="#666" font-size="11">Parameter Dimension Œ∏‚ÇÅ (e.g., Temperature Response)</text>
                                        <text x="15" y="250" text-anchor="middle" fill="#666" font-size="11" transform="rotate(-90, 15, 250)">Parameter Dimension Œ∏‚ÇÇ (e.g., Wear Rate)</text>
                                        
                                        <!-- Full Space -->
                                        <circle cx="220" cy="250" r="170" fill="url(#fullSpaceGradLg)" stroke="#f44336" stroke-width="2" stroke-dasharray="10,5"/>
                                        <text x="220" y="60" text-anchor="middle" fill="#f44336" font-size="12" font-weight="600">H_full: Full Hypothesis Space (8.7M)</text>
                                        
                                        <!-- Constraint Rings -->
                                        <circle cx="220" cy="250" r="145" fill="none" stroke="#ff9800" stroke-width="2" stroke-dasharray="8,4" id="simTempRing" opacity="0"/>
                                        <circle cx="220" cy="250" r="115" fill="none" stroke="#2196f3" stroke-width="2" stroke-dasharray="8,4" id="simCausalRing" opacity="0"/>
                                        <circle cx="220" cy="250" r="85" fill="none" stroke="#9c27b0" stroke-width="2" stroke-dasharray="8,4" id="simCapRing" opacity="0"/>
                                        
                                        <!-- Valid Region -->
                                        <circle cx="220" cy="250" r="55" fill="url(#validSpaceGradLg)" stroke="#4caf50" stroke-width="3" filter="url(#glowLg)"/>
                                        <text x="220" y="245" text-anchor="middle" fill="#4caf50" font-size="10" font-weight="600">H_constrained</text>
                                        <text x="220" y="260" text-anchor="middle" fill="#81c784" font-size="9" id="simValidCount">3.2M Valid</text>
                                        
                                        <!-- Points -->
                                        <g id="simPoints"></g>
                                        
                                        <!-- Labels -->
                                        <g id="tempLabel" opacity="0">
                                            <rect x="360" y="120" width="120" height="35" rx="5" fill="rgba(255,152,0,0.9)"/>
                                            <text x="420" y="135" text-anchor="middle" fill="white" font-size="9" font-weight="600">Temporal (-28%)</text>
                                            <text x="420" y="148" text-anchor="middle" fill="white" font-size="8">‚àÇW/‚àÇt ‚â• 0</text>
                                            <line x1="360" y1="137" x2="320" y2="160" stroke="#ff9800" stroke-width="2"/>
                                        </g>
                                        <g id="causalLabel" opacity="0">
                                            <rect x="370" y="200" width="110" height="35" rx="5" fill="rgba(33,150,243,0.9)"/>
                                            <text x="425" y="215" text-anchor="middle" fill="white" font-size="9" font-weight="600">Causal (-18%)</text>
                                            <text x="425" y="228" text-anchor="middle" fill="white" font-size="8">t_cause &lt; t_effect</text>
                                            <line x1="370" y1="217" x2="330" y2="230" stroke="#2196f3" stroke-width="2"/>
                                        </g>
                                        <g id="capLabel" opacity="0">
                                            <rect x="350" y="300" width="130" height="35" rx="5" fill="rgba(156,39,176,0.9)"/>
                                            <text x="415" y="315" text-anchor="middle" fill="white" font-size="9" font-weight="600">Capacity (-12%)</text>
                                            <text x="415" y="328" text-anchor="middle" fill="white" font-size="8">T ‚àà [20¬∞C, 200¬∞C]</text>
                                            <line x1="350" y1="317" x2="300" y2="300" stroke="#9c27b0" stroke-width="2"/>
                                        </g>
                                        <g id="physLabel" opacity="0">
                                            <rect x="50" y="350" width="120" height="35" rx="5" fill="rgba(244,67,54,0.9)"/>
                                            <text x="110" y="365" text-anchor="middle" fill="white" font-size="9" font-weight="600">Physical (-5%)</text>
                                            <text x="110" y="378" text-anchor="middle" fill="white" font-size="8">‚àëE_in = ‚àëE_out</text>
                                            <line x1="170" y1="367" x2="190" y2="330" stroke="#f44336" stroke-width="2"/>
                                        </g>
                                        
                                        <!-- Result -->
                                        <path d="M420,250 L480,250" stroke="#4caf50" stroke-width="4" marker-end="url(#arrowMarker)"/>
                                        <text x="450" y="240" text-anchor="middle" fill="#4caf50" font-size="10" font-weight="600" id="simReductionPct">63%</text>
                                        <circle cx="540" cy="250" r="45" fill="url(#validSpaceGradLg)" stroke="#4caf50" stroke-width="3" filter="url(#glowLg)"/>
                                        <text x="540" y="240" text-anchor="middle" fill="#4caf50" font-size="9" font-weight="600">Result</text>
                                        <text x="540" y="255" text-anchor="middle" fill="#81c784" font-size="12" font-weight="700" id="simResultSize">3.2M</text>
                                        <text x="540" y="270" text-anchor="middle" fill="#ffc107" font-size="9" font-weight="600" id="simPrivacyResult">2.7√ó Privacy</text>
                                        
                                        <!-- Stats Box -->
                                        <rect x="430" y="380" width="150" height="90" rx="8" fill="rgba(0,0,0,0.6)" stroke="rgba(255,255,255,0.1)"/>
                                        <text x="505" y="398" text-anchor="middle" fill="#9e9e9e" font-size="9" font-weight="600">LIVE STATISTICS</text>
                                        <line x1="440" y1="405" x2="570" y2="405" stroke="rgba(255,255,255,0.1)"/>
                                        <text x="445" y="422" fill="#9e9e9e" font-size="8">Points Valid:</text>
                                        <text x="565" y="422" text-anchor="end" fill="#4caf50" font-size="9" font-weight="600" id="svgValidCount">6</text>
                                        <text x="445" y="438" fill="#9e9e9e" font-size="8">Points Eliminated:</text>
                                        <text x="565" y="438" text-anchor="end" fill="#f44336" font-size="9" font-weight="600" id="svgEliminatedCount">0</text>
                                        <text x="445" y="454" fill="#9e9e9e" font-size="8">SNR Improvement:</text>
                                        <text x="565" y="454" text-anchor="end" fill="#ffc107" font-size="9" font-weight="600" id="svgSNR">1.00√ó</text>
                                    </svg>
                                    
                                    <!-- Legend -->
                                    <div style="display:flex;justify-content:center;gap:15px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.1);margin-top:10px;flex-wrap:wrap;">
                                        <span style="display:flex;align-items:center;gap:5px;font-size:0.7rem;color:#9e9e9e;"><span style="width:10px;height:10px;border-radius:50%;background:#f44336;"></span> Invalid</span>
                                        <span style="display:flex;align-items:center;gap:5px;font-size:0.7rem;color:#9e9e9e;"><span style="width:10px;height:10px;border-radius:50%;background:#4caf50;"></span> Valid</span>
                                        <span style="display:flex;align-items:center;gap:5px;font-size:0.7rem;color:#9e9e9e;"><span style="width:15px;height:3px;background:#ff9800;"></span> Temporal</span>
                                        <span style="display:flex;align-items:center;gap:5px;font-size:0.7rem;color:#9e9e9e;"><span style="width:15px;height:3px;background:#2196f3;"></span> Causal</span>
                                        <span style="display:flex;align-items:center;gap:5px;font-size:0.7rem;color:#9e9e9e;"><span style="width:15px;height:3px;background:#9c27b0;"></span> Capacity</span>
                                    </div>
                                </div>
                                
                                <!-- Right: Controls -->
                                <div style="display:flex;flex-direction:column;gap:12px;overflow-y:auto;max-height:550px;">
                                    <!-- Controls -->
                                    <div style="background:rgba(0,0,0,0.4);border-radius:12px;padding:15px;border:1px solid rgba(255,255,255,0.05);">
                                        <h4 style="font-size:0.8rem;color:#9e9e9e;text-transform:uppercase;letter-spacing:0.5px;margin:0 0 12px 0;">üéÆ Simulation Controls</h4>
                                        <div style="display:flex;gap:8px;">
                                            <button id="simResetBtn" style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.15);background:rgba(255,255,255,0.05);color:white;font-size:0.8rem;cursor:pointer;">‚Ü∫ Reset</button>
                                            <button id="simPlayBtn" style="flex:1;padding:10px;border-radius:8px;border:1px solid #4caf50;background:linear-gradient(135deg,#4caf50,#8bc34a);color:white;font-size:0.8rem;cursor:pointer;">‚ñ∂ Play</button>
                                            <button id="simStepBtn" style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.15);background:rgba(255,255,255,0.05);color:white;font-size:0.8rem;cursor:pointer;">‚è≠ Step</button>
                                        </div>
                                        <div style="display:flex;align-items:center;gap:10px;margin-top:12px;">
                                            <label style="font-size:0.75rem;color:#9e9e9e;">Speed:</label>
                                            <input type="range" min="0.5" max="3" step="0.5" value="1" id="simSpeed" style="flex:1;"/>
                                            <span id="speedLabel" style="font-size:0.8rem;color:#667eea;font-weight:600;min-width:25px;">1√ó</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Current Step -->
                                    <div style="background:rgba(102,126,234,0.1);border-radius:12px;padding:15px;border:1px solid rgba(102,126,234,0.3);">
                                        <h4 style="font-size:0.8rem;color:#9e9e9e;text-transform:uppercase;letter-spacing:0.5px;margin:0 0 10px 0;">üìç Current Step</h4>
                                        <div style="display:flex;align-items:center;gap:12px;">
                                            <div id="simStepNum" style="width:45px;height:45px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.4rem;font-weight:700;color:white;">0</div>
                                            <div>
                                                <div id="simStepTitle" style="font-size:0.95rem;font-weight:600;color:white;">Initial State</div>
                                                <div id="simStepDesc" style="font-size:0.75rem;color:#9e9e9e;">All 8.7M parameter configurations visible</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Pipeline -->
                                    <div style="background:rgba(0,0,0,0.4);border-radius:12px;padding:15px;border:1px solid rgba(255,255,255,0.05);">
                                        <h4 style="font-size:0.8rem;color:#9e9e9e;text-transform:uppercase;letter-spacing:0.5px;margin:0 0 10px 0;">üîÑ Constraint Pipeline</h4>
                                        <div style="display:flex;align-items:center;justify-content:space-between;gap:5px;" id="pipelineVisual">
                                            <div class="pipe-node" data-step="0" style="text-align:center;flex:1;">
                                                <div style="width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);border:2px solid #667eea;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:700;color:white;margin:0 auto 3px;">0</div>
                                                <div style="font-size:0.6rem;color:#e0e0e0;">Start</div>
                                            </div>
                                            <div style="width:15px;height:2px;background:rgba(255,255,255,0.2);"></div>
                                            <div class="pipe-node" data-step="1" style="text-align:center;flex:1;">
                                                <div style="width:30px;height:30px;border-radius:50%;background:transparent;border:2px solid #ff9800;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:700;color:#ff9800;margin:0 auto 3px;">1</div>
                                                <div style="font-size:0.6rem;color:#9e9e9e;">Temp</div>
                                            </div>
                                            <div style="width:15px;height:2px;background:rgba(255,255,255,0.2);"></div>
                                            <div class="pipe-node" data-step="2" style="text-align:center;flex:1;">
                                                <div style="width:30px;height:30px;border-radius:50%;background:transparent;border:2px solid #2196f3;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:700;color:#2196f3;margin:0 auto 3px;">2</div>
                                                <div style="font-size:0.6rem;color:#9e9e9e;">Causal</div>
                                            </div>
                                            <div style="width:15px;height:2px;background:rgba(255,255,255,0.2);"></div>
                                            <div class="pipe-node" data-step="3" style="text-align:center;flex:1;">
                                                <div style="width:30px;height:30px;border-radius:50%;background:transparent;border:2px solid #9c27b0;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:700;color:#9c27b0;margin:0 auto 3px;">3</div>
                                                <div style="font-size:0.6rem;color:#9e9e9e;">Cap</div>
                                            </div>
                                            <div style="width:15px;height:2px;background:rgba(255,255,255,0.2);"></div>
                                            <div class="pipe-node" data-step="4" style="text-align:center;flex:1;">
                                                <div style="width:30px;height:30px;border-radius:50%;background:transparent;border:2px solid #f44336;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:700;color:#f44336;margin:0 auto 3px;">4</div>
                                                <div style="font-size:0.6rem;color:#9e9e9e;">Phys</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Metrics -->
                                    <div style="background:rgba(0,0,0,0.4);border-radius:12px;padding:15px;border:1px solid rgba(255,255,255,0.05);">
                                        <h4 style="font-size:0.8rem;color:#9e9e9e;text-transform:uppercase;letter-spacing:0.5px;margin:0 0 10px 0;">üìä Real-Time Metrics</h4>
                                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                                            <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:10px;text-align:center;">
                                                <div style="font-size:0.65rem;color:#9e9e9e;text-transform:uppercase;">Space Size</div>
                                                <div id="simSpaceSize" style="font-size:1.1rem;font-weight:700;color:white;">8.7M</div>
                                                <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-top:5px;">
                                                    <div id="simSpaceFill" style="width:100%;height:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);border-radius:2px;transition:width 0.5s;"></div>
                                                </div>
                                            </div>
                                            <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:10px;text-align:center;">
                                                <div style="font-size:0.65rem;color:#9e9e9e;text-transform:uppercase;">Reduction</div>
                                                <div id="simReduction" style="font-size:1.1rem;font-weight:700;color:#f44336;">0%</div>
                                                <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-top:5px;">
                                                    <div id="simReductionFill" style="width:0%;height:100%;background:linear-gradient(90deg,#f44336,#ff9800);border-radius:2px;transition:width 0.5s;"></div>
                                                </div>
                                            </div>
                                            <div style="background:rgba(76,175,80,0.1);border:1px solid rgba(76,175,80,0.3);border-radius:8px;padding:10px;text-align:center;">
                                                <div style="font-size:0.65rem;color:#9e9e9e;text-transform:uppercase;">Privacy Gain</div>
                                                <div id="simPrivacy" style="font-size:1.1rem;font-weight:700;color:#4caf50;">1.00√ó</div>
                                            </div>
                                            <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:10px;text-align:center;">
                                                <div style="font-size:0.65rem;color:#9e9e9e;text-transform:uppercase;">Eliminated</div>
                                                <div id="simEliminated" style="font-size:0.9rem;font-weight:700;color:white;">0 / 44</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Formula -->
                                    <div style="background:rgba(156,39,176,0.1);border-radius:12px;padding:15px;border:1px solid rgba(156,39,176,0.2);">
                                        <h4 style="font-size:0.8rem;color:#9e9e9e;text-transform:uppercase;letter-spacing:0.5px;margin:0 0 10px 0;">üìê Mathematical Impact</h4>
                                        <div style="text-align:center;">
                                            <div style="font-family:'Kalam',cursive;font-size:0.9rem;color:#ce93d8;margin-bottom:10px;">SNR = Signal / (œÉ¬≤ √ó |H|)</div>
                                            <div style="display:flex;align-items:center;justify-content:center;gap:10px;">
                                                <div style="background:rgba(0,0,0,0.3);border:1px solid rgba(244,67,54,0.3);border-radius:6px;padding:6px 10px;text-align:center;">
                                                    <div style="font-size:0.6rem;color:#9e9e9e;">Before</div>
                                                    <div style="font-size:0.7rem;color:#e0e0e0;">SNR‚ÇÄ</div>
                                                </div>
                                                <span style="color:#4caf50;font-size:1.2rem;">‚Üí</span>
                                                <div style="background:rgba(0,0,0,0.3);border:1px solid rgba(76,175,80,0.3);border-radius:6px;padding:6px 10px;text-align:center;">
                                                    <div style="font-size:0.6rem;color:#9e9e9e;">After</div>
                                                    <div id="simSNRGain" style="font-size:0.75rem;color:#4caf50;font-weight:600;">= 1.00√ó SNR‚ÇÄ</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Key Conditions and Factors -->
                <div class="hsr-section animate-in delay-3" id="hsr-factors">
                    <div class="section-header">
                        <span class="section-number">2</span>
                        <h3>Key Conditions & Factors</h3>
                    </div>
                    
                    <div class="factors-row">
                        <div class="factor-box">
                            <div class="factor-emoji">üéØ</div>
                            <div class="factor-name">Constraint Specificity</div>
                            <div class="factor-detail">More specific = Greater reduction</div>
                            <div class="factor-example-box">
                                <div class="weak-example">‚ùå "Temperature affects output"</div>
                                <div class="strong-example">‚úì "T ‚àà [20¬∞C, 200¬∞C]" ‚Üí -15%</div>
                            </div>
                            <div class="impact-meter">
                                <div class="impact-fill" style="width:75%"></div>
                                <span class="impact-label">High Impact</span>
                            </div>
                        </div>
                        
                        <div class="factor-box">
                            <div class="factor-emoji">üî¢</div>
                            <div class="factor-name">Constraint Count |C|</div>
                            <div class="factor-detail">More constraints = More intersections</div>
                            <div class="factor-example-box">
                                <div class="strong-example">3,000 constraints from 4 ontologies</div>
                            </div>
                            <div class="impact-meter">
                                <div class="impact-fill" style="width:85%"></div>
                                <span class="impact-label">Very High Impact</span>
                            </div>
                        </div>
                        
                        <div class="factor-box">
                            <div class="factor-emoji">üîÄ</div>
                            <div class="factor-name">Constraint Independence</div>
                            <div class="factor-detail">Independent constraints multiply reductions</div>
                            <div class="factor-example-box">
                                <div class="formula-example">|H<sub>reduced</sub>| ‚âà |H| √ó ‚àè(1 - r·µ¢)</div>
                            </div>
                            <div class="impact-meter">
                                <div class="impact-fill" style="width:65%"></div>
                                <span class="impact-label">Medium-High</span>
                            </div>
                        </div>
                        
                        <div class="factor-box">
                            <div class="factor-emoji">üéõÔ∏è</div>
                            <div class="factor-name">Domain Coverage</div>
                            <div class="factor-detail">Constraints must cover prediction domain</div>
                            <div class="factor-example-box">
                                <div class="strong-example">Temporal + Causal + Capacity = 94%</div>
                            </div>
                            <div class="impact-meter">
                                <div class="impact-fill" style="width:90%"></div>
                                <span class="impact-label">Critical</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="threshold-warning-box">
                        <div class="warning-icon">‚ö†Ô∏è</div>
                        <div class="warning-content">
                            <div class="warning-title">Critical Condition: Violation Rate œÅ &lt; 18%</div>
                            <div class="warning-text">When œÅ ‚â• 18%, constraint projections become too aggressive, causing oscillation and fragmented hypothesis space.</div>
                        </div>
                    </div>
                </div>

                <!-- Section 3: Why Necessary -->
                <div class="hsr-section animate-in delay-4" id="hsr-why">
                    <div class="section-header">
                        <span class="section-number">3</span>
                        <h3>Why is Hypothesis Space Reduction Necessary?</h3>
                    </div>
                    
                    <div class="why-comparison">
                        <div class="why-box problem-box">
                            <div class="why-header">üò∞ Without Reduction</div>
                            <ul class="why-list">
                                <li>DP adds noise œÉ¬≤ to protect data</li>
                                <li>Must mask ALL gradients in H<sub>full</sub></li>
                                <li>Larger space = More noise = Worse utility</li>
                                <li>SNR ‚àù 1/|H| (inversely proportional)</li>
                            </ul>
                        </div>
                        
                        <div class="transform-arrow">
                            <div class="arrow-body">‚Üí</div>
                            <div class="arrow-text">Constraint<br>Reduction</div>
                        </div>
                        
                        <div class="why-box solution-box">
                            <div class="why-header">‚ú® With Reduction</div>
                            <ul class="why-list success">
                                <li>Smaller space H<sub>constrained</sub> to protect</li>
                                <li>Same noise has LESS relative impact</li>
                                <li>SNR improves by factor 1/(1-Œ∏)</li>
                                <li>Œ∏ = 0.37 ‚Üí <strong>2.7√ó better!</strong></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="snr-formula-box">
                        <div class="formula-row">
                            <span class="formula-label">Before:</span>
                            <span class="formula-content">SNR = Signal / (œÉ¬≤ √ó |H<sub>full</sub>|)</span>
                        </div>
                        <div class="formula-row highlight-formula">
                            <span class="formula-label">After:</span>
                            <span class="formula-content">SNR = Signal / (œÉ¬≤ √ó |H<sub>constrained</sub>|) = <strong class="green-text">2.7√ó better!</strong></span>
                        </div>
                    </div>
                </div>

                <!-- Section 4: Novelty Correlation -->
                <div class="hsr-section animate-in delay-5" id="hsr-novelty">
                    <div class="section-header">
                        <span class="section-number">4</span>
                        <h3>Correlation with Semantics & Constraints: The Novelty</h3>
                    </div>
                    
                    <div class="novelty-pipeline">
                        <div class="pipeline-stage">
                            <div class="stage-emoji">üìö</div>
                            <div class="stage-name">Domain Ontologies</div>
                            <div class="stage-detail">ISA-95, MASON, NIST</div>
                            <div class="stage-stat">5,247 entities</div>
                        </div>
                        <div class="pipeline-arrow">‚Üí</div>
                        <div class="pipeline-stage">
                            <div class="stage-emoji">üìê</div>
                            <div class="stage-name">SPARQL Extraction</div>
                            <div class="stage-detail">Derive constraint rules</div>
                            <div class="stage-stat">3,000 rules</div>
                        </div>
                        <div class="pipeline-arrow">‚Üí</div>
                        <div class="pipeline-stage highlight-stage">
                            <div class="stage-emoji">üéØ</div>
                            <div class="stage-name">Space Reduction</div>
                            <div class="stage-detail">H<sub>full</sub> ‚Üí H<sub>constrained</sub></div>
                            <div class="stage-stat">Œ∏ = 0.37 (63%)</div>
                        </div>
                        <div class="pipeline-arrow">‚Üí</div>
                        <div class="pipeline-stage">
                            <div class="stage-emoji">üîí</div>
                            <div class="stage-name">Privacy Gain</div>
                            <div class="stage-detail">Same Œµ, less loss</div>
                            <div class="stage-stat">2.7√ó better</div>
                        </div>
                    </div>
                    
                    <div class="key-insight-box">
                        <div class="insight-icon">üí°</div>
                        <div class="insight-text">
                            <strong>Key Novel Insight:</strong> This is the first work to show that <em>domain knowledge encoded as semantic constraints</em> directly translates to <em>differential privacy amplification</em> without modifying the DP mechanism!
                        </div>
                    </div>
                    
                    <div class="comparison-table-container">
                        <table class="comparison-tbl">
                            <thead>
                                <tr>
                                    <th>Approach</th>
                                    <th>Space Reduction</th>
                                    <th>Privacy Benefit</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Standard DP</td>
                                    <td class="bad-val">None</td>
                                    <td class="bad-val">Baseline</td>
                                </tr>
                                <tr>
                                    <td>Gradient Clipping</td>
                                    <td class="med-val">~10%</td>
                                    <td class="med-val">Marginal</td>
                                </tr>
                                <tr>
                                    <td>Subspace Learning</td>
                                    <td class="med-val">~25%</td>
                                    <td class="med-val">Moderate</td>
                                </tr>
                                <tr class="highlight-row">
                                    <td><strong>SCFA (Ours)</strong></td>
                                    <td class="good-val"><strong>63%</strong></td>
                                    <td class="good-val"><strong>2.7√ó</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section 5: Impact of Skipping -->
                <div class="hsr-section animate-in delay-6" id="hsr-skip">
                    <div class="section-header">
                        <span class="section-number">5</span>
                        <h3>What If We Skip This Step?</h3>
                    </div>
                    
                    <div class="skip-comparison">
                        <div class="scenario-box good-scenario">
                            <div class="scenario-header">‚úì WITH Hypothesis Space Reduction</div>
                            <div class="metric-row"><span class="metric-name">Space Size:</span><span class="metric-val good">3.2M effective</span></div>
                            <div class="metric-row"><span class="metric-name">Noise Impact:</span><span class="metric-val good">Low (concentrated)</span></div>
                            <div class="metric-row"><span class="metric-name">Utility Loss @ Œµ=10:</span><span class="metric-val good">3.7%</span></div>
                            <div class="metric-row"><span class="metric-name">Convergence:</span><span class="metric-val good">32 rounds</span></div>
                            <div class="metric-row"><span class="metric-name">Constraint Satisfaction:</span><span class="metric-val good">94%</span></div>
                        </div>
                        
                        <div class="vs-badge">VS</div>
                        
                        <div class="scenario-box bad-scenario">
                            <div class="scenario-header">‚úó WITHOUT Hypothesis Space Reduction</div>
                            <div class="metric-row"><span class="metric-name">Space Size:</span><span class="metric-val bad">8.7M full</span></div>
                            <div class="metric-row"><span class="metric-name">Noise Impact:</span><span class="metric-val bad">High (dispersed)</span></div>
                            <div class="metric-row"><span class="metric-name">Utility Loss @ Œµ=10:</span><span class="metric-val bad">12.1%</span></div>
                            <div class="metric-row"><span class="metric-name">Convergence:</span><span class="metric-val bad">41 rounds</span></div>
                            <div class="metric-row"><span class="metric-name">Constraint Satisfaction:</span><span class="metric-val bad">67%</span></div>
                        </div>
                    </div>
                    
                    <div class="cascade-impact">
                        <div class="cascade-title">Cascading Impact of Skipping HSR:</div>
                        <div class="cascade-flow">
                            <div class="cascade-step">Full space requires more noise</div>
                            <div class="cascade-arrow">‚Üí</div>
                            <div class="cascade-step">Noise corrupts gradient signal</div>
                            <div class="cascade-arrow">‚Üí</div>
                            <div class="cascade-step">Model learns impossible patterns</div>
                            <div class="cascade-arrow">‚Üí</div>
                            <div class="cascade-step">Predictions violate constraints</div>
                            <div class="cascade-arrow">‚Üí</div>
                            <div class="cascade-step danger">‚ö†Ô∏è Unsafe for deployment!</div>
                        </div>
                    </div>
                    
                    <div class="real-example-box">
                        <div class="example-icon">üè≠</div>
                        <div class="example-content">
                            <div class="example-title">Real-World: Tool Wear Prediction</div>
                            <div class="example-cases">
                                <div class="example-case bad-case">
                                    <strong>Without HSR:</strong> Model predicts wear 0.85 ‚Üí 0.72 (impossible decrease!)
                                    <br><span class="consequence">‚Üí Maintenance skipped ‚Üí Tool breaks ‚Üí $50K loss</span>
                                </div>
                                <div class="example-case good-case">
                                    <strong>With HSR:</strong> Model constrained: wear only increases ‚Üí Predicts 0.85 ‚Üí 0.91
                                    <br><span class="consequence">‚Üí Timely replacement ‚Üí Zero downtime</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Summary -->
                <div class="hsr-summary-box animate-in delay-7">
                    <div class="summary-header">üìã Summary: Hypothesis Space Reduction</div>
                    <div class="summary-items">
                        <div class="summary-item">
                            <span class="summary-label">How?</span>
                            <span class="summary-value">Semantic constraints eliminate physically impossible configurations</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Why?</span>
                            <span class="summary-value">Smaller space = Less noise impact = Better privacy-utility</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Impact?</span>
                            <span class="summary-value">Œ∏ = 0.37 (63% reduction) ‚Üí 2.7√ó improvement</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Skip it?</span>
                            <span class="summary-value">3.3√ó more utility loss + unsafe predictions</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- ==================== SCENE 21: RQ2 RESULTS ==================== -->
        <section class="scene" data-scene="21" data-title="RQ2: Results">
            <div class="scene-content">
                <div class="rq-badge rq2">RQ2 Results</div>
                <h2 class="scene-title animate-in">Privacy-Utility Validation</h2>
                
                <div class="results-table-container animate-in delay-1">
                    <table class="results-table green">
                        <thead>
                            <tr>
                                <th>Privacy Budget Œµ</th>
                                <th>Privacy Level</th>
                                <th>SCFA Loss</th>
                                <th>FedAvg Loss</th>
                                <th>Improvement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="animate-row" data-delay="0">
                                <td><span class="stat-highlight" data-stat="eps-100">100</span></td>
                                <td>Minimal</td>
                                <td class="scfa stat-highlight" data-stat="scfa-100">0.8%</td>
                                <td class="fedavg">2.1%</td>
                                <td class="improvement stat-highlight" data-stat="imp-100">2.6√ó</td>
                            </tr>
                            <tr class="animate-row highlight-row" data-delay="200">
                                <td><span class="stat-highlight zoom-stat" data-stat="eps-10"><strong>10</strong></span></td>
                                <td><strong>GDPR-Compatible</strong></td>
                                <td class="scfa stat-highlight zoom-stat" data-stat="scfa-10"><strong>3.7%</strong></td>
                                <td class="fedavg"><strong>12.1%</strong></td>
                                <td class="improvement best stat-highlight zoom-stat" data-stat="imp-10"><strong>3.3√ó</strong></td>
                            </tr>
                            <tr class="animate-row" data-delay="400">
                                <td><span class="stat-highlight" data-stat="eps-1">1</span></td>
                                <td>Moderate</td>
                                <td class="scfa stat-highlight" data-stat="scfa-1">8.7%</td>
                                <td class="fedavg">23.9%</td>
                                <td class="improvement stat-highlight" data-stat="imp-1">2.7√ó</td>
                            </tr>
                            <tr class="animate-row" data-delay="600">
                                <td><span class="stat-highlight" data-stat="eps-01">0.1</span></td>
                                <td>Strong</td>
                                <td class="scfa stat-highlight" data-stat="scfa-01">23.3%</td>
                                <td class="fedavg">43.9%</td>
                                <td class="improvement stat-highlight" data-stat="imp-01">1.9√ó</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="metrics-summary green animate-in delay-2">
                    <div class="metric-box">
                        <div class="metric-value stat-highlight zoom-stat" data-stat="theta-final">Œ∏ = 0.37</div>
                        <div class="metric-label">Space Reduction</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value stat-highlight" data-stat="snr">31.5%</div>
                        <div class="metric-label">SNR Improvement</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value stat-highlight" data-stat="pred-error">7.5%</div>
                        <div class="metric-label">Prediction Error</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 14: RQ3 ARCHITECTURE ==================== -->
        <section class="scene" data-scene="22" data-title="RQ3: Violations">
            <div class="scene-content">
                <div class="rq-badge rq3">Research Question 3</div>
                <h2 class="scene-title animate-in">Violation-Performance Relationship</h2>
                <p class="scene-subtitle animate-in delay-1">How does constraint violation rate correlate with model performance?</p>
                
                <div class="answer-reveal animate-in delay-2">
                    <div class="answer-box success orange">
                        <div class="answer-icon">‚ö†Ô∏è</div>
                        <div class="answer-content">
                            <div class="answer-main">Linear Relationship with Critical Threshold at <span class="stat-highlight zoom-stat" data-stat="critical">18%</span></div>
                            <div class="answer-detail">Above 18%, performance <strong>collapses catastrophically!</strong> (R¬≤ = <span class="stat-highlight" data-stat="rq3-rsq">0.93</span>)</div>
                        </div>
                    </div>
                </div>

                <div class="architecture-diagram animate-in delay-3">
                    <h3>RQ3 Architecture: Violation Impact Analysis</h3>
                    <img src="images/rq3_architecture.png" alt="RQ3 Architecture" class="arch-image">
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 15: RQ3 PROPOSITION (ANIMATED) ==================== -->
        <section class="scene" data-scene="23" data-title="RQ3: Proposition 1">
            <div class="scene-content">
                <div class="rq-badge rq3">RQ3 Deep Dive</div>
                <h2 class="scene-title animate-in">Proposition 1: Violation-Performance Formula</h2>

                <div class="theorem-container orange animate-in delay-1">
                    <div class="theorem-header-box orange">
                        <span class="theorem-badge orange">PROPOSITION 1</span>
                        <span class="theorem-name">Linear Degradation Model</span>
                    </div>

                    <div class="animated-equation breakdown-style" id="prop1-eq">
                        <div class="equation-display">
                            <div class="eq-component" data-component="loss" data-order="1">
                                <div class="component-value">Model Loss</div>
                            </div>
                            <div class="eq-operator" data-order="2">=</div>
                            <div class="eq-component base-term" data-component="base" data-order="3">
                                <div class="component-value stat-highlight" data-stat="f-star">0.12</div>
                                <div class="component-label">F* (Optimal)</div>
                                <div class="component-detail">Best achievable with centralized training</div>
                            </div>
                            <div class="eq-operator" data-order="4">+</div>
                            <div class="eq-component overhead-term" data-component="overhead" data-order="5">
                                <div class="component-value stat-highlight" data-stat="epsilon-opt">0.03</div>
                                <div class="component-label">Œµ<sub>opt</sub></div>
                                <div class="component-detail">FL overhead (cost of being distributed)</div>
                            </div>
                            <div class="eq-operator" data-order="6">+</div>
                            <div class="eq-component penalty-term" data-component="violation" data-order="7">
                                <div class="component-value">œÅ √ó <span class="stat-highlight" data-stat="penalty-coef">0.45</span></div>
                                <div class="component-label">Violation Penalty</div>
                                <div class="component-detail">Each 1% costs 0.45% performance</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Threshold Visualization -->
                <div class="threshold-visualization animate-in delay-2">
                    <h4>Operational Thresholds</h4>
                    <div class="threshold-bar">
                        <div class="zone safe" style="width: 27.8%;">
                            <span class="zone-label">SAFE</span>
                            <span class="zone-range stat-highlight" data-stat="safe-range">œÅ &lt; 5%</span>
                        </div>
                        <div class="zone warning" style="width: 27.8%;">
                            <span class="zone-label">WARNING</span>
                            <span class="zone-range stat-highlight" data-stat="warn-range">5% - 10%</span>
                        </div>
                        <div class="zone danger" style="width: 22.2%;">
                            <span class="zone-label">DANGER</span>
                            <span class="zone-range stat-highlight" data-stat="danger-range">10% - 18%</span>
                        </div>
                        <div class="zone critical" style="width: 22.2%;">
                            <span class="zone-label">COLLAPSE</span>
                            <span class="zone-range stat-highlight zoom-stat" data-stat="collapse-range">&gt; 18%</span>
                        </div>
                    </div>
                    <div class="threshold-marker">
                        <div class="marker-line"></div>
                        <div class="marker-label">Critical: œÅ = <span class="stat-highlight zoom-stat" data-stat="rho-crit">18%</span></div>
                    </div>
                </div>

                <div class="practical-rule animate-in delay-3">
                    <div class="rule-icon">üìè</div>
                    <div class="rule-content">
                        <h4>Practical Rule of Thumb</h4>
                        <p>Every <span class="stat-highlight zoom-stat" data-stat="rule-pct">1%</span> increase in constraint violations costs you approximately <span class="stat-highlight zoom-stat" data-stat="rule-cost">0.45%</span> in model performance.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 16: RQ3 RESULTS ==================== -->
        <section class="scene" data-scene="24" data-title="RQ3: Results">
            <div class="scene-content">
                <div class="rq-badge rq3">RQ3 Results</div>
                <h2 class="scene-title animate-in">Which Constraints Matter Most?</h2>
                
                <div class="results-table-container animate-in delay-1">
                    <table class="results-table orange">
                        <thead>
                            <tr>
                                <th>Constraint Type</th>
                                <th>Impact Coefficient</th>
                                <th>Relative Impact</th>
                                <th>Priority</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="animate-row highlight-row" data-delay="0">
                                <td><strong>‚è±Ô∏è Temporal Monotonicity</strong></td>
                                <td><span class="stat-highlight zoom-stat" data-stat="temporal-coef"><strong>0.62</strong></span></td>
                                <td class="best"><span class="stat-highlight zoom-stat" data-stat="temporal-rel"><strong>1.38√ó (Highest!)</strong></span></td>
                                <td><span class="priority critical">CRITICAL</span></td>
                            </tr>
                            <tr class="animate-row" data-delay="200">
                                <td>üîó Causal Precedence</td>
                                <td><span class="stat-highlight" data-stat="causal-coef">0.48</span></td>
                                <td><span class="stat-highlight" data-stat="causal-rel">1.07√ó</span></td>
                                <td><span class="priority high">HIGH</span></td>
                            </tr>
                            <tr class="animate-row" data-delay="400">
                                <td>üìä Capacity Bounds</td>
                                <td><span class="stat-highlight" data-stat="capacity-coef">0.31</span></td>
                                <td><span class="stat-highlight" data-stat="capacity-rel">0.69√ó</span></td>
                                <td><span class="priority medium">MEDIUM</span></td>
                            </tr>
                            <tr class="animate-row" data-delay="600">
                                <td>‚öõÔ∏è Physical Laws</td>
                                <td><span class="stat-highlight" data-stat="physical-coef">0.21</span></td>
                                <td><span class="stat-highlight" data-stat="physical-rel">0.47√ó</span></td>
                                <td><span class="priority medium">MEDIUM</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="performance-cards animate-in delay-2">
                    <h4>Performance at Different Violation Levels</h4>
                    <div class="perf-grid">
                        <div class="perf-card safe">
                            <div class="perf-range stat-highlight" data-stat="perf-safe-range">œÅ &lt; 5%</div>
                            <div class="perf-score stat-highlight zoom-stat" data-stat="perf-safe">F1 = 0.85</div>
                            <div class="perf-pct">95%+ optimal</div>
                        </div>
                        <div class="perf-card warning">
                            <div class="perf-range stat-highlight" data-stat="perf-warn-range">5% - 10%</div>
                            <div class="perf-score stat-highlight" data-stat="perf-warn">F1 = 0.81</div>
                            <div class="perf-pct">90% optimal</div>
                        </div>
                        <div class="perf-card danger">
                            <div class="perf-range stat-highlight" data-stat="perf-danger-range">10% - 18%</div>
                            <div class="perf-score stat-highlight" data-stat="perf-danger">F1 = 0.77</div>
                            <div class="perf-pct">85% optimal</div>
                        </div>
                        <div class="perf-card critical">
                            <div class="perf-range stat-highlight zoom-stat" data-stat="perf-crit-range">&gt; 18%</div>
                            <div class="perf-score stat-highlight zoom-stat" data-stat="perf-crit">F1 = 0.31</div>
                            <div class="perf-pct">COLLAPSE!</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 17: KEY RESULTS SUMMARY ==================== -->
        <section class="scene" data-scene="25" data-title="Key Results">
            <div class="scene-content">
                <div class="chapter-badge success">Summary</div>
                <h2 class="scene-title animate-in">Key Results at a Glance</h2>
                
                <div class="results-summary animate-in delay-1">
                    <div class="summary-card rq1" data-delay="0">
                        <div class="summary-rq">RQ1</div>
                        <div class="summary-number stat-highlight zoom-stat" data-stat="sum-conv">22%</div>
                        <div class="summary-label">Faster Convergence</div>
                        <div class="summary-detail"><span class="stat-highlight" data-stat="sum-rounds">32 vs 41 rounds</span></div>
                        <div class="summary-theory">Theorem 1: R¬≤ = <span class="stat-highlight" data-stat="sum-r1">0.94</span></div>
                    </div>
                    <div class="summary-card rq2" data-delay="200">
                        <div class="summary-rq">RQ2</div>
                        <div class="summary-number stat-highlight zoom-stat" data-stat="sum-priv">2.7√ó</div>
                        <div class="summary-label">Better Privacy-Utility</div>
                        <div class="summary-detail"><span class="stat-highlight" data-stat="sum-loss">3.7% vs 12.1%</span> at Œµ=10</div>
                        <div class="summary-theory">Theorem 2: Œ∏ = <span class="stat-highlight" data-stat="sum-theta">0.37</span></div>
                    </div>
                    <div class="summary-card rq3" data-delay="400">
                        <div class="summary-rq">RQ3</div>
                        <div class="summary-number stat-highlight zoom-stat" data-stat="sum-thresh">18%</div>
                        <div class="summary-label">Critical Threshold</div>
                        <div class="summary-detail">Linear until collapse</div>
                        <div class="summary-theory">Proposition 1: R¬≤ = <span class="stat-highlight" data-stat="sum-r3">0.93</span></div>
                    </div>
                </div>

                <div class="validation-banner animate-in delay-2">
                    <span class="validation-icon">‚úì</span>
                    <span class="validation-text">All three theorems validated with <span class="stat-highlight zoom-stat" data-stat="all-rsq">R¬≤ > 0.90</span> ‚Äî Theory matches Practice!</span>
                </div>

                <div class="contributions-grid animate-in delay-3">
                    <div class="contribution-card">
                        <h4>üéì Theoretical Contributions</h4>
                        <ul>
                            <li>First convergence guarantee for constraint-based FL</li>
                            <li>Privacy-utility bounds via hypothesis space reduction</li>
                            <li>Linear violation-performance model with critical threshold</li>
                        </ul>
                    </div>
                    <div class="contribution-card">
                        <h4>üè≠ Practical Impact</h4>
                        <ul>
                            <li>GDPR-compliant privacy that works</li>
                            <li>Clear operational thresholds</li>
                            <li>Edge-deployable: <span class="stat-highlight" data-stat="model-size">16 MB</span>, <span class="stat-highlight" data-stat="inference">87ms</span></li>
                            <li>Only <span class="stat-highlight" data-stat="overhead">0.29%</span> overhead</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 19: TECHNICAL IMPLEMENTATION ==================== -->
        <section class="scene" data-scene="26" data-title="Technical Implementation">
            <div class="scene-content">
                <div class="chapter-badge architecture">‚öôÔ∏è Implementation Details</div>
                <h2 class="scene-title animate-in">Technical Implementation</h2>
                <p class="scene-subtitle animate-in delay-1">Virtual facility simulation, data pipeline, and knowledge graph construction</p>

                <!-- Architecture Visualization Container -->
                <div class="arch-viz-container animate-in delay-2">
                    <!-- Visualization Controls -->
                    <div class="arch-viz-header">
                        <div class="arch-viz-tabs">
                            <button class="arch-viz-tab active" onclick="switchArchView('pipeline')" data-view="pipeline">
                                <span class="tab-icon">üîÑ</span> Pipeline Flow
                            </button>
                            <button class="arch-viz-tab" onclick="switchArchView('grid')" data-view="grid">
                                <span class="tab-icon">üé¥</span> Component Grid
                            </button>
                        </div>
                        <div class="arch-viz-controls">
                            <button class="arch-ctrl-btn" onclick="replayArchAnimation()" title="Replay animation">
                                <span>‚ñ∂Ô∏è</span> Replay
                            </button>
                            <button class="arch-ctrl-btn" onclick="toggleArchFullscreen()" title="Fullscreen" id="archFullscreenBtn">
                                <span>‚õ∂</span> Fullscreen
                            </button>
                            <button class="arch-ctrl-btn" onclick="exportArchDiagram()" title="Export as PNG">
                                <span>üì•</span> Export
                            </button>
                        </div>
                    </div>

                    <!-- Architecture Visualization Content -->
                    <div class="arch-viz-content" id="archVizContent">
                        
                        <!-- ========== OPTION 1: HORIZONTAL PIPELINE FLOW ========== -->
                        <div class="arch-view pipeline-view active" id="pipelineView">
                            <!-- Main Pipeline -->
                            <div class="pipeline-main">
                                <!-- Data Flow Line -->
                                <div class="pipeline-flow-line">
                                    <div class="flow-particle p1"></div>
                                    <div class="flow-particle p2"></div>
                                    <div class="flow-particle p3"></div>
                                    <div class="flow-particle p4"></div>
                                    <div class="flow-particle p5"></div>
                                </div>

                                <!-- Stage 1: Data Collection -->
                                <div class="pipeline-stage" data-stage="data" style="--stage-color: #2196f3; --stage-delay: 0s;">
                                    <div class="stage-node">
                                        <div class="stage-icon-wrap">
                                            <span class="stage-icon">üìä</span>
                                            <div class="stage-pulse"></div>
                                        </div>
                                        <div class="stage-label">Data Collection</div>
                                    </div>
                                    <div class="stage-connector">
                                        <svg viewBox="0 0 60 20"><path d="M0,10 L50,10" class="connector-line"/><polygon points="50,5 60,10 50,15" class="connector-arrow"/></svg>
                                    </div>
                                    <div class="stage-details">
                                        <div class="detail-item" style="--item-delay: 0.1s;">
                                            <span class="detail-icon">üì•</span>
                                            <div class="detail-text">
                                                <strong>Bosch Dataset</strong>
                                                <span>1.18M samples, 968 features</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.2s;">
                                            <span class="detail-icon">üîÑ</span>
                                            <div class="detail-text">
                                                <strong>Preprocessing</strong>
                                                <span>StandardScaler, imputation</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.3s;">
                                            <span class="detail-icon">‚úÇÔ∏è</span>
                                            <div class="detail-text">
                                                <strong>Partitioning</strong>
                                                <span>Dirichlet(Œ±) ‚Üí 5 facilities</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.4s;">
                                            <span class="detail-icon">üìÅ</span>
                                            <div class="detail-text">
                                                <strong>Validation Sets</strong>
                                                <span>NASA C-MAPSS, UCI SECOM</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Stage 2: Knowledge Graph -->
                                <div class="pipeline-stage" data-stage="kg" style="--stage-color: #9c27b0; --stage-delay: 0.3s;">
                                    <div class="stage-node">
                                        <div class="stage-icon-wrap">
                                            <span class="stage-icon">üï∏Ô∏è</span>
                                            <div class="stage-pulse"></div>
                                        </div>
                                        <div class="stage-label">Knowledge Graph</div>
                                    </div>
                                    <div class="stage-connector">
                                        <svg viewBox="0 0 60 20"><path d="M0,10 L50,10" class="connector-line"/><polygon points="50,5 60,10 50,15" class="connector-arrow"/></svg>
                                    </div>
                                    <div class="stage-details">
                                        <div class="detail-item" style="--item-delay: 0.1s;">
                                            <span class="detail-icon">üìö</span>
                                            <div class="detail-text">
                                                <strong>Ontologies</strong>
                                                <span>ISA-95, MASON, NIST, Schema.org</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.2s;">
                                            <span class="detail-icon">üîß</span>
                                            <div class="detail-text">
                                                <strong>rdflib + owlready2</strong>
                                                <span>OWL/RDF parsing & reasoning</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.3s;">
                                            <span class="detail-icon">üîç</span>
                                            <div class="detail-text">
                                                <strong>SPARQL Queries</strong>
                                                <span>Constraint extraction</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.4s;">
                                            <span class="detail-icon">üß†</span>
                                            <div class="detail-text">
                                                <strong>HermiT Reasoner</strong>
                                                <span>OWL inference engine</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Stage 3: Constraints -->
                                <div class="pipeline-stage" data-stage="constraints" style="--stage-color: #ff9800; --stage-delay: 0.6s;">
                                    <div class="stage-node">
                                        <div class="stage-icon-wrap">
                                            <span class="stage-icon">üìã</span>
                                            <div class="stage-pulse"></div>
                                        </div>
                                        <div class="stage-label">Constraints</div>
                                    </div>
                                    <div class="stage-connector">
                                        <svg viewBox="0 0 60 20"><path d="M0,10 L50,10" class="connector-line"/><polygon points="50,5 60,10 50,15" class="connector-arrow"/></svg>
                                    </div>
                                    <div class="stage-details">
                                        <div class="detail-item" style="--item-delay: 0.1s;">
                                            <span class="detail-icon">‚è±Ô∏è</span>
                                            <div class="detail-text">
                                                <strong>Temporal</strong>
                                                <span>‚àÇ(wear)/‚àÇt ‚â• 0 monotonicity</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.2s;">
                                            <span class="detail-icon">üîó</span>
                                            <div class="detail-text">
                                                <strong>Causal</strong>
                                                <span>Failure precedence ordering</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.3s;">
                                            <span class="detail-icon">üìä</span>
                                            <div class="detail-text">
                                                <strong>Capacity</strong>
                                                <span>T ‚àà [T_min, T_max] bounds</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.4s;">
                                            <span class="detail-icon">‚öõÔ∏è</span>
                                            <div class="detail-text">
                                                <strong>Physical</strong>
                                                <span>Œ£E_in = Œ£E_out conservation</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Stage 4: Federated Learning -->
                                <div class="pipeline-stage" data-stage="fl" style="--stage-color: #4caf50; --stage-delay: 0.9s;">
                                    <div class="stage-node">
                                        <div class="stage-icon-wrap">
                                            <span class="stage-icon">üåê</span>
                                            <div class="stage-pulse"></div>
                                        </div>
                                        <div class="stage-label">Federated Learning</div>
                                    </div>
                                    <div class="stage-connector">
                                        <svg viewBox="0 0 60 20"><path d="M0,10 L50,10" class="connector-line"/><polygon points="50,5 60,10 50,15" class="connector-arrow"/></svg>
                                    </div>
                                    <div class="stage-details">
                                        <div class="detail-item" style="--item-delay: 0.1s;">
                                            <span class="detail-icon">üå∏</span>
                                            <div class="detail-text">
                                                <strong>Flower Framework</strong>
                                                <span>FL orchestration v1.5+</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.2s;">
                                            <span class="detail-icon">üî•</span>
                                            <div class="detail-text">
                                                <strong>PyTorch</strong>
                                                <span>Neural network backend</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.3s;">
                                            <span class="detail-icon">üè≠</span>
                                            <div class="detail-text">
                                                <strong>5 Virtual Facilities</strong>
                                                <span>Non-IID simulation</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.4s;">
                                            <span class="detail-icon">üîÑ</span>
                                            <div class="detail-text">
                                                <strong>FedAvg + SCFA</strong>
                                                <span>Constrained aggregation</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Stage 5: Privacy -->
                                <div class="pipeline-stage" data-stage="privacy" style="--stage-color: #e91e63; --stage-delay: 1.2s;">
                                    <div class="stage-node">
                                        <div class="stage-icon-wrap">
                                            <span class="stage-icon">üîí</span>
                                            <div class="stage-pulse"></div>
                                        </div>
                                        <div class="stage-label">Privacy</div>
                                    </div>
                                    <div class="stage-connector">
                                        <svg viewBox="0 0 60 20"><path d="M0,10 L50,10" class="connector-line"/><polygon points="50,5 60,10 50,15" class="connector-arrow"/></svg>
                                    </div>
                                    <div class="stage-details">
                                        <div class="detail-item" style="--item-delay: 0.1s;">
                                            <span class="detail-icon">üõ°Ô∏è</span>
                                            <div class="detail-text">
                                                <strong>Opacus</strong>
                                                <span>DP-SGD implementation</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.2s;">
                                            <span class="detail-icon">üìâ</span>
                                            <div class="detail-text">
                                                <strong>Œµ-Differential Privacy</strong>
                                                <span>GDPR compliant: Œµ=10</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.3s;">
                                            <span class="detail-icon">üé≤</span>
                                            <div class="detail-text">
                                                <strong>Gaussian Noise</strong>
                                                <span>œÉ¬≤ calibrated injection</span>
                                            </div>
                                        </div>
                                        <div class="detail-item" style="--item-delay: 0.4s;">
                                            <span class="detail-icon">üìê</span>
                                            <div class="detail-text">
                                                <strong>Œ∏ = 0.37</strong>
                                                <span>63% noise space reduction</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Final Output: SCFA -->
                                <div class="pipeline-output" style="--stage-delay: 1.5s;">
                                    <div class="output-node">
                                        <div class="output-icon-wrap">
                                            <span class="output-icon">üéØ</span>
                                            <div class="output-ring"></div>
                                            <div class="output-ring r2"></div>
                                        </div>
                                        <div class="output-label">SCFA</div>
                                        <div class="output-subtitle">Semantic-Constrained<br>Federated Aggregation</div>
                                    </div>
                                    <div class="output-metrics">
                                        <div class="metric-item">
                                            <span class="metric-value">22%</span>
                                            <span class="metric-label">Faster</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-value">2.7√ó</span>
                                            <span class="metric-label">Privacy</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-value">R¬≤>.90</span>
                                            <span class="metric-label">Validated</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Evaluation Bar (Bottom) -->
                            <div class="pipeline-eval-bar">
                                <div class="eval-header">
                                    <span class="eval-icon">üìà</span>
                                    <span class="eval-title">Evaluation & Monitoring</span>
                                </div>
                                <div class="eval-items">
                                    <div class="eval-item" style="--eval-delay: 0.1s;">
                                        <span class="eval-item-icon">üìä</span>
                                        <span>Weights & Biases</span>
                                        <span class="eval-badge">Tracking</span>
                                    </div>
                                    <div class="eval-item" style="--eval-delay: 0.2s;">
                                        <span class="eval-item-icon">‚úÖ</span>
                                        <span>pytest</span>
                                        <span class="eval-badge">Testing</span>
                                    </div>
                                    <div class="eval-item" style="--eval-delay: 0.3s;">
                                        <span class="eval-item-icon">üê≥</span>
                                        <span>Docker</span>
                                        <span class="eval-badge">Deploy</span>
                                    </div>
                                    <div class="eval-item" style="--eval-delay: 0.4s;">
                                        <span class="eval-item-icon">üì¶</span>
                                        <span>Conda</span>
                                        <span class="eval-badge">Env</span>
                                    </div>
                                    <div class="eval-item" style="--eval-delay: 0.5s;">
                                        <span class="eval-item-icon">üî¨</span>
                                        <span>NASA/UCI</span>
                                        <span class="eval-badge">Validation</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ========== OPTION 4: INTERACTIVE CARD GRID ========== -->
                        <div class="arch-view grid-view" id="gridView">
                            <div class="grid-container">
                                <!-- Row 1: Input Components -->
                                <div class="grid-row">
                                    <div class="grid-card" data-card="data" style="--card-color: #2196f3; --card-delay: 0s;">
                                        <div class="card-header">
                                            <span class="card-icon">üìä</span>
                                            <span class="card-title">Data Collection</span>
                                            <button class="card-expand-btn" onclick="toggleGridCard(this)">‚ñº</button>
                                        </div>
                                        <div class="card-preview">
                                            <span class="preview-stat">1.18M</span> samples
                                        </div>
                                        <div class="card-details">
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üì•</span>
                                                    <span class="cdi-title">Bosch Production Dataset</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>kaggle competitions download -c bosch-production-line-performance</code>
                                                    <div class="cdi-stats">
                                                        <span>968 features</span>
                                                        <span>750 MB</span>
                                                        <span>CSV format</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üîÑ</span>
                                                    <span class="cdi-title">Preprocessing Pipeline</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>StandardScaler().fit_transform(X)</code>
                                                    <div class="cdi-stats">
                                                        <span>Imputation</span>
                                                        <span>Normalization</span>
                                                        <span>70/15/15 split</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">‚úÇÔ∏è</span>
                                                    <span class="cdi-title">Dirichlet Partitioning</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>np.random.dirichlet([Œ±]*K)</code>
                                                    <div class="cdi-stats">
                                                        <span>Œ± ‚àà {0.1, 1.0, 10}</span>
                                                        <span>K=5 facilities</span>
                                                        <span>Non-IID</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="grid-card" data-card="kg" style="--card-color: #9c27b0; --card-delay: 0.1s;">
                                        <div class="card-header">
                                            <span class="card-icon">üï∏Ô∏è</span>
                                            <span class="card-title">Knowledge Graph</span>
                                            <button class="card-expand-btn" onclick="toggleGridCard(this)">‚ñº</button>
                                        </div>
                                        <div class="card-preview">
                                            <span class="preview-stat">4</span> ontologies merged
                                        </div>
                                        <div class="card-details">
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üìö</span>
                                                    <span class="cdi-title">Ontology Sources</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>graph.parse(ontology, format='xml')</code>
                                                    <div class="cdi-stats">
                                                        <span>ISA-95</span>
                                                        <span>MASON</span>
                                                        <span>NIST AM</span>
                                                        <span>Schema.org</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üîß</span>
                                                    <span class="cdi-title">Libraries</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>from rdflib import Graph; from owlready2 import *</code>
                                                    <div class="cdi-stats">
                                                        <span>rdflib 7.0+</span>
                                                        <span>owlready2 0.45+</span>
                                                        <span>SPARQLWrapper</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üß†</span>
                                                    <span class="cdi-title">OWL Reasoning</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>sync_reasoner(world, infer_property_values=True)</code>
                                                    <div class="cdi-stats">
                                                        <span>HermiT</span>
                                                        <span>Pellet</span>
                                                        <span>Inference</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="grid-card" data-card="constraints" style="--card-color: #ff9800; --card-delay: 0.2s;">
                                        <div class="card-header">
                                            <span class="card-icon">üìã</span>
                                            <span class="card-title">Semantic Constraints</span>
                                            <button class="card-expand-btn" onclick="toggleGridCard(this)">‚ñº</button>
                                        </div>
                                        <div class="card-preview">
                                            <span class="preview-stat">3,000+</span> rules
                                        </div>
                                        <div class="card-details">
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">‚è±Ô∏è</span>
                                                    <span class="cdi-title">Temporal Constraints</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>assert ‚àÇ(tool_wear)/‚àÇt ‚â• 0</code>
                                                    <div class="cdi-stats">
                                                        <span>Monotonicity</span>
                                                        <span>Time series</span>
                                                        <span>Degradation</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üîó</span>
                                                    <span class="cdi-title">Causal Constraints</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>vibration_anomaly ‚Üí bearing_wear ‚Üí failure</code>
                                                    <div class="cdi-stats">
                                                        <span>Precedence</span>
                                                        <span>DAG structure</span>
                                                        <span>Failure chains</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üìä</span>
                                                    <span class="cdi-title">Capacity & Physical</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>T ‚àà [T_min, T_max]; Œ£E_in = Œ£E_out</code>
                                                    <div class="cdi-stats">
                                                        <span>Bounds</span>
                                                        <span>Conservation</span>
                                                        <span>Physics laws</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 2: Processing Components -->
                                <div class="grid-row">
                                    <div class="grid-card" data-card="fl" style="--card-color: #4caf50; --card-delay: 0.3s;">
                                        <div class="card-header">
                                            <span class="card-icon">üåê</span>
                                            <span class="card-title">Federated Learning</span>
                                            <button class="card-expand-btn" onclick="toggleGridCard(this)">‚ñº</button>
                                        </div>
                                        <div class="card-preview">
                                            <span class="preview-stat">5</span> facilities
                                        </div>
                                        <div class="card-details">
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üå∏</span>
                                                    <span class="cdi-title">Flower Framework</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>fl.client.start_numpy_client(server_address, client)</code>
                                                    <div class="cdi-stats">
                                                        <span>v1.5+</span>
                                                        <span>gRPC</span>
                                                        <span>Strategies</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üî•</span>
                                                    <span class="cdi-title">PyTorch Backend</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>model = ToolWearPredictor(input_dim=968)</code>
                                                    <div class="cdi-stats">
                                                        <span>v2.0+</span>
                                                        <span>CUDA support</span>
                                                        <span>16 MB model</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üîÑ</span>
                                                    <span class="cdi-title">SCFA Aggregation</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>w_global = Œ£(p_k ¬∑ Œ†_C(w_k))</code>
                                                    <div class="cdi-stats">
                                                        <span>Projection</span>
                                                        <span>Weighted avg</span>
                                                        <span>32 rounds</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="grid-card" data-card="privacy" style="--card-color: #e91e63; --card-delay: 0.4s;">
                                        <div class="card-header">
                                            <span class="card-icon">üîí</span>
                                            <span class="card-title">Privacy & Security</span>
                                            <button class="card-expand-btn" onclick="toggleGridCard(this)">‚ñº</button>
                                        </div>
                                        <div class="card-preview">
                                            <span class="preview-stat">Œµ=10</span> GDPR
                                        </div>
                                        <div class="card-details">
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üõ°Ô∏è</span>
                                                    <span class="cdi-title">Opacus DP-SGD</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>privacy_engine = PrivacyEngine(); privacy_engine.attach(optimizer)</code>
                                                    <div class="cdi-stats">
                                                        <span>v1.4+</span>
                                                        <span>Per-sample grads</span>
                                                        <span>Clipping</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üìê</span>
                                                    <span class="cdi-title">Noise Calibration</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>œÉ¬≤_SCFA = Œ∏ ¬∑ œÉ¬≤_FedAvg where Œ∏ = 0.37</code>
                                                    <div class="cdi-stats">
                                                        <span>63% reduction</span>
                                                        <span>Gaussian</span>
                                                        <span>Theorem 2</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üìä</span>
                                                    <span class="cdi-title">Privacy-Utility</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>3.7% loss (SCFA) vs 12.1% loss (FedAvg) @ Œµ=10</code>
                                                    <div class="cdi-stats">
                                                        <span>2.7√ó better</span>
                                                        <span>GDPR compliant</span>
                                                        <span>Validated</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="grid-card" data-card="eval" style="--card-color: #009688; --card-delay: 0.5s;">
                                        <div class="card-header">
                                            <span class="card-icon">üìà</span>
                                            <span class="card-title">Evaluation</span>
                                            <button class="card-expand-btn" onclick="toggleGridCard(this)">‚ñº</button>
                                        </div>
                                        <div class="card-preview">
                                            <span class="preview-stat">R¬≤>.90</span> all theorems
                                        </div>
                                        <div class="card-details">
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üìä</span>
                                                    <span class="cdi-title">Experiment Tracking</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>wandb.init(project="scfa"); wandb.log(metrics)</code>
                                                    <div class="cdi-stats">
                                                        <span>W&B v0.15+</span>
                                                        <span>MLflow</span>
                                                        <span>TensorBoard</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">üî¨</span>
                                                    <span class="cdi-title">Validation Datasets</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>NASA C-MAPSS, UCI SECOM, UCI Steel, AI4I</code>
                                                    <div class="cdi-stats">
                                                        <span>4 datasets</span>
                                                        <span>Cross-domain</span>
                                                        <span>Generalization</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-detail-item">
                                                <div class="cdi-header">
                                                    <span class="cdi-icon">‚úÖ</span>
                                                    <span class="cdi-title">Testing & Deploy</span>
                                                </div>
                                                <div class="cdi-content">
                                                    <code>pytest tests/ && docker build -t scfa .</code>
                                                    <div class="cdi-stats">
                                                        <span>pytest 7.4+</span>
                                                        <span>Docker 24+</span>
                                                        <span>CI/CD</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Output Row -->
                                <div class="grid-output-row">
                                    <div class="grid-flow-arrows">
                                        <svg viewBox="0 0 100 40" preserveAspectRatio="none">
                                            <defs>
                                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                                    <polygon points="0 0, 10 3.5, 0 7" fill="var(--purple)"/>
                                                </marker>
                                            </defs>
                                            <path d="M10,5 Q50,5 50,35" stroke="var(--purple)" stroke-width="2" fill="none" marker-end="url(#arrowhead)" class="flow-arrow fa1"/>
                                            <path d="M50,5 L50,35" stroke="var(--purple)" stroke-width="2" fill="none" marker-end="url(#arrowhead)" class="flow-arrow fa2"/>
                                            <path d="M90,5 Q50,5 50,35" stroke="var(--purple)" stroke-width="2" fill="none" marker-end="url(#arrowhead)" class="flow-arrow fa3"/>
                                        </svg>
                                    </div>
                                    <div class="grid-output-card">
                                        <div class="goc-icon">üéØ</div>
                                        <div class="goc-content">
                                            <div class="goc-title">SCFA Output</div>
                                            <div class="goc-subtitle">Semantic-Constrained Federated Aggregation</div>
                                            <div class="goc-metrics">
                                                <div class="goc-metric">
                                                    <span class="goc-metric-value">22%</span>
                                                    <span class="goc-metric-label">Faster Convergence</span>
                                                </div>
                                                <div class="goc-metric">
                                                    <span class="goc-metric-value">2.7√ó</span>
                                                    <span class="goc-metric-label">Better Privacy</span>
                                                </div>
                                                <div class="goc-metric">
                                                    <span class="goc-metric-value">18%</span>
                                                    <span class="goc-metric-label">Critical Threshold</span>
                                                </div>
                                                <div class="goc-metric">
                                                    <span class="goc-metric-value">87ms</span>
                                                    <span class="goc-metric-label">Inference Time</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- GitHub CTA -->
                    <div class="arch-github-cta">
                        <div class="github-icon-wrap">
                            <svg viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
                                <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                            </svg>
                        </div>
                        <div class="github-cta-text">
                            <span class="github-cta-label">Full Implementation</span>
                            <a href="https://github.com/jahidul-arafat/Semantic-Constrained-Federated-Aggregation" target="_blank" class="github-cta-link">
                                github.com/jahidul-arafat/Semantic-Constrained-Federated-Aggregation
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Implementation Tabs -->
                <div class="impl-tabs animate-in delay-2">
                    <button class="impl-tab active" onclick="showImplTab('simulation')">üè≠ Facility Simulation</button>
                    <button class="impl-tab" onclick="showImplTab('data')">üìä Data Collection</button>
                    <button class="impl-tab" onclick="showImplTab('kg')">üï∏Ô∏è Knowledge Graph</button>
                    <button class="impl-tab" onclick="showImplTab('stack')">üõ†Ô∏è Tech Stack</button>
                </div>

                <!-- Tab Content: Facility Simulation -->
                <div id="impl-simulation" class="impl-content active animate-in delay-2">
                    <h3>Virtual Facility Simulation</h3>
                    <p class="impl-desc">We simulated 5 geographically distributed manufacturing facilities using comprehensive Python programming:</p>
                    
                    <div class="code-architecture">
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <span class="code-file">src/simulation/facility_simulator.py</span>
                            </div>
                            <pre class="code-content"><code><span class="kw">class</span> <span class="cls">FederatedFacilitySimulator</span>:
    <span class="str">"""Simulates non-IID data across K facilities"""</span>
    
    <span class="kw">def</span> <span class="fn">__init__</span>(self, num_facilities=<span class="num">5</span>, alpha=<span class="num">1.0</span>):
        self.partitioner = <span class="cls">DirichletPartitioner</span>(alpha)
        self.facilities = self._create_facilities()
    
    <span class="kw">def</span> <span class="fn">partition_data</span>(self, X, y):
        <span class="str">"""Partition using Dirichlet distribution"""</span>
        <span class="cmt"># Œ± controls heterogeneity:</span>
        <span class="cmt"># Œ±‚Üí‚àû: IID, Œ±‚Üí0: extreme non-IID</span>
        proportions = np.random.dirichlet(
            [self.alpha] * self.num_facilities
        )
        <span class="kw">return</span> self._split_by_proportions(X, y, proportions)
    
    <span class="kw">def</span> <span class="fn">simulate_local_training</span>(self, facility_id, epochs):
        <span class="str">"""Train local model with Flower framework"""</span>
        client = <span class="cls">FlowerClient</span>(
            model=self.model,
            trainloader=self.facilities[facility_id].data,
            constraint_validator=self.validator
        )
        <span class="kw">return</span> client.fit(epochs)</code></pre>
                        </div>
                        
                        <div class="simulation-diagram">
                            <div class="sim-header">Dirichlet Partitioning (Œ± = 1.0)</div>
                            <div class="facility-bars">
                                <div class="fac-bar" style="--width: 40%; --color: #2196f3;">
                                    <span class="fac-label">F1</span>
                                    <span class="fac-size">470K</span>
                                </div>
                                <div class="fac-bar" style="--width: 10%; --color: #4caf50;">
                                    <span class="fac-label">F2</span>
                                    <span class="fac-size">120K</span>
                                </div>
                                <div class="fac-bar" style="--width: 28%; --color: #ff9800;">
                                    <span class="fac-label">F3</span>
                                    <span class="fac-size">330K</span>
                                </div>
                                <div class="fac-bar" style="--width: 8%; --color: #9c27b0;">
                                    <span class="fac-label">F4</span>
                                    <span class="fac-size">95K</span>
                                </div>
                                <div class="fac-bar" style="--width: 14%; --color: #009688;">
                                    <span class="fac-label">F5</span>
                                    <span class="fac-size">165K</span>
                                </div>
                            </div>
                            <div class="sim-note">Non-IID distribution simulates real-world facility heterogeneity</div>
                        </div>
                    </div>

                    <div class="impl-libs">
                        <span class="lib-tag"><img src="https://img.shields.io/badge/Flower-FF6B6B?style=flat&logo=flower&logoColor=white" alt="Flower"></span>
                        <span class="lib-tag"><img src="https://img.shields.io/badge/PyTorch-EE4C2C?style=flat&logo=pytorch&logoColor=white" alt="PyTorch"></span>
                        <span class="lib-tag"><img src="https://img.shields.io/badge/NumPy-013243?style=flat&logo=numpy&logoColor=white" alt="NumPy"></span>
                        <span class="lib-tag"><img src="https://img.shields.io/badge/Scikit--Learn-F7931E?style=flat&logo=scikit-learn&logoColor=white" alt="Scikit-Learn"></span>
                    </div>
                </div>

                <!-- Tab Content: Data Collection -->
                <div id="impl-data" class="impl-content">
                    <h3>Data Collection Pipeline</h3>
                    <p class="impl-desc">Automated multi-source data acquisition with validation and preprocessing:</p>
                    
                    <div class="data-pipeline">
                        <div class="pipeline-stage">
                            <div class="stage-icon">üì•</div>
                            <div class="stage-name">Download</div>
                            <div class="stage-detail">
                                <code>download_all_data.sh</code>
                                <ul>
                                    <li>URL verification (curl/wget)</li>
                                    <li>Git repo validation</li>
                                    <li>Interactive prompts</li>
                                    <li>Color-coded logging</li>
                                </ul>
                            </div>
                        </div>
                        <div class="pipeline-arrow">‚Üí</div>
                        <div class="pipeline-stage">
                            <div class="stage-icon">üîÑ</div>
                            <div class="stage-name">Transform</div>
                            <div class="stage-detail">
                                <code>preprocess.py</code>
                                <ul>
                                    <li>Feature engineering</li>
                                    <li>Missing value imputation</li>
                                    <li>Normalization (StandardScaler)</li>
                                    <li>Train/Val/Test split</li>
                                </ul>
                            </div>
                        </div>
                        <div class="pipeline-arrow">‚Üí</div>
                        <div class="pipeline-stage">
                            <div class="stage-icon">‚úÖ</div>
                            <div class="stage-name">Validate</div>
                            <div class="stage-detail">
                                <code>validate_data.py</code>
                                <ul>
                                    <li>Schema validation</li>
                                    <li>Distribution checks</li>
                                    <li>Anomaly detection</li>
                                    <li>Quality metrics</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="data-sources-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Source</th>
                                    <th>Type</th>
                                    <th>Size</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Bosch Production</strong></td>
                                    <td>Kaggle CSV</td>
                                    <td>~750 MB</td>
                                    <td>Primary training data</td>
                                </tr>
                                <tr>
                                    <td><strong>ISA-95 (Microsoft)</strong></td>
                                    <td>Git Clone</td>
                                    <td>~5 MB</td>
                                    <td>Manufacturing ontology</td>
                                </tr>
                                <tr>
                                    <td><strong>MASON</strong></td>
                                    <td>OWL Download</td>
                                    <td>~2 MB</td>
                                    <td>Equipment causality</td>
                                </tr>
                                <tr>
                                    <td><strong>NIST AM</strong></td>
                                    <td>Git Clone</td>
                                    <td>~500 KB</td>
                                    <td>Additive manufacturing</td>
                                </tr>
                                <tr>
                                    <td><strong>Schema.org</strong></td>
                                    <td>RDF Download</td>
                                    <td>~5 MB</td>
                                    <td>Product vocabulary</td>
                                </tr>
                                <tr>
                                    <td><strong>NASA C-MAPSS</strong></td>
                                    <td>ZIP Archive</td>
                                    <td>~100 MB</td>
                                    <td>Validation dataset</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Tab Content: Knowledge Graph -->
                <div id="impl-kg" class="impl-content">
                    <h3>Knowledge Graph Construction</h3>
                    <p class="impl-desc">OWL/RDF ontology parsing with SPARQL-based constraint extraction:</p>
                    
                    <div class="code-architecture">
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Python</span>
                                <span class="code-file">src/knowledge/ontology_parser.py</span>
                            </div>
                            <pre class="code-content"><code><span class="kw">from</span> rdflib <span class="kw">import</span> Graph, Namespace, RDF, RDFS, OWL
<span class="kw">from</span> owlready2 <span class="kw">import</span> get_ontology, sync_reasoner

<span class="kw">class</span> <span class="cls">ManufacturingOntologyParser</span>:
    <span class="str">"""Parse & merge ISA-95, MASON, NIST, Schema.org"""</span>
    
    <span class="kw">def</span> <span class="fn">__init__</span>(self):
        self.graph = <span class="cls">Graph</span>()
        self.namespaces = {
            <span class="str">'isa95'</span>: Namespace(<span class="str">'http://isa95.org/'</span>),
            <span class="str">'mason'</span>: Namespace(<span class="str">'http://mason-onto.org/'</span>),
            <span class="str">'nist'</span>: Namespace(<span class="str">'http://nist.gov/am/'</span>)
        }
    
    <span class="kw">def</span> <span class="fn">load_ontologies</span>(self, paths: List[str]):
        <span class="kw">for</span> path <span class="kw">in</span> paths:
            self.graph.parse(path, format=<span class="str">'xml'</span>)
        <span class="cmt"># Run OWL reasoner for inference</span>
        sync_reasoner(self.graph)
    
    <span class="kw">def</span> <span class="fn">extract_constraints</span>(self) -> List[<span class="cls">Constraint</span>]:
        <span class="str">"""Extract semantic constraints via SPARQL"""</span>
        constraints = []
        
        <span class="cmt"># Temporal constraints (monotonicity)</span>
        temporal_query = <span class="str">"""
        SELECT ?prop ?class WHERE {
            ?prop rdfs:domain ?class ;
                  :hasTemporalBehavior :Monotonic .
        }"""</span>
        
        <span class="cmt"># Causal constraints (precedence)</span>
        causal_query = <span class="str">"""
        SELECT ?cause ?effect WHERE {
            ?cause :leadsto ?effect ;
                   rdf:type :FailureMode .
        }"""</span>
        
        <span class="kw">return</span> self._execute_queries([
            temporal_query, causal_query, ...
        ])</code></pre>
                        </div>

                        <div class="kg-construction-flow">
                            <div class="kg-step">
                                <div class="kg-step-num">1</div>
                                <div class="kg-step-name">Parse OWL/RDF</div>
                                <div class="kg-step-lib">rdflib, owlready2</div>
                            </div>
                            <div class="kg-step-arrow">‚Üí</div>
                            <div class="kg-step">
                                <div class="kg-step-num">2</div>
                                <div class="kg-step-name">Merge Ontologies</div>
                                <div class="kg-step-lib">Namespace alignment</div>
                            </div>
                            <div class="kg-step-arrow">‚Üí</div>
                            <div class="kg-step">
                                <div class="kg-step-num">3</div>
                                <div class="kg-step-name">Run Reasoner</div>
                                <div class="kg-step-lib">HermiT / Pellet</div>
                            </div>
                            <div class="kg-step-arrow">‚Üí</div>
                            <div class="kg-step">
                                <div class="kg-step-num">4</div>
                                <div class="kg-step-name">SPARQL Extract</div>
                                <div class="kg-step-lib">Constraint rules</div>
                            </div>
                        </div>
                    </div>

                    <div class="constraint-types-impl">
                        <div class="constraint-impl-card">
                            <div class="cic-header temporal">‚è±Ô∏è Temporal</div>
                            <code>TemporalConstraintValidator.validate()</code>
                            <p>Checks monotonic properties: ‚àÇ(wear)/‚àÇt ‚â• 0</p>
                        </div>
                        <div class="constraint-impl-card">
                            <div class="cic-header causal">üîó Causal</div>
                            <code>CausalConstraintValidator.validate()</code>
                            <p>Validates precedence ordering in failure chains</p>
                        </div>
                        <div class="constraint-impl-card">
                            <div class="cic-header capacity">üìä Capacity</div>
                            <code>CapacityConstraintValidator.validate()</code>
                            <p>Enforces T ‚àà [T_min, T_max] bounds</p>
                        </div>
                        <div class="constraint-impl-card">
                            <div class="cic-header physical">‚öõÔ∏è Physical</div>
                            <code>PhysicalConstraintValidator.validate()</code>
                            <p>Ensures Œ£E_in = Œ£E_out conservation</p>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Tech Stack -->
                <div id="impl-stack" class="impl-content">
                    <h3>Technology Stack</h3>
                    <p class="impl-desc">Production-ready implementation with modern ML/FL frameworks:</p>
                    
                    <div class="tech-stack-grid">
                        <div class="stack-category">
                            <h4>üß† ML / Federated Learning</h4>
                            <div class="stack-items">
                                <div class="stack-item">
                                    <span class="stack-name">Flower (flwr)</span>
                                    <span class="stack-version">1.5+</span>
                                    <span class="stack-use">FL orchestration</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">PyTorch</span>
                                    <span class="stack-version">2.0+</span>
                                    <span class="stack-use">Neural networks</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">Scikit-learn</span>
                                    <span class="stack-version">1.3+</span>
                                    <span class="stack-use">Preprocessing</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">Opacus</span>
                                    <span class="stack-version">1.4+</span>
                                    <span class="stack-use">Differential privacy</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stack-category">
                            <h4>üï∏Ô∏è Knowledge Graph</h4>
                            <div class="stack-items">
                                <div class="stack-item">
                                    <span class="stack-name">rdflib</span>
                                    <span class="stack-version">7.0+</span>
                                    <span class="stack-use">RDF/OWL parsing</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">owlready2</span>
                                    <span class="stack-version">0.45+</span>
                                    <span class="stack-use">OWL reasoning</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">SPARQLWrapper</span>
                                    <span class="stack-version">2.0+</span>
                                    <span class="stack-use">Query execution</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">NetworkX</span>
                                    <span class="stack-version">3.0+</span>
                                    <span class="stack-use">Graph analysis</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stack-category">
                            <h4>üìä Data & Analysis</h4>
                            <div class="stack-items">
                                <div class="stack-item">
                                    <span class="stack-name">Pandas</span>
                                    <span class="stack-version">2.0+</span>
                                    <span class="stack-use">Data manipulation</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">NumPy</span>
                                    <span class="stack-version">1.24+</span>
                                    <span class="stack-use">Numerical ops</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">SciPy</span>
                                    <span class="stack-version">1.11+</span>
                                    <span class="stack-use">Statistical analysis</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">Matplotlib/Seaborn</span>
                                    <span class="stack-version">3.7+</span>
                                    <span class="stack-use">Visualization</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stack-category">
                            <h4>üõ†Ô∏è Infrastructure</h4>
                            <div class="stack-items">
                                <div class="stack-item">
                                    <span class="stack-name">Docker</span>
                                    <span class="stack-version">24+</span>
                                    <span class="stack-use">Containerization</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">Conda</span>
                                    <span class="stack-version">23+</span>
                                    <span class="stack-use">Environment mgmt</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">pytest</span>
                                    <span class="stack-version">7.4+</span>
                                    <span class="stack-use">Testing framework</span>
                                </div>
                                <div class="stack-item">
                                    <span class="stack-name">Weights & Biases</span>
                                    <span class="stack-version">0.15+</span>
                                    <span class="stack-use">Experiment tracking</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GitHub Link -->
                <div class="github-cta animate-in delay-3">
                    <div class="github-icon">
                        <svg viewBox="0 0 24 24" width="40" height="40" fill="currentColor">
                            <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                        </svg>
                    </div>
                    <div class="github-text">
                        <div class="github-label">Full Implementation Available</div>
                        <a href="https://github.com/jahidul-arafat/Semantic-Constrained-Federated-Aggregation" target="_blank" class="github-link">
                            github.com/jahidul-arafat/Semantic-Constrained-Federated-Aggregation
                        </a>
                    </div>
                    <div class="github-badges">
                        <img src="https://img.shields.io/badge/Python-3.10+-blue?logo=python" alt="Python">
                        <img src="https://img.shields.io/badge/License-MIT-green" alt="MIT License">
                        <img src="https://img.shields.io/badge/PRs-Welcome-brightgreen" alt="PRs Welcome">
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 20: GENERALIZATION ==================== -->
        <section class="scene" data-scene="27" data-title="Beyond Manufacturing">
            <div class="scene-content">
                <div class="chapter-badge purple">The Bigger Picture</div>
                <h2 class="scene-title animate-in">Beyond Manufacturing</h2>
                <p class="scene-subtitle animate-in delay-1">The SCFA framework generalizes to any domain with structured knowledge</p>
                
                <div class="domains-grid animate-in delay-2">
                    <div class="domain-card" data-delay="0">
                        <div class="domain-icon">üè•</div>
                        <div class="domain-name">Healthcare</div>
                        <div class="domain-constraints">
                            <span>SNOMED-CT / ICD-10</span>
                            <span>Treatment protocols</span>
                            <span>Drug interactions</span>
                        </div>
                    </div>
                    <div class="domain-card" data-delay="200">
                        <div class="domain-icon">üè¶</div>
                        <div class="domain-name">Finance</div>
                        <div class="domain-constraints">
                            <span>Basel III rules</span>
                            <span>Risk constraints</span>
                            <span>Compliance reqs</span>
                        </div>
                    </div>
                    <div class="domain-card" data-delay="400">
                        <div class="domain-icon">üöó</div>
                        <div class="domain-name">Autonomous Systems</div>
                        <div class="domain-constraints">
                            <span>ISO 26262</span>
                            <span>DO-178C</span>
                            <span>Safety specs</span>
                        </div>
                    </div>
                </div>

                <div class="key-message animate-in delay-3">
                    <div class="message-icon">üí°</div>
                    <div class="message-text">
                        Domain knowledge doesn't just <em>help</em> machine learning ‚Äî it <strong>fundamentally changes the mathematics</strong>.
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 22: FAQ FOR REVIEWERS ==================== -->
        <section class="scene" data-scene="28" data-title="FAQ">
            <div class="scene-content">
                <div class="chapter-badge faq">‚ùì Anticipated Questions</div>
                <h2 class="scene-title animate-in">FAQ for Reviewers</h2>
                <p class="scene-subtitle animate-in delay-1">Addressing common technical questions from peer reviewers</p>

                <!-- FAQ Categories -->
                <div class="faq-container animate-in delay-2">
                    <!-- Category Tabs -->
                    <div class="faq-tabs">
                        <button class="faq-tab active" onclick="switchFaqCategory('novelty')" data-cat="novelty">üéØ Novelty</button>
                        <button class="faq-tab" onclick="switchFaqCategory('theory')" data-cat="theory">üìê Theory</button>
                        <button class="faq-tab" onclick="switchFaqCategory('experiments')" data-cat="experiments">üî¨ Experiments</button>
                        <button class="faq-tab" onclick="switchFaqCategory('scalability')" data-cat="scalability">üìà Scalability</button>
                        <button class="faq-tab" onclick="switchFaqCategory('privacy')" data-cat="privacy">üîí Privacy</button>
                        <button class="faq-tab" onclick="switchFaqCategory('limitations')" data-cat="limitations">‚ö†Ô∏è Limitations</button>
                    </div>

                    <!-- FAQ Content -->
                    <div class="faq-content">
                        <!-- Novelty & Contribution -->
                        <div class="faq-category active" id="faq-novelty">
                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q1</span>
                                    <span class="q-text">What is the main novelty compared to existing FL methods like FedProx, SCAFFOLD, or FedNova?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Key Distinction:</strong> Existing methods address non-IID data through <em>algorithmic corrections</em> (proximal terms, variance reduction, normalized averaging). SCFA introduces <em>domain knowledge integration</em> via semantic constraints from knowledge graphs.</p>
                                    <div class="answer-comparison">
                                        <div class="comp-item existing">
                                            <span class="comp-label">Existing Methods</span>
                                            <span class="comp-desc">Treat FL as pure optimization problem</span>
                                        </div>
                                        <div class="comp-vs">vs</div>
                                        <div class="comp-item ours">
                                            <span class="comp-label">SCFA</span>
                                            <span class="comp-desc">Leverage domain semantics to constrain hypothesis space</span>
                                        </div>
                                    </div>
                                    <p class="answer-evidence">This is the <strong>first formal convergence theory</strong> for constraint-based FL with provable guarantees (Theorem 1, R¬≤=0.94).</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q2</span>
                                    <span class="q-text">Why can't existing FL methods simply add constraints as regularization terms?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Fundamental difference:</strong> Regularization is a soft penalty; our constraints define <em>hard boundaries</em> on valid parameter space.</p>
                                    <ul class="answer-list">
                                        <li><strong>Regularization:</strong> L(w) + ŒªR(w) ‚Äî violation incurs penalty but is allowed</li>
                                        <li><strong>SCFA:</strong> w ‚àà C ‚Äî invalid updates are projected back, preserving physical/causal laws</li>
                                    </ul>
                                    <p class="answer-evidence">Empirically, soft constraints achieve only 8% improvement vs. our 22% (Table 3 in paper).</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q3</span>
                                    <span class="q-text">Is constructing a knowledge graph practical for real-world deployment?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Yes, for mature domains.</strong> Manufacturing already has standardized ontologies:</p>
                                    <div class="ontology-badges">
                                        <span class="onto-badge">ISA-95 (Industry Standard)</span>
                                        <span class="onto-badge">MASON (Open Source)</span>
                                        <span class="onto-badge">Schema.org (W3C)</span>
                                    </div>
                                    <p>We provide automated tools to extract constraints from existing OWL/RDF ontologies. For new domains, our framework generalizes to any structured knowledge (medical: SNOMED-CT; finance: FIBO).</p>
                                </div>
                            </div>
                        </div>

                        <!-- Theoretical Soundness -->
                        <div class="faq-category" id="faq-theory">
                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q4</span>
                                    <span class="q-text">What assumptions does Theorem 1 (convergence) require? Are they realistic?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Assumptions:</strong></p>
                                    <ul class="answer-list">
                                        <li><strong>A1: L-smooth loss</strong> ‚Äî Standard in optimization; holds for neural networks with bounded weights</li>
                                        <li><strong>A2: Œº-strongly convex (or PL condition)</strong> ‚Äî Can be relaxed to non-convex with bounded variance</li>
                                        <li><strong>A3: Bounded gradient variance œÉ¬≤</strong> ‚Äî Standard in SGD analysis</li>
                                        <li><strong>A4: Constraint set C is convex and closed</strong> ‚Äî Holds for our constraint types (boxes, cones, halfspaces)</li>
                                    </ul>
                                    <p class="answer-evidence">These are <em>standard assumptions</em> in FL literature (cf. FedProx, SCAFFOLD). Our contribution is proving tighter bounds under constraints.</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q5</span>
                                    <span class="q-text">How do you handle non-convex constraints (e.g., causal DAGs)?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Approach:</strong> We decompose complex constraints into convex sub-problems:</p>
                                    <ul class="answer-list">
                                        <li><strong>Temporal (monotonicity):</strong> Convex cone constraint</li>
                                        <li><strong>Capacity (bounds):</strong> Box constraint ‚Äî convex</li>
                                        <li><strong>Causal (precedence):</strong> Linearized via topological ordering of DAG</li>
                                        <li><strong>Physical (conservation):</strong> Linear equality constraint ‚Äî convex</li>
                                    </ul>
                                    <p class="answer-evidence">For non-convex cases, we use alternating projection with convergence guarantees (Appendix B.3).</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q6</span>
                                    <span class="q-text">Why does the 18% violation threshold exist? Is it dataset-specific?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Theoretical basis:</strong> The threshold emerges from the balance between:</p>
                                    <ul class="answer-list">
                                        <li>Constraint satisfaction (forces updates toward valid region)</li>
                                        <li>Gradient descent (forces updates toward loss minimum)</li>
                                    </ul>
                                    <p>At œÅ > 18%, the projection operator dominates, causing oscillation. We validated across 3 datasets (Bosch, NASA C-MAPSS, UCI SECOM) with consistent threshold range [16-21%].</p>
                                    <p class="answer-evidence">The threshold depends on constraint geometry, not dataset size ‚Äî see sensitivity analysis in Appendix C.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Experimental Methodology -->
                        <div class="faq-category" id="faq-experiments">
                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q7</span>
                                    <span class="q-text">Why use only the Bosch dataset? Would results hold on other benchmarks?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Rationale:</strong> Bosch is the largest public manufacturing dataset with:</p>
                                    <ul class="answer-list">
                                        <li>1.18M samples (10√ó larger than typical FL benchmarks)</li>
                                        <li>968 features (high-dimensional)</li>
                                        <li>Natural non-IID structure (production lines)</li>
                                    </ul>
                                    <p><strong>Additional validation:</strong> We validated on NASA C-MAPSS (turbofan degradation) and UCI SECOM (semiconductor). Results show consistent 18-24% convergence improvement across domains.</p>
                                    <p class="answer-evidence">Ablation across 5 heterogeneity levels (Œ± ‚àà {0.1, 0.5, 1.0, 5.0, 10.0}) in Table 2.</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q8</span>
                                    <span class="q-text">How do you ensure fair comparison with baselines? What hyperparameters were tuned?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Fair comparison protocol:</strong></p>
                                    <ul class="answer-list">
                                        <li>Same model architecture (3-layer MLP, 968‚Üí256‚Üí128‚Üí1)</li>
                                        <li>Same learning rate schedule (Œ∑=0.01, decay 0.99/round)</li>
                                        <li>Same local epochs (E=5) and batch size (B=64)</li>
                                        <li>Grid search for method-specific params (Œº for FedProx, etc.)</li>
                                    </ul>
                                    <p><strong>Baselines:</strong> FedAvg, FedProx (Œº ‚àà {0.001, 0.01, 0.1}), SCAFFOLD, FedNova, FedDyn</p>
                                    <p class="answer-evidence">5 runs per configuration; report mean ¬± std. All p-values < 0.01 (paired t-test).</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q9</span>
                                    <span class="q-text">How do you simulate non-IID data? Is it realistic?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Dirichlet partitioning</strong> (standard in FL literature):</p>
                                    <div class="code-snippet">
                                        <code>proportions = np.random.dirichlet([Œ±] * K)</code>
                                    </div>
                                    <ul class="answer-list">
                                        <li><strong>Œ± ‚Üí ‚àû:</strong> IID (uniform distribution)</li>
                                        <li><strong>Œ± = 1.0:</strong> Moderate heterogeneity</li>
                                        <li><strong>Œ± ‚Üí 0:</strong> Extreme non-IID (each client has few classes)</li>
                                    </ul>
                                    <p class="answer-evidence">We test Œ± ‚àà {0.1, 0.5, 1.0, 5.0, 10.0}, covering pathological to near-IID scenarios.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Scalability & Efficiency -->
                        <div class="faq-category" id="faq-scalability">
                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q10</span>
                                    <span class="q-text">What is the computational overhead of constraint checking?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Overhead analysis:</strong></p>
                                    <div class="overhead-stats">
                                        <div class="overhead-item">
                                            <span class="overhead-value">0.29%</span>
                                            <span class="overhead-label">Additional compute time per round</span>
                                        </div>
                                        <div class="overhead-item">
                                            <span class="overhead-value">87ms</span>
                                            <span class="overhead-label">Constraint validation (3K rules)</span>
                                        </div>
                                        <div class="overhead-item">
                                            <span class="overhead-value">O(|C|¬∑d)</span>
                                            <span class="overhead-label">Complexity (C=constraints, d=params)</span>
                                        </div>
                                    </div>
                                    <p>Constraint checking is <strong>embarrassingly parallel</strong> ‚Äî each constraint is independent. With GPU batching, overhead drops to 0.12%.</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q11</span>
                                    <span class="q-text">Does SCFA scale to larger models (e.g., transformers) and more clients?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Scalability results:</strong></p>
                                    <ul class="answer-list">
                                        <li><strong>Clients:</strong> Tested K ‚àà {5, 10, 20, 50, 100}. Overhead remains O(K) ‚Äî linear scaling.</li>
                                        <li><strong>Model size:</strong> Constraints operate on <em>output predictions</em>, not parameters. A 100M parameter model has same constraint overhead as 1M model.</li>
                                        <li><strong>Transformers:</strong> Applicable ‚Äî constraints on attention outputs, not internal weights.</li>
                                    </ul>
                                    <p class="answer-evidence">Communication cost unchanged ‚Äî constraints are checked server-side after aggregation.</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q12</span>
                                    <span class="q-text">How does SCFA handle client dropout or asynchronous updates?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Robustness mechanisms:</strong></p>
                                    <ul class="answer-list">
                                        <li><strong>Client dropout:</strong> Validity scores naturally reweight remaining clients. No special handling needed.</li>
                                        <li><strong>Staleness:</strong> Can combine with FedAsync ‚Äî constraints provide additional staleness filtering.</li>
                                        <li><strong>Byzantine clients:</strong> Invalid updates (violating constraints) are automatically down-weighted via s_k ‚Üí 0.</li>
                                    </ul>
                                    <p class="answer-evidence">Tested with 20% random dropout per round ‚Äî only 2% accuracy degradation (Table 5).</p>
                                </div>
                            </div>
                        </div>

                        <!-- Privacy Guarantees -->
                        <div class="faq-category" id="faq-privacy">
                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q13</span>
                                    <span class="q-text">How does SCFA interact with differential privacy? Does constraint projection leak information?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Privacy preservation:</strong> Constraint projection is a <em>post-processing</em> operation on already-privatized gradients.</p>
                                    <ul class="answer-list">
                                        <li>DP noise is added <strong>before</strong> projection (client-side)</li>
                                        <li>Projection is deterministic given public constraints</li>
                                        <li>By post-processing theorem, Œµ-DP is preserved</li>
                                    </ul>
                                    <p><strong>Bonus:</strong> Theorem 2 shows SCFA <em>amplifies</em> privacy by reducing required noise (Œ∏=0.37 ‚Üí 63% less noise for same Œµ).</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q14</span>
                                    <span class="q-text">Do the constraints themselves leak private information about client data?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>No.</strong> Constraints are derived from <em>public domain knowledge</em> (industry standards), not client data.</p>
                                    <ul class="answer-list">
                                        <li><strong>Temporal:</strong> "Tool wear increases" ‚Äî physics, not data</li>
                                        <li><strong>Causal:</strong> "Vibration precedes bearing failure" ‚Äî engineering knowledge</li>
                                        <li><strong>Capacity:</strong> "Temperature ‚àà [20¬∞C, 200¬∞C]" ‚Äî equipment specs</li>
                                    </ul>
                                    <p class="answer-evidence">Constraints are public and shared ‚Äî no information leakage by definition.</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q15</span>
                                    <span class="q-text">What privacy budget (Œµ) is realistic for GDPR compliance?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>GDPR guidance:</strong> No official Œµ threshold, but literature suggests Œµ ‚â§ 10 for "reasonable" privacy.</p>
                                    <div class="privacy-comparison">
                                        <div class="priv-item">
                                            <span class="priv-method">FedAvg + DP</span>
                                            <span class="priv-loss">12.1% accuracy loss @ Œµ=10</span>
                                        </div>
                                        <div class="priv-item highlight">
                                            <span class="priv-method">SCFA + DP</span>
                                            <span class="priv-loss">3.7% accuracy loss @ Œµ=10</span>
                                        </div>
                                    </div>
                                    <p class="answer-evidence">SCFA makes Œµ=10 practical with only 3.7% utility loss ‚Äî 2.7√ó better tradeoff.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Limitations -->
                        <div class="faq-category" id="faq-limitations">
                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q16</span>
                                    <span class="q-text">What are the main limitations of SCFA?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Honest limitations:</strong></p>
                                    <ul class="answer-list limitation-list">
                                        <li><span class="lim-icon">‚ö†Ô∏è</span> <strong>Requires domain knowledge:</strong> Need existing ontologies or expert input to define constraints. Not applicable to domains without structured knowledge.</li>
                                        <li><span class="lim-icon">‚ö†Ô∏è</span> <strong>Constraint quality matters:</strong> Incorrect constraints can hurt performance. We assume constraints are valid.</li>
                                        <li><span class="lim-icon">‚ö†Ô∏è</span> <strong>Not for unconstrained domains:</strong> Pure image classification (ImageNet) has few natural semantic constraints.</li>
                                        <li><span class="lim-icon">‚ö†Ô∏è</span> <strong>Theoretical gap:</strong> Non-convex constraint analysis is incomplete (Appendix B.3).</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q17</span>
                                    <span class="q-text">What happens if constraints are wrong or outdated?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>Robustness analysis:</strong> We tested with deliberately incorrect constraints:</p>
                                    <ul class="answer-list">
                                        <li><strong>5% wrong constraints:</strong> 1.2% accuracy drop (graceful degradation)</li>
                                        <li><strong>10% wrong constraints:</strong> 4.8% accuracy drop</li>
                                        <li><strong>20% wrong constraints:</strong> SCFA underperforms FedAvg</li>
                                    </ul>
                                    <p><strong>Mitigation:</strong> Constraint validation module (Section 4.2) detects conflicting constraints via satisfiability checking.</p>
                                </div>
                            </div>

                            <div class="faq-item">
                                <div class="faq-question">
                                    <span class="q-icon">Q18</span>
                                    <span class="q-text">Why wasn't SCFA tested on standard FL benchmarks (CIFAR, FEMNIST)?</span>
                                </div>
                                <div class="faq-answer">
                                    <p><strong>By design:</strong> SCFA targets domains with rich semantic structure. Standard vision benchmarks lack natural constraints.</p>
                                    <ul class="answer-list">
                                        <li><strong>CIFAR-10:</strong> "Cat" and "Dog" have no causal/temporal/physical constraints</li>
                                        <li><strong>FEMNIST:</strong> Character recognition has no domain physics</li>
                                    </ul>
                                    <p><strong>Appropriate domains:</strong> Healthcare (treatment protocols), manufacturing (physics), finance (regulations), autonomous systems (safety specs).</p>
                                    <p class="answer-evidence">This is a <em>feature</em>, not a bug ‚Äî SCFA is designed for constrained domains.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Reference Card -->
                <div class="faq-quick-ref animate-in delay-3">
                    <div class="qr-header">
                        <span class="qr-icon">üìã</span>
                        <span class="qr-title">Quick Reference: Key Numbers</span>
                    </div>
                    <div class="qr-stats">
                        <div class="qr-stat">
                            <span class="qr-value">22%</span>
                            <span class="qr-label">Faster convergence</span>
                        </div>
                        <div class="qr-stat">
                            <span class="qr-value">2.7√ó</span>
                            <span class="qr-label">Better privacy-utility</span>
                        </div>
                        <div class="qr-stat">
                            <span class="qr-value">18%</span>
                            <span class="qr-label">Critical threshold (œÅ)</span>
                        </div>
                        <div class="qr-stat">
                            <span class="qr-value">R¬≤>.90</span>
                            <span class="qr-label">All theorems validated</span>
                        </div>
                        <div class="qr-stat">
                            <span class="qr-value">0.29%</span>
                            <span class="qr-label">Compute overhead</span>
                        </div>
                        <div class="qr-stat">
                            <span class="qr-value">Œ∏=0.37</span>
                            <span class="qr-label">63% noise reduction</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SCENE 23: CONCLUSION ==================== -->
        <section class="scene" data-scene="29" data-title="Conclusion">
            <div class="scene-content conclusion-scene">
                <div class="chapter-badge success">Conclusion</div>
                <h2 class="scene-title animate-in">Thank You</h2>
                
                <div class="closing-benefits animate-in delay-1">
                    <p class="closing-intro">With SCFA, the five manufacturing plants can now:</p>
                    <div class="benefit-list">
                        <div class="benefit-item" data-delay="0">
                            <span class="benefit-icon">‚ö°</span>
                            <span>Train models <span class="stat-highlight zoom-stat" data-stat="close-conv">22% faster</span></span>
                        </div>
                        <div class="benefit-item" data-delay="200">
                            <span class="benefit-icon">üîí</span>
                            <span>Maintain <strong>privacy that actually works</strong></span>
                        </div>
                        <div class="benefit-item" data-delay="400">
                            <span class="benefit-icon">‚ö†Ô∏è</span>
                            <span>Have <strong>clear warning signs</strong> when something goes wrong</span>
                        </div>
                    </div>
                </div>

                <div class="final-message animate-in delay-2">
                    <p class="big-statement">Domain knowledge isn't just helpful ‚Äî<br><strong>it changes the mathematics.</strong></p>
                </div>

                <div class="open-science animate-in delay-3">
                    <h4>üî¨ Open Science</h4>
                    <div class="open-stats">
                        <div class="open-stat">
                            <span class="stat-value stat-highlight" data-stat="open-samples">1.18M</span>
                            <span class="stat-label">Samples</span>
                        </div>
                        <div class="open-stat">
                            <span class="stat-value stat-highlight" data-stat="open-size">750 MB</span>
                            <span class="stat-label">Dataset</span>
                        </div>
                        <div class="open-stat">
                            <span class="stat-value stat-highlight" data-stat="open-constraints">3,000</span>
                            <span class="stat-label">Constraints</span>
                        </div>
                    </div>
                    <p class="open-note">Complete implementation and dataset publicly available</p>
                </div>

                <div class="author-footer animate-in delay-4">
                    <div class="footer-name">Jahidul Arafat</div>
                    <div class="footer-title">NSF Presidential & Woltosz Graduate Research Fellow</div>
                    <div class="footer-affiliation">Auburn University</div>
                </div>

                <div class="questions-prompt animate-in delay-5">
                    <div class="questions-icon">‚ùì</div>
                    <div class="questions-text">Questions?</div>
                </div>
            </div>
        </section>

    </div>

    <!-- Navigation Controls -->
    <div class="nav-controls">
        <button class="nav-btn prev" id="prevBtn" onclick="prevScene()">‚Üê Previous</button>
        <button class="nav-btn pause" id="pauseBtn" onclick="togglePause()">‚è∏ Pause</button>
        <button class="nav-btn next" id="nextBtn" onclick="nextScene()">Next ‚Üí</button>
    </div>

    <script src="js/main.js"></script>
    <script>
    // Setup HSR Simulator buttons after DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        // Open button
        var btn = document.getElementById('hsrSimBtn');
        if (btn) {
            btn.onclick = function() {
                var modal = document.getElementById('hsrModal');
                if (modal) {
                    modal.style.display = 'flex';
                    modal.style.alignItems = 'flex-start';
                    modal.style.justifyContent = 'center';
                    modal.style.paddingTop = '20px';
                    document.body.style.overflow = 'hidden';
                    if (typeof HSRSimulator !== 'undefined') {
                        try {
                            HSRSimulator.init();
                            HSRSimulator.reset();
                        } catch(e) { console.error(e); }
                    }
                }
            };
        }
        
        // Close button
        var closeBtn = document.getElementById('hsrCloseBtn');
        if (closeBtn) {
            closeBtn.onclick = function() {
                var modal = document.getElementById('hsrModal');
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                    if (typeof HSRSimulator !== 'undefined') {
                        HSRSimulator.stop();
                    }
                }
            };
        }
        
        // Reset button
        var resetBtn = document.getElementById('simResetBtn');
        if (resetBtn) {
            resetBtn.onclick = function() {
                if (typeof HSRSimulator !== 'undefined') {
                    HSRSimulator.reset();
                }
            };
        }
        
        // Play/Pause button
        var playBtn = document.getElementById('simPlayBtn');
        if (playBtn) {
            playBtn.onclick = function() {
                if (typeof HSRSimulator !== 'undefined') {
                    HSRSimulator.togglePlay();
                }
            };
        }
        
        // Step button
        var stepBtn = document.getElementById('simStepBtn');
        if (stepBtn) {
            stepBtn.onclick = function() {
                if (typeof HSRSimulator !== 'undefined') {
                    HSRSimulator.step();
                }
            };
        }
        
        // Speed slider
        var speedSlider = document.getElementById('simSpeed');
        if (speedSlider) {
            speedSlider.oninput = function() {
                if (typeof HSRSimulator !== 'undefined') {
                    HSRSimulator.speed = parseFloat(this.value);
                }
                var label = document.getElementById('speedLabel');
                if (label) label.textContent = this.value + '√ó';
            };
        }
        
        // ESC key to close
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                var modal = document.getElementById('hsrModal');
                if (modal && modal.style.display !== 'none') {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                    if (typeof HSRSimulator !== 'undefined') {
                        HSRSimulator.stop();
                    }
                }
            }
        });
    });
    </script>
</body>
</html>
